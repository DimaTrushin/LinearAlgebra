\ProvidesFile{lecture21.tex}[Лекция 21]


\newpage
\section{Функционалы}

Этот раздел посвящен специальному случаю векторного пространства состоящего из линейных функций на фиксированном пространстве.

\subsection{Двойственное (сопряженное) пространство}

\begin{definition}
Пусть $V$ -- векторное пространство над полем $F$, тогда двойственным (или сопряженным) пространством к нему называется 
\[
V^* = \Hom_F(V,F) = \{\xi\colon V\to F\mid \xi \text{ -- линейное над }F\}
\]
Элементы $V^*$ называются линейными функционалами или линейными функциями.
\end{definition}

\paragraph{Замечания}

\begin{itemize}
\item Таким образом двойственное пространство к $V$ состоит из линейных функций на $V$.

\item Вспомним, что в разделе~\ref{section::HomOperations} было показано, что $V^*$ обладает структурой векторного пространства.
Напомним явно эту структуру.

Если $\xi,\eta\in V^*$ -- два функционала, то нам надо определить их сумму $\xi + \eta\in V^*$.
То есть нам надо определить отображение $(\xi + \eta)\colon V\to F$, которое должно быть $F$-линейным.
Определим его так: $(\xi + \eta)(v) = \xi(v) + \eta(v)$.
Если $\xi \in V^*$ и $\lambda\in F$, то нам надо определить $\lambda \xi \in V^*$.
То есть нам надо определить отображение $(\lambda \xi)\colon V\to F$, которое должно быть $F$-линейным.
Сделаем это так: $(\lambda\xi)(v) = \lambda\xi(v)$.
Элементарные проверки показывают, что эти операции снабжают $V^*$ структурой векторного пространства над $F$ (то есть удовлетворяют всем нужным аксиомам).

\item {\bf Удобный формализм} Если $\xi \in V^*$, а $v\in V$, то применение функционала к вектору $\xi(v)$ можно записать более кратко без скобок $\xi v$ рассматривая операцию применения функционала, как операцию умножения $V^*\times V\to F$ по правилу $(\xi, v)\mapsto \xi v = \xi(v)$.
Это очень удобно и унифицирует многие обозначения.
Например можно использовать с блочными формулами, в виде
\[
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_m}
\end{pmatrix}
\begin{pmatrix}
{v_1}&{\ldots}&{v_n}\\
\end{pmatrix}
=
\begin{pmatrix}
{\xi_1 v_1}&{\ldots}&{\xi_1 v_n}\\
{\vdots}&{\ddots}&{\vdots}\\
{\xi_m v_1}&{\ldots}&{\xi_m v_n}\\
\end{pmatrix}
\]
Здесь я умножаю столбец из функционалов на строку из векторов и получаю матрицу из чисел.
\end{itemize}

\paragraph{Примеры}

\begin{enumerate}
\item Пусть $V = F^n$ -- пространство столбцов.
Если $y\in F^n$ -- некоторый столбец, то положим $\alpha_y \colon V\to F$ по правилу $\alpha_y(x) = y^t x$.
Ниже мы покажем, что в конечномерном пространстве так выглядят все функционалы.

\item Пусть $F(X, \mathbb R) = \{f\colon X\to \mathbb R\}$ -- множество всех функций на множестве $X$ со значениями в поле $\mathbb R$.
Тогда это множество является векторным пространством над полем $\mathbb R$.
Тогда каждая точка $x\in X$ задает функционал <<вычисления в точке>> $\alpha_x \colon F(X,\mathbb R)\to \mathbb R$ по правилу $f\mapsto f(x)$.

\item Пусть $C[a,b]$ -- множество непрерывных функций на отрезке $[a,b]$.
Тогда отображение $\int \colon C[a,b]\to \mathbb R$ по правилу $f \mapsto \int_a^b f(t)\,dt$ является линейным функционалом.

\item Пусть $V = \operatorname{M}_n(F)$ -- квадратные матрицы, тогда отображение $\tr\colon \operatorname{M}_n(F)\to F$ по правилу $A\mapsto \tr A$ является линейным функционалом.
\end{enumerate}


\subsection{Двойственный базис}

\begin{claim}
\label{claim:DualBasis}
Пусть $V$ -- векторное пространство над полем $F$ и $e_1,\ldots,e_n\in V$ -- некоторый базис.
Тогда
\begin{enumerate}
\item Существует единственный набор функционалов $\xi_1,\ldots,\xi_n\in V^*$ такой, что 
\[
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_n}\\
\end{pmatrix}
\begin{pmatrix}
{e_1}&{\ldots}&{e_n}
\end{pmatrix}
=
E
\]

\item В конечномерном пространстве любой набор функционалов со свойством~(1) является базисом $V^*$.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Нам надо найти такие функционалы $\xi_i$, что $\xi_i(e_j) = 1$, если $i = j$ и $ = 0$, если $i\neq j$.
Но по утверждению~\ref{claim::LinMapExist} существует единственная линейная функция $\xi_i$ отправляющая $e_i$ в единицу, а остальные базисные векторы в $0$.

(2) Пусть $\xi \in V^*$ -- произвольный функционал, тогда покажем, что $\xi = \xi(e_1)\xi_1 + \ldots + \xi(e_n)\xi_n$.
Для этого надо показать, что левая и правая часть равенства одинаково действуют на любом векторе из $V$.
Для этого достаточно проверить, что они одинаково действуют на каком-нибудь базисе $V$.
То есть нам достаточно проверить, что левая и правая часть одинаково действуют на каждом $e_i$.
Под действием $\xi$ вектор $e_i$ идет в $\xi(e_i)$.
С другой стороны
\[
(\xi(e_1)\xi_1 + \ldots + \xi(e_n)\xi_n)(e_i) = \xi(e_1)\xi_1(e_i) + \ldots + \xi(e_n)\xi_n(e_i) = \xi(e_i)\xi_i(e_i) = \xi(e_i)
\]
что и требовалось.
\end{proof}

\begin{definition}
\label{def::DualBasis}
Пусть $V$ -- векторное пространство и $e_1,\ldots,e_n\in V$ -- его некоторый базис.
Тогда единственный базис $\xi_1,\ldots,\xi_n\in V^*$, удовлетворяющий условию
\[
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_n}\\
\end{pmatrix}
\begin{pmatrix}
{e_1}&{\ldots}&{e_n}
\end{pmatrix}
=
E
\]
называется двойственным (или сопряженным) к базису $e_1,\ldots,e_n$.
\end{definition}

\paragraph{Замечания}

\begin{itemize}
\item В предыдущем утверждении мы показали, что если пространство $V$ конечно мерно, то и пространство $V^*$ конечно мерно и имеет ту же самую размерность.
Кратко:  $\dim V <\infty$ $\Rightarrow$ $\dim V^* = \dim V$.

\item Можно показать, что если пространство $V$ бесконечно мерно, то пространство $V^*$ всегда имеет строго большую размерность.
Кратко: $\dim V = \infty$ $\Rightarrow$ $\dim V < \dim V^*$.

\item Таким образом можно дать очень дурацкое, но тем не менее корректное определение: векторное пространство $V$ будем называть конечномерным, если $V$ изоморфно $V^*$.
Удачи с доказательствами в этом прекрасном мире чудесных определений!

\item Давайте обсудим рабоче-крестьянский смысл последнего утверждения.
Пусть вам выдали векторное пространство $V$.
Как только вы в нем выбрали базис $e_1,\ldots,e_n$, то оно сразу превратилось в пространство столбцов $F^n$.
Теперь у вас рядом стоит векторное пространство $V^*$, давайте в нем выберем двойственный базис $\xi_1,\ldots,\xi_n$.
Тогда пространство $V^*$ тоже превращается в $F^n$, но давайте его отождествим с пространством строк, а не столбцов.
Тогда, если $\xi \in V^*$ в координатах задается строкой $y\in F^n$, а вектор $v\in V$ в координатах задается столбцом $x\in F^n$, то $\xi(v)$ в координатах считается по правилу $yx$ -- произведение строки на столбец.%
\footnote{Проверьте это.
Именно это свойство является ключевым для двойственного базиса.
Мы согласованно превращаем в строки и столбцы функционалы и векторы, так что вычисление функционала превращается в матричное умножение.}
\end{itemize}

\begin{claim}
\label{claim::DualBasisChange}
Пусть $V$ -- векторное пространство над полем $F$, $e_1,\ldots,e_n$ -- базис $V$, $\xi_1,\ldots,\xi_n$ -- базис $V^*$ двойственный к $e_1,\ldots,e_n$.
Пусть $e_1',\ldots,e_n'$ -- другой базис $V$ и $\xi_1',\ldots,\xi_n'$ -- двойственный ему базис $V^*$.
Тогда если $(e_1',\ldots,e_n') = (e_1,\ldots,e_n)C$, где $C\in \operatorname{M}_n(F)$ -- невырожденная матрица перехода, то $(\xi_1',\ldots,\xi_n') = (\xi_1,\ldots,\xi_n)C^{-t}$.
\end{claim}
\begin{proof}
Так как $\xi_1,\ldots,\xi_n$ и $\xi_1',\ldots,\xi_n'$ -- базисы пространства $V^*$, то обязательно найдется невырожденная матрица перехода между ними, давайте обозначим ее за $D$, то есть
\[
(\xi_1',\ldots,\xi_n') = (\xi_1,\ldots,\xi_n)D
\]
Транспонируем это равенство и получим
\[
\begin{pmatrix}
{\xi_1'}\\{\vdots}\\{\xi_n'}
\end{pmatrix}
=
D^t
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_n}
\end{pmatrix}
\]
Так как $\xi_1',\ldots,\xi_n'$ двойственный к $e_1',\ldots,e_n'$, то по определению это значит
\[
\begin{pmatrix}
{\xi_1'}\\{\vdots}\\{\xi_n'}
\end{pmatrix}
\begin{pmatrix}
{e_1'}&{\ldots}&{e_n'}
\end{pmatrix}
=
E
\]
С другой стороны
\[
\begin{pmatrix}
{\xi_1'}\\{\vdots}\\{\xi_n'}
\end{pmatrix}
\begin{pmatrix}
{e_1'}&{\ldots}&{e_n'}
\end{pmatrix}
=
D^t
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_n}
\end{pmatrix}
\begin{pmatrix}
{e_1}&{\ldots}&{e_n}
\end{pmatrix}
C
=
D^t C
\]
Откуда $D = C^{-t}$.
\end{proof}



\subsection{Функции на функциях}

Давайте рассмотрим следующую последовательность векторных пространств
\begin{center}
\begin{tabular}{c|c|c}

{$V$}&{$V^*$}&{$V^{**}$}\\

\hline

{$v$}&{$\xi$}&{$?$}\\

\end{tabular}
\end{center}
В $V$ у нас живут векторы, в $V^*$ функции на векторах, а в $V^{**}$ -- функции на функциях на векторах.
Оказывается, каждый вектор можно рассматривать как функцию на функциях на векторах.
Давайте вспомним наш удобный формализм: если $v\in V$ и $\xi \in V^*$, то $\xi(v)$ надо обозначать так $\xi v$, то есть как произведение.
Тогда зафиксировав $\xi$ мы получим правило линейное по $v$, то есть отображение $V\to F$.
Но, мы с таким же успехом можем зафиксировать $v$ и начать менять левый аргумент.
Тогда получится линейное отображение $V^* \to F$.
Это ломает мозг в записи $\xi(v)$, но когда и функционал и вектор записаны равноправно в виде умножения $\xi v$, такие конструкции становится проще понимать.
Теперь аккуратно.

Для произвольного векторного пространства $V$ построим отображение $\phi\colon V\to V^{**}$, где $v\mapsto \phi_v$.
Чтобы задать это отображение нам надо определить элемент $\phi_v\in V^{**}$, то есть нам надо задать $\phi_v\colon V^*\to F$.
То есть нам надо определить число из поля $\phi_v(\xi)$ для каждого $\xi\in V^*$.
Для этого положим по определению $\phi_v(\xi) = \xi(v)$ -- функционал вычисления на векторе.
Обратим внимание, что отображение $\phi\colon V\to V^{**}$ является линейным отображением между векторными пространствами.


\begin{claim}
\label{claim::DoubleDuoIsom}
Пусть $V$ -- произвольное векторное пространство и $\phi\colon V\to V^{**}$ отображение по правилу $v\mapsto \phi_v$, где $\phi_v(\xi) = \xi(v)$.
Тогда 
\begin{enumerate}
\item Отображение $\phi\colon V\to V^{**}$ инъективно.

\item Если $V$ конечно мерно, то отображение $\phi$ является изоморфизмом.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Так как $\phi$ линейно, нам достаточно показать, что у него нулевое ядро.
Давайте расшифруем, что это значит.
Пусть $v\in V$ такой, что $\phi_v = 0$.
Это значит, что $\phi_v \colon V^* \to F$ является нулевым отображением.
То есть $\phi_v(\xi) = 0$ для любого $\xi \in V^*$.
То есть $\xi(v) = 0$ для любого $\xi \in V^*$.
Чтобы доказать, что $v = 0$, нам достаточно показать, что если $v\neq0$, то найдется функционал $\xi \in V^*$ такой, что $\xi(v)\neq 0$.
Действительно, если $v\neq 0$, то $\{v\}$ -- линейно независимая система.
Тогда ее можно дополнить до базиса $\{v\}\cup E$.%
\footnote{В конечномерном случае мы это умеем делать, а в бесконечномерном случае -- это аксиома эквивалентная аксиоме выбора.}
Тогда положим отображение $\xi \colon V\to F$ по правилу $v\mapsto 1$, а $E$ идет целиком в $0$.%
\footnote{В конечномерном случае это утверждение~\ref{claim::Basis}.
Для бесконечномерного случая можете проверить, что оно остается верным.}
Тогда $\xi\in V^*$ и $\xi(v)\neq 0$, что и требовалось.

(2) Так как $V$ вкладывается в $V^{**}$, то нам достаточно убедиться, что они имеют одинаковую размерность.
А это следует из утверждения~\ref{claim:DualBasis}, так как $\dim V = \dim V^* = \dim V^{**}$.
\end{proof}

Я конечно же постарался привести доказательство в бесконечно мерном случае.
Однако, если все эти бесконечномерные пакости так претят вашей ранимой тонкой душевной организации, можете доказывать это утверждение только для конечно мерных пространств.

\paragraph{Замечания}

\begin{itemize}
\item Если мы стартовали с векторного пространства $V$, то можем начать строить цепочку пространств вида $V, V^*, V^{**}, \ldots$.
Утверждение~\ref{claim:DualBasis} гласит, что с абстрактной точки зрения, все эти пространства одинаковые -- изоморфны и мы ничего не получили нового.

\item Однако, этот абстрактный изоморфизм ничего не знает про <<семантику>> наших пространств, а именно он ничего не знает про операцию применения функционалов к векторам.
Изоморфизм $\phi\colon V\to V^{**}$ из утверждения~\ref{claim::DoubleDuoIsom} согласован с этой семантикой следующим образом.
На паре пространств $V^*$, $V$ есть операция $V^*\times V\to F$ вычисления функционала и на паре пространств $V^{**}$, $V^*$ есть операция $V^{**}\times V^*\to F$ вычисления функционала.
Рассмотрим следующую картинку
\begin{center}
\begin{tabular}{c|c|c}

{$V$}&{$V^*$}&{$V^{**}$}\\

\hline

{$v$}&{$\xi$}&{$\phi_v$}\\

\end{tabular}
\end{center}
Тогда мы можем применить $\xi$ к $v$ и получим $\xi(v)$, можем применить $\phi_v$ к $\xi$ и получим $\phi_v(\xi) = \xi(v)$.
То есть рассматривать пару $(v,\xi)$ можно как пару $(\text{вектор}, \text{функция})$, а можно рассматривать как пару $(\text{функция}, \text{вектор})$.
При этом операция вычисления функции на векторе будет одной и той же и задается правилом $\xi v$ (вот видите, как полезна симметричная запись).%
\footnote{Таким образом нам необходимо знать только про векторы и функционалы.
Кроме того, оказывается, что если определить такую операцию над векторными пространствами как тензорное произведение, то все, что только можно определить в линейной алгебре, можно выразить через векторы и функционалы с помощью тензорного произведения, например, линейные отображения, операторы, билинейные формы (которые будут чуть позже) и много других объектов.
Это все ведет к некоторому единому удобному тензорному языку.}

\item Теперь еще раз рассмотрим последовательность $V, V^*, V^{**}$.
Если мы выберем в $V$ некоторый базис $e_1,\ldots,e_n$, то в $V^*$ можем найти к нему двойственный $\xi_1,\ldots,\xi_n$.
После чего найдем к последнему двойственный $\eta_1,\ldots,\eta_n$ в $V^{**}$.
Но теперь вспомним, что $V^{**}$ изоморфно $V$.
А так как изоморфизм между $V$ и $V^{**}$ согласован с применением функционалов, то базис $\eta_1,\ldots,\eta_n$ перейдет в $e_1,\ldots,e_n$.

\item Чуть ниже я покажу более аккуратно, что значит, что изоморфизм $\phi\colon V\to V^{**}$ в некотором смысле канонический, а между $V$ и $V^*$ таких не бывает.
\end{itemize}


\subsection{Сопряженное линейное отображение}

Выше мы показали, что в конечномерном случае все три пространства $V$, $V^*$ и $V^{**}$ изоморфны между собой.
Однако, в случае $V$ и $V^{**}$ мы не просто показали это, мы построили некоторый замечательнейший изоморфизм между ними.
Ниже очень хочется объяснить, а что же такого замечательного в этом изоморфизме и почему подобного замечательного изоморфизма нет между $V$ и $V^*$.
Оказывается, что изоморфизм $\phi\colon V \to V^{**}$ в некотором смысле согласован с линейными отображениями, а подобного согласованного изоморфизма между $V$ и $V^*$ просто не бывает.
Для того, чтобы объяснить, что все это значит, мне нужно для начала определить сопряженное линейное отображение.

Пусть $\varphi\colon V\to U$ -- некоторое линейное отображение.
Мы хотим определить другое линейное отображение $\varphi^* \colon U^*\to V^*$ следующим образом:
\[
\xymatrix@R=6pt{
	{V}\ar[r]^{\varphi}\ar@{-->}@/^16pt/[rr]^{\xi\circ \varphi}&{U}\ar[r]^{\xi}&{F}\\
	{V^*}&{U^*}\ar[l]_{\phi^*}&{}\\
	{\xi\circ \varphi}&{\xi}\ar@{|->}[l]&{}\\
}
\]
Давайте поясним, что нарисовано на диаграмме.
Нам надо определить $\varphi^*\colon U^*\to V^*$.
То есть для любого $\xi\in U^*$ нам надо задать $\varphi^*(\xi)\in V^*$.
Последнее означает, что по линейному функционалу на $U$, нам надо как-то построить линейный функционал на $V$.
Предлагается определить $\varphi^*(\xi) = \xi \varphi$ как композицию.

\begin{definition}
Для линейного отображения $\varphi\colon V\to U$ сопряженным (или двойственным) линейным отображением называется $\varphi^*\colon U^*\to V^*$ по правилу $\xi \mapsto \varphi^*(\xi) = \xi \varphi$.
\end{definition}


\paragraph{Матрица сопряженного линейного отображения}

\begin{claim}
\label{claim::DualHomMatrix}
Пусть $V$ -- векторное пространство с базисом $e_1,\ldots,e_n$, $U$ -- векторное пространство с базисом $f_1,\ldots,f_m$.
Пусть $e^1,\ldots,e^n$ -- двойственный базис в $V^*$ и $f^1,\ldots,f^m$ -- двойственный базис в $U^*$.
Пусть $\varphi \colon V\to U$ -- некоторый линейное отображение с матрицей $A_\varphi$ в базисах $e_i$ и $f_j$ и пусть $\varphi^*\colon U^*\to V^*$ -- сопряженное линейное отображение с матрицей $A_{\varphi^*}$ в базисах $f^i$ и $e^j$.
Тогда $A_{\varphi^*} = A_{\varphi}^t$.
\end{claim}
\begin{proof}
Для лучшего понимания, я приведу два доказательства: без координатное и координатное.
Выбирайте любое, какое вам больше нравится.

\paragraph{Абстрактное доказательство}

По определению матрицы линейного отображения
\[
\varphi(e_1,\ldots,e_n) = (f_1,\ldots,f_m)A_{\varphi}\quad\text{и}\quad
\varphi^*(f^1,\ldots,f^m) = (e^1,\ldots,e^n)A_{\varphi^*}
\]
Кроме того, по определению двойственного базиса нам дано
\[
\begin{pmatrix}
{e^1}\\{\vdots}\\{e^n}
\end{pmatrix}
\begin{pmatrix}
{e_1}&{\ldots}&{e_n}
\end{pmatrix}
=E\quad\text{и}\quad
\begin{pmatrix}
{f^1}\\{\vdots}\\{f^m}
\end{pmatrix}
\begin{pmatrix}
{f_1}&{\ldots}&{f_m}
\end{pmatrix}
=E
\]
В начале распишем следующее равенство
\[
(f^1\varphi,\ldots,f^m\varphi)=\varphi^*(f^1,\ldots,f^m) = (e^1,\ldots,e^n)A_{\varphi^*}
\]
Теперь транспонируем его и получим
\[
\begin{pmatrix}
{f^1 \varphi}\\{\vdots}\\{f^m\varphi}
\end{pmatrix}
=
\begin{pmatrix}
{f^1}\\{\vdots}\\{f^m}
\end{pmatrix} \varphi
=
A_{\varphi^*}^t
\begin{pmatrix}
{e^1}\\{\vdots}\\{e^n}
\end{pmatrix}
\]
Умножим левую и праву часть полученного равенства на $(e_1,\ldots,e_n)$, получим
\begin{gather*}
\begin{pmatrix}
{f^1}\\{\vdots}\\{f^m}
\end{pmatrix} 
\varphi (e_1,\ldots,e_n)
=
A_{\varphi^*}^t
\begin{pmatrix}
{e^1}\\{\vdots}\\{e^n}
\end{pmatrix}
\begin{pmatrix}
{e_1}&{\ldots}&{e_n}
\end{pmatrix}\\
\begin{pmatrix}
{f^1}\\{\vdots}\\{f^m}
\end{pmatrix} 
(f_1,\ldots,f_m)A_{\varphi}
=
A_{\varphi^*}^t\\
A_{\varphi} = A_{\varphi^*}^t
\end{gather*}
что и требовалось.

\paragraph{Координатное доказательство}

Так как в пространствах $V$ и $V^*$ фиксированы базис и двойственный к нему, то можно считать, что $V = F^n$ -- пространство столбцов, $V^* = F^n$ -- пространство строк, а применение функции к вектору -- умножение строки на столбец.
Аналогично, можно считать, что $U = F^m$ -- пространство столбцов, $U^*=F^m$ -- пространство строк.
Тогда линейное отображение $\varphi$ действует по правилу $\varphi(x) = A_{\varphi} x$.
Значит по определению строка $\xi \in F^m$ переходит в $\varphi^*(\xi) = \xi \circ \varphi = \xi A_{\varphi}$, то есть строка $\xi\in F^m$ переходит в строку $\xi A_{\varphi}$.
Но чтобы получить матрицу линайного отображения, надо записать координаты вектора в столбцы, тогда получим $\xi^t \mapsto A_{\varphi}^t \xi^t$.
То есть отображение $\varphi^*$ действует с помощью матрицы $A_{\varphi}^t$.

\end{proof}

\paragraph{Замечание}

То есть транспонирование матриц имеет следующий философский смысл: это переход к сопряженному линейному отображению в двойственном пространстве.
Заметили, что транспонирование и звездочка меняют местами порядок отображений?
Последнее утверждение показывает, что это не случайное совпадение.
