\ProvidesFile{lecture05.tex}[Лекция 5]


\newpage

\section{Перестановки}

\subsection{Отображения множеств}

Пусть $X,Y$ -- некоторые множества, а $\varphi\colon X\to Y$ -- отображение.
Тогда $\varphi$ называется {\it инъективным}, если оно <<не склеивает точки>>, т.е. для любых $x,y\in X$ из условия $x\neq y$ следует $\varphi(x)\neq\varphi(y)$.
Отображение $\varphi$ называется {\it сюръективным}, если в любой элемент что-то переходит, т.е. для любого $y\in Y$ существует $x\in X$ такой, что $\varphi(x)=y$.
Отображение $\varphi$ называется {\it биективным}, если оно одновременно инъективно и сюръективно.%
\footnote{В теории множеств, множества -- это мешки с элементами, а отображения <<сравнивают>> эти мешки между собой.
Биекция, между множествами говорит, что это по сути одно и то же множество, но по-разному заданное.
Потому на биекцию между $X$ и $Y$ можно смотреть не как на отображение между разными множествами, а как на правило <<переименовывающее>> элементы на одном и том же множестве.}

Свойства отображения можно подчеркивать видом стрелки.
Например, инъективное отображение обычно обозначается $\varphi\colon X\hookrightarrow Y$, сюръективное -- $\varphi\colon X\twoheadrightarrow Y$, а биективное --  $\varphi\colon X\stackrel{\sim}{\longrightarrow}Y$.

Для любого множества $X$ отображение $\Identity\colon X\to X$ заданное по правилу $\Identity(x) = x$ называется {\it тождественным}.
Пусть $\varphi\colon X\to Y$ -- некоторое отображение.
Тогда $\psi\colon Y\to X$ называется {\it левым обратным} (соответственно {\it правым обратным}) к $\varphi$, если $\psi\varphi = \Identity$ ($\varphi\psi = \Identity$).%
\footnote{Легко проверить, что существование левого обратного никак не связано с существованием правого обратного и наоборот.}
Левых и правых обратных для $\varphi$ может быть много.
Однако, если есть оба обратных и $\psi_1$ -- левый обратный, а $\psi_2$ -- правый обратный, то они совпадают, так как $\psi_1 = \psi_1 (\varphi \psi_2) = (\psi_1\varphi)\psi_2 = \psi_2$.
А следовательно совпадают все левые обратные со всеми правыми и такой единственный элемент называют {\it обратным} и обозначают $\varphi^{-1}$, а $\varphi$ называют {\it обратимым}.
Легко проверить следующее.

\begin{claim*}
Пусть $\varphi\colon X\to Y$ -- некоторое отображение.
Тогда
\begin{enumerate}
\item $\varphi$ инъективно тогда и только тогда, когда $\varphi$ обладает левым обратным.

\item $\varphi$ сюръективно тогда и только тогда, когда $\varphi$ обладает правым обратным.

\item $\varphi$ биективно тогда и только тогда, когда $\varphi$ обратимо.
\end{enumerate}
\end{claim*}
% TO DO
% надо ли сделать доказательство?


\subsection{Перестановки}

Пусть $X_n = \{1,\ldots,n\}$ -- конечное множество из $n$ занумерованных элементов.%
\footnote{Формально говоря, это множество из $n$ элементов и фиксированный линейный порядок на нем.}
{\it Перестановкой} называется биективное отображение $\sigma\colon X_n\to X_n$.
Множество всех перестановок на $n$ элементном множестве будем обозначать через $\Sym{n}$.

\paragraph{Как задавать перестановки}

Как только вам встречается новый объект, первый важный вопрос -- а как подобные объекты вообще задавать?
Для перестановок есть три способа:
\begin{enumerate}
\item Задать стрелками соответствие на элементах
\[
\xymatrix{
	{1}\ar[d]&{2}\ar[dr]&{3}\ar[dr]&{4}\ar[dll]&{5}\ar[d]\\
	{1}&{2}&{3}&{4}&{5}
}
\]

\item С помощью таблицы значений (графика).
Здесь под каждым элементом пишется его образ:
\[
\begin{pmatrix}
{1}&{2}&{3}&{4}&{5}\\
{1}&{3}&{4}&{2}&{5}\\
\end{pmatrix}
\]

\item Графически в виде действия на элементах
\[
\xymatrix@R=10pt{
	{}&{2}\ar[rrd]&{}&{}\\
	{1}\ar@(dl,ul)&{}&{}&{3}\ar[dl]\\
	{}&{5}\ar@(dl,ul)&{4}\ar[luu]&{}
}
\]
\end{enumerate}

Все эти виды записи однозначно задают перестановку.
Самым популярным методом в литературе является второй способ.
В общем виде для перестановки $\sigma\in\Sym{n}$ табличная запись выглядит следующим образом:
\[
\begin{pmatrix}
{1}&{2}&{\ldots}&{n}\\
{\sigma(1)}&{\sigma(2)}&{\ldots}&{\sigma(n)}\\
\end{pmatrix}
\]
Заметим, что, если записать элементы $1,\ldots,n$ в другом порядке, скажем, $i_1,\ldots,i_n$, то перестановка $\sigma$ запишется в виде%
\footnote{Заметим, что в этой записи можно произвольным образом перемешивать столбцы, это никак не изменит задаваемую перестановку.}
\[
\begin{pmatrix}
{i_1}&{i_2}&{\ldots}&{i_n}\\
{\sigma(i_1)}&{\sigma(i_2)}&{\ldots}&{\sigma(i_n)}\\
\end{pmatrix}
\]
Из однозначности табличной записи получаем следующее.
\begin{claim*}
Количество перестановок на $n$ элементах есть $n!$, т.е. $|\Sym{n}| = n!$.
\end{claim*}


\subsection{Операция на перестановках}

Так как перестановки являются отображениями, а на отображениях есть операция композиции, то и на перестановках появляется операция.
Пусть $\sigma,\tau\in\Sym{n}$ -- две произвольные перестановки, определим $\sigma \tau$ как композицию, т.е. $\sigma\tau(k) = \sigma(\tau(k))$.
На языке диаграмм
\[
\xymatrix{
	{X_n}\ar[r]^{\tau}\ar@/_20pt/[rr]^{\sigma\tau}&{X_n}\ar[r]^{\sigma}&{X_n}
}
\]

\paragraph{Важно}

Обратите внимание, что перестановки применяются к элементам справа налево.
Это связано с тем, что они являются отображениями, а когда вы считаете композицию отображений, то вы сначала применяете к аргументу самое правое, потом следующее за ним и так далее.


Давайте посмотрим как выглядит произведение двух перестановок в табличной записи.
Пусть даны перестановки
\[
\sigma = 
\begin{pmatrix}
{1}&{2}&{3}&{4}\\
{4}&{1}&{2}&{3}
\end{pmatrix}\text{ и }
\tau = 
\begin{pmatrix}
{1}&{2}&{3}&{4}\\
{2}&{1}&{4}&{3}
\end{pmatrix}
\]
То перестановки $\sigma \tau$ и $\tau\sigma$ имеют вид
\[
\sigma \tau= 
\begin{pmatrix}
{1}&{2}&{3}&{4}\\
{1}&{4}&{3}&{2}
\end{pmatrix}\text{ и }
\tau \sigma= 
\begin{pmatrix}
{1}&{2}&{3}&{4}\\
{3}&{2}&{1}&{4}
\end{pmatrix}
\]


\paragraph{Свойства умножения}

\begin{itemize}
\item Если $\sigma, \tau, \rho \in\Sym{n}$ -- произвольные перестановки, то как легко видеть по определению $(\sigma\tau)\rho = \sigma(\tau\rho)$.
То есть в выражениях составленных из перестановок и произведений не важно в каком порядке расставлять скобки.
Потому скобки обычно опускаются.

\item Умножение перестановок не коммутативно, то есть вообще говоря $\sigma\tau \neq \tau \sigma$.%
\footnote{Один пример мы уже видели, еще один будет в разделе <<Циклические перестановки>>.} 

\item Тождественное отображение $\Identity$ является нейтральным элементом для умножения перестановок в том смысле, что верно $\Identity \sigma = \sigma \Identity = \sigma$ для любой перестановки $\sigma$.
В табличной записи $\Identity$ имеет вид
\[
\begin{pmatrix}
{1}&{2}&{\ldots}&{n}\\
{1}&{2}&{\ldots}&{n}\\
\end{pmatrix}
\]

\item Обратное отображение к $\sigma$ будем обозначать через $\sigma^{-1}$.
Оно будет обратным элементом относительно операции в том смысле, что $\sigma \sigma^{-1} = \sigma^{-1}\sigma = \Identity$.
В табличной записи обратное отображение можно записать так
\[
\begin{pmatrix}
{\sigma(1)}&{\sigma(2)}&{\ldots}&{\sigma(n)}\\
{1}&{2}&{\ldots}&{n}\\
\end{pmatrix}
\]
\end{itemize}

\subsection{Переименование элементов}

В нашем определении перестановка -- это биекция на множестве $X_n$.
Однако, элементы $X_n$ имеют конкретные имена -- это числа от $1$ до $n$.
А что произойдет, если мы сменим имена элементов?
Как изменится табличная запись перестановки?

В начале надо понять, что значит переименование элементов.
Во-первых, у нас есть запас старых имен $\{1,\ldots,n\}$, во-вторых, у нас должен быть список новых имен, скажем, $\{"1"{}, \ldots, "n"\}$ и, в-третьих, у нас должно быть соответствие, которое по старым именам строит новые, т.е. $\tau\colon \{1,\ldots,n\} \to \{"1"{}, \ldots, "n"\}$.
Потому, если мысленно убрать кавычки, то на переименование можно смотреть как на перестановку $\tau\colon X_n\to X_n$.

Пусть теперь у нас есть перестановка $\sigma\colon X_n\to X_n$.
Ее можно записать в табличном виде в старых и новых именах.
Чтобы различать эти таблицы мы будем использовать обозначения $\sigma_\text{стар}$ и $\sigma_\text{нов}$ для них соответственно.
Тогда мы можем записать связь между ними с помощью следующей диаграммы:
\[
\xymatrix{
	{\{1,\ldots, n\}}\ar[r]^-{\tau}\ar[d]_{\sigma_\text{стар}}&{\{"1"{},\ldots,"n"\}}\ar[d]^{\sigma_\text{нов}}\\
	{\{1,\ldots, n\}}\ar[r]^-{\tau}&{\{"1"{},\ldots,"n"\}}\\
}
\]
Если вспомнить, что $\{"1"{},\ldots, "n"\} = \{\tau(1),\ldots,\tau(n)\}$, то действие $\sigma_\text{нов}$ в новых именах устроено так: мы берем произвольный элемент с новым именем $\tau(k)$, находим его старое имя -- $k$, на старом имени можем подействовать $\sigma_\text{стар}$, которое есть $\sigma(k)$, а теперь надо найти новое имя для образа, что есть $\tau(\sigma(k))$.

Подытожим, что $\sigma_\text{нов}=\tau\sigma_\text{стар}\tau^{-1}$.
В табличной записи перестановки выглядят так
\[
\sigma_\text{стар} = 
\begin{pmatrix}
{1}&{2}&{\ldots}&{n}\\
{\sigma(1)}&{\sigma(2)}&{\ldots}&{\sigma(n)}\\
\end{pmatrix}\quad
\sigma_\text{нов} = 
\begin{pmatrix}
{\tau(1)}&{\tau(2)}&{\ldots}&{\tau(n)}\\
{\tau(\sigma(1))}&{\tau(\sigma(2))}&{\ldots}&{\tau(\sigma(n))}\\
\end{pmatrix}
\]
Хорошо еще иметь перед глазами следующую картинку:
\[
\xymatrix@R=10pt@C=10pt{
	{}&{2\leftrightarrow\tau(2)}\ar[dr]&{}&{}&{}&{6\leftrightarrow\tau(6)}\ar[ddl]&{}&{}\\
	{1\leftrightarrow\tau(1)}\ar[ur]&{}&{3\leftrightarrow\tau(3)}\ar[dl]&{5\leftrightarrow\tau(5)}\ar[urr]&{}&{}&{8\leftrightarrow\tau(8)}\ar@(ul,ur)&{9\leftrightarrow\tau(9)}\ar@(ul,ur)\\
	{}&{4\leftrightarrow\tau(4)}\ar[ul]&{}&{}&{7\leftrightarrow\tau(7)}\ar[ul]&{}&{}&{}\\
}
\]
Здесь в вершинах подписаны и старые и новые имена, а перестановка одна и та же.

\subsection{Циклы}

Пусть $\sigma\in \Sym{n}$ действует следующим образом: для некоторого множества $i_1,\ldots,i_k$ ($k\geqslant 2$) выполнено 
\[
\sigma(i_1) = i_2,\ldots,\,\sigma(i_{k-1}) = i_k,\,\sigma(i_k) = i_1,
\]
а все остальные элементы остаются на месте под действием $\sigma$.
Тогда $\sigma$ называется {\it циклом} длины $k$.
Такая перестановка для краткости обозначается $(i_1,\ldots,i_k)$.
Заметим, что такая запись не единственная: например, можно сказать $\sigma = (i_2,\ldots,i_k,i_1)$.%
\footnote{Как легко видеть, другой неоднозначности в записи цикла нет.}
Стоит отметить, что если в определении выше выбрать $k=1$, то перестановка обозначаемая $(i_1)$ совпадает с тождественной перестановкой.
Потому циклов длины $1$ просто не существует.
Однако, в некоторых случаях сама запись $(i_1)$ является удобным обозначением для единообразия в формулах.
Потому такие <<циклы>> принято называть тривиальными (подразумевая не цикл, а обозначение), а настоящие циклы -- нетривиальными.

Таблицей цикл задается следующим образом
\[
\begin{pmatrix}
{i_1}&{\ldots}&{i_{k-1}}&{i_k}&{j_1}&{\ldots}&{j_{n-k}}\\
{i_2}&{\ldots}&{i_k}&{i_1}&{j_{1}}&{\ldots}&{j_{n-k}}\\
\end{pmatrix}
\]
где $\{1,\ldots,n\} = \{i_1,\ldots,i_k\}\sqcup\{j_1,\ldots,j_{n-k}\}$.
Графически этот цикл выглядит так
\[
\xymatrix@R=10pt{
	{}&{}&{}&{}&{}&{i_2}\ar[rdd]&{}\\
	{}&{}&{}&{i_1}\ar[urr]&{}&{}&{}\\
	{j_1}\ar@(ul,ur)&{\ldots}&{j_{n-k}}\ar@(ul,ur)&{}&{}&{}&{i_3}\ar[dl]\\
	{}&{}&{}&{}&{i_k}\ar[uul]&{\ldots}\ar[l]&{}\\
}
\]

Цикл длины $2$ называется {\it транспозицией}, т.е. транспозиция $(i,j)$ -- это перестановка двух элементов $i$ и $j$.
Два цикла $(i_1,\ldots,i_k)$ и $(j_1,\ldots,j_m)$ называются {\it независимыми}, если множества $\{i_1,\ldots,i_k\}$ и $\{j_1,\ldots,j_m\}$ не пересекаются, т.е. множества действительно перемещаемых элементов не пересекаются.
Заметим, что независимые циклы коммутируют друг с другом, а зависимые вообще говоря нет, как показывает следующий пример: $(1,2)(2,3) = (1,2,3)$, а $(2,3)(1,2) = (3,2,1)$.%
\footnote{Проверьте это.}${}^{,\,}$%
\footnote{Зависимые циклы могут коммутировать, например $(1,2)$ коммутирует с $(1,2)$.}

\begin{claim}
\label{claim:CycleRename}
Пусть $\rho = (i_1,\ldots, i_k)\in\Sym{n}$ -- некоторый цикл длины $k$ и $\tau\in\Sym{n}$ -- произвольная перестановка, тогда 
\[
\tau(i_1,\ldots,i_k)\tau^{-1} = (\tau(i_1),\ldots,\tau(i_k))
\]
\end{claim}
\begin{proof}
Есть два способа понять это равенство.
Первый -- посмотреть на $\tau$ как на переименование элементов.
Тогда справа написан цикл по элементам с новыми именами, а слева -- правило переименования.

Второй способ -- проверка в лоб.
Надо проверить, что и левая и правая часть одинаково действуют на всех элементах вида $\tau(i)$.
Возьмем элемент $\tau(i_1)$, тогда правая часть его переводит в $\tau(i_2)$.
Посмотрим, что с ним делает левая часть.
Вначале, мы переходим в $i_1$, потом в $i_2$, а потом в $\tau(i_2)$.
Получили то же самое.
Аналогично проверяется, что $\tau(i)$ остается на месте, если $i$ не совпадает ни с одним из $i_s$.
\end{proof}

Теперь мы готовы доказать структурный результат о перестановках.

\begin{claim}
\label{claim:PermutationStructure}
Пусть $\sigma\in\Sym{n}$ -- произвольная перестановка.
Тогда
\begin{enumerate}
\item Перестановку $\sigma$ можно представить в виде $\sigma = \rho_1 \ldots \rho_k$, где $\rho_i$ -- независимые циклы.
Причем это представление единственное с точностью до перестановки сомножителей.

\item Пусть $\rho\in\Sym{n}$ -- произвольный цикл длины $k$, тогда его можно представить в виде $\rho = \tau_1\ldots \tau_{k-1}$, где $\tau_i$ -- транспозиции.%
\footnote{Это представление уже не единственное.}
\end{enumerate}
\end{claim}
\begin{proof}
(1) Пусть $i_1\in X_n$ -- произвольный элемент.
Подействуем на него $\sigma$, получим $i_2 = \sigma(i_1)$ и т.д.
Так как $X_n$ конечно, то мы в какой-то момент повторимся, например $i_5 = i_2$, как на рисунке ниже
\[
\xymatrix{
	{}&{i_2}\ar[r]^{\sigma}&{i_3}\ar[dl]^{\sigma}\\
	{i_1}\ar[ru]^{\sigma}&{i_4}\ar[u]^{\sigma}&{}\\
}
\]
На этой картинке видно, что $\sigma(i_1) = \sigma(i_4)$, но $\sigma$ инъективно, потому $i_1 = i_4$.
То есть правильная картинка следующая
\[
\xymatrix{
	{}&{i_2}\ar[r]^{\sigma}&{i_3}\ar[dll]^{\sigma}\\
	{i_1}\ar[ru]^{\sigma}&{}&{}\\
}
\]
Далее возьмем элемент, который не попал на этот цикл и повторим рассуждение для него.
Так найдем другой цикл и т.д.
В итоге картинка будет приблизительно такая
\[
\xymatrix{
	{}&{i_2}\ar[r]&{i_3}\ar[dll]&{i_5}\ar[rd]&{}&{i_7}\ar@/^10pt/[dr]&{}&{i_9}\ar@(dl,dr)\\
	{i_1}\ar[ru]&{}&{i_4}\ar[ru]&{}&{i_6}\ar[ll]&{}&{i_8}\ar@/^10pt/[ul]&{}\\
}
\]
Значит перестановка выше раскладывается в циклы $\sigma = (i_1,i_2,i_3) (i_4,i_5,i_6)(i_7,i_8)$.%
\footnote{Цикл $(i_9)$ здесь не используется, так как он совпадает с тождественной перестановкой $\Identity$, как и любой другой цикл длины $1$.} 

Единственность такого разложения следует из метода пристального взгляда на картинку и наше рассуждение.
Если нужно формальное объяснение, то нужно делать так.
Пусть $\sigma = \rho_1\ldots \rho_k$ и пусть $\rho_1 = (i_1,\ldots,i_s)$.
Подействуем $\sigma$ на элемент $i_1$.
Так как циклы справа независимы, то только $\rho_1$ действует на $i_1$ и значит $\sigma(i_1)=\rho_1 \ldots \rho_k(i_1) = i_2$.
То есть $i_2$ однозначно определено.
Продолжая в том же духе, мы видим, что все циклы однозначно определяются через $\sigma$.


(2) Пусть цикл $\sigma$ действует по правилу как на картинке ниже
\[
\xymatrix@R=10pt@C=10pt{
  {1}\ar[dr]&{2}\ar[dr]&{3}\ar[dr]&{4}\ar[dr]&{5}\ar[dllll]\\
  {1}&{2}&{3}&{4}&{5}\\
}
\]
Чтобы получить цикл длины $k$ нам необходимо применить $k-1$ транспозицию.
То есть в нашем примере надо применить $4$.
Сделаем это следующим образом
\[
\xymatrix@R=15pt@C=20pt{
  {}\ar@{=>}_{(1,2,3,4,5)}[dddd]&{1}\ar[d]&{2}\ar[d]&{3}\ar[d]&{4}\ar[dr]&{5}\ar[dl]&{}\ar@{=>}[d]^{(4,5)}\\
  {}&{1}\ar[d]&{2}\ar[d]&{3}\ar[dr]&{4}\ar[dl]&{5}\ar[d]&{}\ar@{=>}[d]^{(3,4)}\\
  {}&{1}\ar[d]&{2}\ar[dr]&{3}\ar[dl]&{4}\ar[d]&{5}\ar[d]&{}\ar@{=>}[d]^{(2,3)}\\
  {}&{1}\ar[dr]&{2}\ar[dl]&{3}\ar[d]&{4}\ar[d]&{5}\ar[d]&{}\ar@{=>}[d]^{(1,2)}\\
  {}&{1}&{2}&{3}&{4}&{5}&{}\\
}
\]
То есть в общем случае $(1,2,\ldots,k) = (1,2)(2,3)\ldots(k-2,k-1)(k-1,k)$.

\end{proof}

Давайте поймем, почему представление во втором случае не единственное.
Рассмотрим перестановку $(1,2)(2,3)$.
Тогда
\[
(1,2)(2,3) = (1,2)(2,3)(1,2)^{-1}(1,2) = (1,3)(1,2)
\]
здесь в первом равенстве мы поделили и домножили на $(1,2)$, а во втором воспользовались утверждением~\ref{claim:CycleRename}.

\subsection{Знак перестановки}

Рассмотрим произвольное отображение 
\[
\phi\colon \Sym{n}\to \{\pm 1\}
\]
удовлетворяющее следующим двум свойствам:
\begin{enumerate}
\item $\phi(\sigma \tau) = \phi(\sigma)\phi(\tau)$ для любых $\sigma, \tau \in\Sym{n}$.%
\footnote{Здесь справа стоит произведение чисел вида $1$ или $-1$.}

\item $\phi\not\equiv 1$, т.е. $\phi$ не равно тождественно $1$.
\end{enumerate}
Заметим, что несложно найти отображение удовлетворяющее только первому свойству, например, $\phi(\sigma) = 1$ для любого $\sigma$, что не интересно.
Наша основная задача доказать следующее.

\begin{claim}
Существует единственное отображение $\phi\colon \Sym{n} \to \{\pm 1\}$ обладающее свойствами~(1) и~(2).
\end{claim}

В этом случае такое отображение обозначается $\sgn\colon \Sym{n}\to \{\pm1\}$ и называется знаком.
Значение $\sgn(\sigma)$ называется знаком перестановки $\sigma\in\Sym{n}$.
Перестановка называется четной, если знак $1$ и нечетной, если $-1$.

\paragraph{Существование}

Обычно знак перестановки $\sigma$ определяют в виде $(-1)^{d(\sigma)}$, где $d(\sigma)$ -- некоторая целочисленная характеристика перестановки $\sigma$.
Классическим определением является {\it число беспорядков}.%
\footnote{Оно же {\it число инверсий}.} 

Пусть $\sigma \in\Sym{n}$ -- некоторая перестановка и $i,j\in X_n$ -- НЕупорядоченная пара различных элементов.%
\footnote{То есть пару $i, j$ и $j, i$ мы считаем одной и той же.}
Тогда эта пара называется {\it инверсией}, если <<$\sigma$ меняет характер монотонности>>, т.е. $i<j$ влечет $\sigma(i)>\sigma(j)$, а $i>j$ влечет $\sigma(i)<\sigma(j)$.
Если использовать запись перестановки в виде
\[
\xymatrix@R=10pt{
	{1}\ar[d]&{2}\ar[dr]&{3}\ar[dr]&{4}\ar[dll]&{5}\ar[d]\\
	{1}&{2}&{3}&{4}&{5}
}
\]
то инверсия соответствует пересечению стрелок.
Определим число $d_{ij}(\sigma) = 1$, если пара $i, j$ образует инверсию и $0$, если не образуют.
Тогда число всех инверсия для всевозможных пар это $d(\sigma) = \sum_{i < j} d_{ij}(\sigma)$.
Определим отображение $\sgn\colon \Sym{n}\to \{\pm 1\}$ по правилу $\sgn(\sigma) = (-1)^{d(\sigma)}$.
Для доказательства существования надо проверить, что $\sgn$ обладает указанными свойствами~(1) и~(2), то есть надо доказать следующее.

\begin{claim*}
Пусть $\sigma,\tau\in\Sym{n}$ -- произвольные перестановки, тогда 
\[
\sgn(\sigma\tau) = \sgn(\sigma)\sgn(\tau)\quad \text{и}\quad \sgn(1,2) = -1
\]
\end{claim*}
\begin{proof}
Второе утверждение очевидно, в перестановке $(1,2)$ всего одна инверсия, а значит $\sgn(1,2) = -1$.

Для доказательства первого надо показать, что
\[
d(\sigma) + d(\tau) = d(\sigma \tau) \pmod 2
\]
Давайте фиксируем пару $i, j$ и докажем следующее равенство
\[
d_{ij}(\tau) + d_{\tau(i)\tau(j)}(\sigma) = d_{ij}(\sigma \tau) \pmod 2
\]
Возможны следующие $4$ случая:
\begin{align*}
&{
\begin{matrix}
{\tau}\\{}\\{\sigma}
\end{matrix}\quad
\begin{aligned}
\xymatrix@R=10pt@C=10pt{
	{i}\ar[dr]&{}&{j}\ar[dr]&{}\\
	{}&{\tau(i)}\ar[d]&{}&{\tau(j)}\ar[dl]\\
	{}&{\sigma\tau(i)}&{\sigma\tau(j)}&{}\\
}
\end{aligned}
}&&{
\begin{matrix}
{\tau}\\{}\\{\sigma}
\end{matrix}\quad
\begin{aligned}
\xymatrix@R=10pt@C=10pt{
	{i}\ar[drrr]&{}&{j}\ar[dl]&{}\\
	{}&{\tau(j)}\ar[d]&{}&{\tau(i)}\ar[dl]\\
	{}&{\sigma\tau(j)}&{\sigma\tau(i)}&{}\\
}
\end{aligned}
}\\
&{
\begin{matrix}
{\tau}\\{}\\{\sigma}
\end{matrix}\quad
\begin{aligned}
\xymatrix@R=10pt@C=10pt{
	{i}\ar[dr]&{}&{j}\ar[dr]&{}\\
	{}&{\tau(i)}\ar[dr]&{}&{\tau(j)}\ar[dll]\\
	{}&{\sigma\tau(j)}&{\sigma\tau(i)}&{}\\
}
\end{aligned}
}&&{
\begin{matrix}
{\tau}\\{}\\{\sigma}
\end{matrix}\quad
\begin{aligned}
\xymatrix@R=10pt@C=10pt{
	{i}\ar[drrr]&{}&{j}\ar[dl]&{}\\
	{}&{\tau(j)}\ar[dr]&{}&{\tau(i)}\ar[dll]\\
	{}&{\sigma\tau(i)}&{\sigma\tau(j)}&{}\\
}
\end{aligned}
}\\
\end{align*}
Занесем результаты в таблицу
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
{$d_{ij}(\tau)$}&{0}&{1}&{0}&{1}\\
\hline
{$d_{\tau(i)\tau(j)}(\sigma)$}&{0}&{0}&{1}&{1}\\
\hline
{$d_{ij} + d_{\tau(i)\tau(j)}(\sigma)$}&{0}&{1}&{1}&{2}\\
\hline
{$d_{ij}(\sigma\tau)$}&{0}&{1}&{1}&{0}\\
\hline
\end{tabular}
\end{center}
Что доказывает равенство
\[
d_{ij}(\tau) + d_{\tau(i)\tau(j)}(\sigma) = d_{ij}(\sigma \tau) \pmod 2
\]
Теперь сложим его для всех пар $i < j$.
Получим
\[
\sum_{i<j}d_{ij}(\tau) + \sum_{i<j}d_{\tau(i)\tau(j)}(\sigma) = \sum_{i<j}d_{ij}(\sigma \tau) \pmod 2
\]
Откуда
\[
d(\tau) + \sum_{i<j}d_{\tau(i)\tau(j)}(\sigma) = d(\sigma \tau) \pmod 2
\]
Так как $\tau\colon X_n\to X_n$ -- биекция, то если $(i,j)$ пробегает все разные пары, то и $(\tau(i),\tau(j))$ пробегает все разные пары.
Значит оставшаяся сумма равна $d(\sigma)$, что завершает доказательство.
\end{proof}
