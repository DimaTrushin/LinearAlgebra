\ProvidesFile{lecture15.tex}[Лекция 15]


\newpage
\section{Линейные операторы}

В этом разделе я наконец-то вам начну рассказывать о самых важных объектах в линейной алгебре -- линейных операторах.

\subsection{Определение и базовые свойства}
\label{section::LinearOpDef}

\begin{definition}
Пусть $V$ -- векторное пространство над полем $F$, тогда линейным оператором на $V$ называется линейное отображение $\varphi \colon V\to V$.
\end{definition}

Так как линейный оператор -- это частный случай линейного отображения, то для него применимо все, о чем мы уже говорили в случае отображений.
Про линейный оператор надо думать как про деформацию пространства $V$.

\paragraph{Примеры}

\begin{enumerate}
\item $\Identity\colon V\to V$, $v\mapsto v$.
Тождественный линейный оператор, ничего не деформирует.

\item $0\colon V\to V$, $v \mapsto 0$.
Нулевой линейный оператор, который все отправляет в ноль.

\item $A\colon \mathbb R^3 \to \mathbb R^3$, $x\mapsto Ax$, где $A\in \Matrix{3}$ задана так
\[
A = 
\begin{pmatrix}
{1}&{0}&{0}\\
{0}&{\cos \alpha}&{-\sin \alpha}\\
{0}&{\sin \alpha}&{\cos \alpha}\\
\end{pmatrix}
\]
-- поворот на угол $\alpha$ вокруг оси $\langle e_1\rangle$.

\item Пусть $V = U\oplus W$, тогда зададим $\pi\colon V\to V$ по правилу $v = u + w \mapsto u$.
Так как разложение в прямой сумме однозначно, то это корректно задает линейный оператор, который называется проектором на $U$ вдоль $W$.
Обратите внимание, что $\ker \pi = W$ и $\Im \pi = U$.
При этом для любого $u\in \Im\pi$ верно $\pi u = u$.
\end{enumerate}

\begin{claim}
\label{claim::Projector}
Пусть $V$ -- векторное пространство над полем $F$ и $\pi\colon V\to V$ -- линейный оператор.
Тогда следующие свойства эквивалентны:
\begin{enumerate}
\item Существуют подпространства $U,W\subseteq V$ такие, что $V = U\oplus W$ и $\pi$ является проектором на $U$ вдоль $W$.

\item $\pi^2 = \pi$.
\end{enumerate}
\end{claim}
\begin{proof}
(1)$\Rightarrow$(2).
Рассмотрим произвольный $v\in V$, тогда $\pi^2(v) = \pi(\pi(v))$.
Но вектор $\pi(v)$ лежит в образе $\pi$, то есть в $U$.
Как я уже отмечал в замечании выше, на векторах из образа проектор $\pi$ действует тождественно, то есть $\pi(\pi(v)) = \pi(v)$, что и требовалось.

(2)$\Rightarrow$(1).
Пусть $\pi^2 = \pi$.
Для начала нам  надо откуда-то взять подпространства $U$ и $W$.
Замечание выше подсказывает, что надо положить $U = \Im \pi$ и $W = \ker \pi$.
Теперь надо показать две вещи: (1) $V$ раскладывается в прямую сумму $U$ и $W$, (2) действие $\pi$ совпадает с действием проектора на $U$ вдоль $W$.

Для (1) нам надо показать, что $U\cap W = 0$ и $U + W = V$.
Начнем с пересечения.
Пусть $v\in U\cap W$ -- произвольный вектор.
Тогда с одной стороны $v\in U = \Im \pi$, а значит $v = \pi(v')$ и $v'\in V$.
С другой стороны, $v\in W = \ker \pi$, а значит $\pi(v) = 0$.
Но тогда
\[
0 = \pi(v) = \pi(\pi(v')) = \pi^2(v') = \pi(v') = v
\]
Значит в пересечении лежит только нулевой вектор.

Теперь займемся суммой.
Мы должны показать, что любой вектор из $V$ представляется в виде суммы векторов из $U$ и $W$.
Пусть $v\in V$, рассмотрим следующее разложение
\[
v = \pi (v) + (\Identity - \pi) (v) = \pi(v) + (v - \pi(v))
\]
Первый вектор $\pi(v)$ по определению попадает в $\Im\pi = U$.
Проверим, что второй лежит в ядре:
\[
\pi((\Identity - \pi)(v)) = \pi(v - \pi(v)) = \pi(v) - \pi^2(v) = 0
\]
Значит $V = U + W$.

Теперь мы знаем, что $V = U\oplus W = \Im \pi \oplus \ker \pi$.
Давайте покажем, что $\pi$ действует как проектор.
Возьмем $v\in V$, тогда он представляется в виде $v = u + w$, где $u = \pi(v)$ и $w = v - \pi(v)$.
Применим $\pi$ к $v$ и видим, что получаем $u$.
По определению действие $\pi$ совпадает с действием проектора на $U$ вдоль $W$.
\end{proof}

\paragraph{Замечание}

\begin{itemize}
\item Таким образом, если мы хотим разложить какое-то пространство $V$ в прямую сумму подпространств, нам достаточно найти оператор на $V$, который в квадрате равен самому себе.

\item Обратите внимание, что $\Identity$ является по определению проектором на все пространство вдоль  нулевого подпространства, а $0$ является проектором на нулевое подпространство вдоль всего пространства.
Эти операторы дают тривиальное разложение пространства $V$ в прямую сумму $0 \oplus V$.
Эти случаи надо иметь в виду.
\end{itemize}

\subsection{Матрица линейного оператора}

Пусть в векторном пространстве $V$ задан  некоторый базис $e_1,\ldots, e_n$ и пусть $\varphi \colon V\to V$ -- линейный оператор.
Так как у оператора пространство из которого он бьет и то в которое он бьет совпадают, то мы фиксируем всего лишь один базис (пространство-то у нас одно).
Тогда по определению матрица линейного оператора $\varphi$ -- это такая матрица $A_\varphi\in \operatorname{M}_{n}(F)$, что выполнено $\varphi e = e A_\varphi$, где $e = (e_1,\ldots,e_n)$.

Пусть теперь у нас задан другой базис $e_1',\ldots,e_n'$ в пространстве $V$ с матрицей перехода $C\in \operatorname{M}_n(F)$, то есть $(e_1',\ldots,e_n') = (e_1,\ldots,e_n)C$.
Пусть так же $e' = (e_1',\ldots,e_n')$.
Тогда матрица $\varphi$ в базисе $e'$ пусть будет $A_\varphi'$, то есть $\varphi e' = e' A_\varphi'$.
В этом случае связь между матрицами следующая $A_\varphi' = C^{-1}A_\varphi C$.
То есть матрица $A_\varphi$ сопряжена матрице $A_\varphi'$.%
\footnote{Напомню, что квадратные матрицы $B$ и $D$ называются сопряженными, если найдется обратимая матрица $C$ такая, что $D= C^{-1}BC$.}

\paragraph{Замечания}

\begin{itemize}
\item Отметим, что матрица линейного оператора обязательно квадратная.
Таким образом, изучение линейного отображения -- это изучение прямоугольной матрицы, а изучение линейного оператора -- это всегда изучение только квадратной матрицы.

\item Если линейное отображение $\psi\colon V\to U$ бьет между двумя разными пространствами одинаковой размерности, то ему тоже соответствует квадратная матрица.
Но принципиальная разница с линейным оператором заключается в том, что для линейного отображения мы можем независимо менять базисы в $V$ и $U$, что соответствует замене $A_\psi' = C^{-1}A_\psi D$, а для линейного оператора, так как пространство одно и то же, базисы меняются одновременно, что соответствует $A_\varphi' = C^{-1}A_\varphi C$.

\item Так как линейные операторы -- это линейные отображения, то задавать их можно так же как и линейные отображения, например: либо с помощью образа базисных векторов, либо с помощью матрицы в фиксированном базисе.
\end{itemize}

\subsection{Характеристики линейных операторов}

В этом разделе я перечислю основные характеристики, которые можно определить для любого линейного оператора.

\paragraph{След}

Перед определением докажем техническое утверждение.

\begin{claim*}
Пусть $V$ -- векторное пространство над полем $F$ и пусть $\varphi\colon V\to V$ -- некоторый линейный оператор.
Тогда число $\tr(A_\varphi)$ не зависит от базиса, в котором посчитана матрица $A_\varphi$.
\end{claim*}
\begin{proof}
Действительно, пусть у нас есть два базиса $e' = (e_1',\ldots,e_n')$ и $e = (e_1,\ldots,e_n)$ связанные матрицей перехода $e' = eC$.
Пусть $\varphi e = eA_\varphi$ и $\varphi e' = e' A_\varphi'$.
Тогда как мы видели выше $A_\varphi' = C^{-1} A_\varphi C$.
Тогда
\[
\tr(A_\varphi') = \tr (C^{-1}A_\varphi C) = \tr(A_\varphi C C^{-1}) = \tr(A_\varphi)
\]
\end{proof}

Положим по определению $\tr\varphi = \tr A_\varphi$ и будем называть это число следом оператора $\varphi$.
Это определение корректно, так как данное число не зависит от базиса, в котором считается матрица оператора.%
\footnote{Тут нужно сделать важное замечание.
Как мы видим след оператора определяется через его матрицу, но не зависит от матрицы, а зависит только от самого линейного оператора.
Потому есть соблазн дать эквивалентное определение совсем не используя матрицу оператора.
К сожалению так сделать невозможно.
Одной из причин является отсутствие следа в бесконечно мерных векторных пространствах.
Любые попытки дать <<без координатное>> определение следа на самом деле является лишь тщательной маскировкой его координатной природы.}

\paragraph{Определитель}

Перед определением докажем техническое утверждение.

\begin{claim*}
Пусть $V$ -- векторное пространство над полем $F$ и пусть $\varphi\colon V\to V$ -- некоторый линейный оператор.
Тогда число $\det(A_\varphi)$ не зависит от базиса, в котором посчитана матрица $A_\varphi$.
\end{claim*}
\begin{proof}
Действительно, пусть у нас есть два базиса $e' = (e_1',\ldots,e_n')$ и $e = (e_1,\ldots,e_n)$ связанные матрицей перехода $e' = eC$.
Пусть $\varphi e = eA_\varphi$ и $\varphi e' = e' A_\varphi'$.
Тогда как мы видели выше $A_\varphi' = C^{-1} A_\varphi C$.
Тогда
\[
\det(A_\varphi') = \det (C^{-1}A_\varphi C) = \det(C^{-1})\det(A_\varphi)\det(C) =\det(A_\varphi)
\]
\end{proof}

Положим по определению $\det\varphi = \det A_\varphi$ и будем называть это число определителем оператора $\varphi$.
Это определение корректно, так как данное число не зависит от базиса, в котором считается матрица оператора.%
\footnote{Здесь верно то же самое замечание, что и для следа.
Определитель оператора нельзя определить без матрицы оператора, но в то же время он не зависит от матрицы, а зависит лишь от самого оператора.}

\paragraph{Характеристический многочлен}

Пусть опять $\varphi\colon V\to V$ -- произвольный линейный оператор, тогда для любого $\lambda \in F$, $\lambda \Identity - \varphi\colon V\to V$ -- тоже линейный оператор.
Тогда по предыдущему определению корректно определен определитель такого оператора, который мы обозначим так: $\chi_\varphi (\lambda) = \det(\lambda \Identity - \varphi)$ и будем называть характеристическим многочленом оператора $\varphi$.

Пусть теперь в некотором базисе $\varphi$ имеет матрицу $A_\varphi$.
Тождественный оператор $\Identity$ в любом базисе задается единичной матрицей.
Тогда по предыдущему определению $\det(\lambda \Identity - 
\varphi)$ совпадает с $\det (\lambda E - A_\varphi)$.
То есть характеристический многочлен оператора -- это характеристический многочлен любой из его матриц в каком-нибудь базисе (в силу корректности определения определителя оператора, все эти многочлены будут одинаковыми).

Есть другой способ смотреть на характеристический многочлен.
Можно просто сказать, что для оператора $\varphi$ его характеристический многочлен -- это характеристический многочлен его матрицы $A_\varphi$ и надо лишь показать, что он не зависит от базиса.
Это делается следующей проверкой
\[
\det(\lambda E - C A_\varphi C^{-1}) = \det(\lambda C C^{-1} - C A_\varphi C^{-1}) = \det(C(\lambda E - A_\varphi)C^{-1}) = \det(\lambda E - A_\varphi)
\]

\paragraph{Спектр}

Как и выше $\varphi\colon V\to V$ -- линейный оператор на векторном пространстве, тогда положим 
\[
\spec_F(\varphi) = \{\lambda\in F\mid \varphi - \lambda \Identity \text{ не обратим}\}
\]
И будем называть это множество спектром линейного оператора $\varphi$.%
\footnote{Заметим, что определение спектра дается без помощи матрицы линейного оператора.}
Пусть теперь $A_\varphi$ -- матрица линейного оператора в каком-нибудь базисе.
Оператор обратим тогда и только тогда, когда обратима его матрица (потому что все операции над операторами превращаются в операции над матрицами).
Потому условие $\varphi - \lambda \Identity$ не обратим превращается в условие $A_\varphi - \lambda E$ не обратима.
То есть спектр линейного оператора совпадает со спектром любой из его матриц в каком-нибудь базисе.

\paragraph{Минимальный многочлен}

Если у нас есть многочлен $f\in F[t]$ вида $f = a_0 + a_1 t + \ldots + a_nt^n$ и задан линейный оператор $\varphi \colon V\to V$, то можно определить оператор $f(\varphi)$ по правилу
\[
f(\varphi) = a_0 \Identity + a_1 \varphi + \ldots + a_n \varphi^n
\]
Здесь степень $\varphi^k$ -- это композиция оператора $\varphi$ с самим собой $k$ раз, а сумма и умножение на коэффициенты из поля берутся поточечно.%
\footnote{Смотри определения для линейных отображений в разделе~\ref{section::HomOperations}.}

Если в результате подстановки оператора в многочлен мы получили нулевой оператор (тот который на всех векторах действует нулем), то мы говорим, что многочлен зануляет $\varphi$ и пишем $f(\varphi) = 0$.
Если в каком-то базисе $e_1,\ldots,e_m\in V$ оператор $\varphi$ имеет матрицу $A\in \operatorname{M}_{m}(F)$, то $f(\varphi) = 0$ тогда и только тогда, когда $f(A) = 0$.
Действительно, при переходе к базису $f(\varphi)$ имеет матрицу $f(A)$, а нулевой оператор соответствует нулевой матрице.
Теперь мы можем определить минимальный многочлен оператора, как такой ненулевой многочлен $f_{\text{min}\,\varphi}\in F[t]$, что
\begin{enumerate}
\item $f_{\text{min}\,\varphi}(\varphi) = 0$.

\item $f_{\text{min}\,\varphi}$ имеет наименьшую степень среди всех ненулевых многочленов зануляющих $\varphi$.

\item Старший коэффициент $f_{\text{min}\,\varphi}$ равен единице.
\end{enumerate}
В силу того, что для многочлена занулять оператор это тоже самое, что занулять его матрицу, то минимальный многочлен для линейного оператора совпадает с минимальным многочленом для его матрицы в любом базисе.

\paragraph{Ранг}

Мы знаем, что линейный оператор -- это просто линейное отображение, но на одном пространстве.
Для любого линейного отображения мы видели, что ранг его матрицы не меняется при смене базиса (см. утверждение~\ref{claim::HomClassification}).
В частности ранг матрицы линейного оператора не меняется при смене базиса.

\subsection{Обратимость оператора}

\begin{claim}
\label{claim::OperatorInvert}
Пусть $V$ -- векторное пространство над некоторым полем $F$ и $\varphi\colon V\to V$ -- некоторый линейный оператор.
Тогда следующие свойства эквивалентны:
\begin{enumerate}
\item $\ker \varphi = 0$.

\item $\Im \varphi = V$.

\item $\varphi$ обратим.

\item $\det \varphi \neq 0$.
\end{enumerate}
\end{claim}
\begin{proof}
Это утверждение является преформулировкой утверждения~\ref{claim::InvertibleDiscription} на языке оператора.
С другой стороны его можно получить из комбинации пунктов утверждения~\ref{claim::ImKer}.
\end{proof}

\subsection{Инвариантные подпространства}

Пусть $U\subseteq V$ -- подпространство в некотором векторном пространстве $V$ над полем $F$ и пусть $\varphi\colon V\to V$ -- некоторый линейный оператор.
Будем говорить, что векторное подпространство $U$ является инвариантным относительно $\varphi$ (или просто $\varphi$-инвариантным), если $\varphi(U)\subseteq U$.

\paragraph{Пример}

\begin{itemize}
\item Рассмотрим пример поворота трехмерного пространства вокруг некоторой оси, а именно, пусть $A\colon \mathbb R^3 \to \mathbb R^3$, $x\mapsto Ax$, где $A\in \Matrix{3}$ задана так
\[
A = 
\begin{pmatrix}
{1}&{0}&{0}\\
{0}&{\cos \alpha}&{-\sin \alpha}\\
{0}&{\sin \alpha}&{\cos \alpha}\\
\end{pmatrix}
\]
В данном случае мы поворачиваем вокруг оси $\langle e_1 \rangle$.
Заметим, что подпространство $\langle e_1\rangle$ является инвариантным, любой вектор из этого подпространства остается неподвижным.
Кроме того, подпространство $\langle e_2, e_3\rangle$ -- плоскость поворота, тоже является инвариантным относительно $\varphi$, любой вектор в ней поворачивается на угол $\alpha$.

\item Для любого оператора $\varphi \colon V\to V$ его ядро и образ являются инвариантными подпространствами.
\end{itemize}

\paragraph{Ограничение оператора} 

\begin{definition}
Пусть $V$ -- векторное пространство над полем $F$.
Если $\varphi \colon V\to V$ -- линейный оператор и $U\subseteq V$ -- некоторое инвариантное подпространство, то тогда можно определить оператор $\varphi|_U\colon U\to U$, действующий по правилу $u\mapsto \varphi(u)$.
Такой оператор называется ограничением $\varphi$ на $U$.
\end{definition}

\paragraph{Инвариантность в терминах матрицы}

Пусть $V = U \oplus W$ -- прямая сумма подпространств.
Выберем в $U$ базис $e=(e_1,\ldots,e_n)$, а в $W$ базис $f = (f_1,\ldots,f_m)$.
Тогда $e \cup f$ является базисом $V$.
Если $\varphi \colon V \to V$ -- некоторый линейный оператор, то его можно записать в этом базисе в следующем блочном виде
\[
\varphi (e, f) = (e, f)
\begin{pmatrix}
{A}&{B}\\
{C}&{D}
\end{pmatrix}
\]
Заметим, что при этом подпространство $U$ будет $\varphi$-инвариантным тогда и только тогда, когда $C = 0$.
Действительно, если $U$ инвариантно, то $\varphi(U)\subseteq U$.
С другой стороны $U = \langle e \rangle$.
То есть $U$ инвариантно тогда и только тогда, когда $\varphi(e) \subseteq U$.
С другой стороны, по определению матрицы оператора $\varphi (e) = eA + fC$.
Но $eA + fC$ лежит в $\langle e\rangle$ тогда и только тогда, когда $C = 0$.
В этом случае определен оператор $\varphi|_U$ и матрица $A$ будет матрицей этого оператора в базисе $e$.

Аналогично, подпространство $W$ инвариантно тогда и только тогда, когда $B = 0$.
Если же оба пространства инвариантны, то матрица $\varphi$ является блочно диагональной.
То есть отсюда мы видим геометрический смысл блочно верхнетреугольных и блочно диагональных матриц.
Блочно верхнетреугольная означает наличие инвариантных подпространств натянутых на первый кусок базисных векторов.
Блочно диагональный вид означает разложение пространства в прямую сумму инвариантных подпространств.
Подобное разбиение в прямую сумму инвариантных позволяет сводить задачу про один оператор к задачам про оператор на пространстве меньшего размера.
Это бывает полезно, если надо вести рассуждение индукцией по размерности подпространств.

\begin{claim}
\label{claim::KerImInvar}
Пусть $\varphi,\psi\colon V\to V$ два коммутирующих линейных оператора.
Тогда $\ker \varphi$ и $\Im\varphi$ являются $\psi$-инвариантными.
\end{claim}
\begin{proof}
Случай $\ker \varphi$.
Мы должны показать, что $\psi(\ker\varphi) \subseteq \ker \varphi$.
Возьмем произвольный вектор $v\in \ker\varphi$, нам надо показать, что $\psi(v) \in \ker \varphi$.
То есть мы должны показать, что $\varphi(\psi(v)) = 0$.
Но $\varphi \psi v = \psi \varphi v = \psi 0 = 0$.

Случай $\Im \varphi$.
Мы должны показать, что $\psi(\Im \varphi) \subseteq \Im \varphi$.
Возьмем произвольный вектор $v\in \Im\varphi$, нам надо показать, что $\psi(v) \in \Im\varphi$.
Но условие $v\in \Im \varphi$ означает, что $v = \varphi (u)$ для некоторого $u\in V$.
Но тогда $\psi v = \psi \varphi u = \varphi (\psi(u))$, что и требовалось.
\end{proof}


