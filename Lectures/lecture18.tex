\ProvidesFile{lecture18.tex}[Лекция 18]


\subsection{Теоремы о разложении}

\begin{claim}
\label{claim::CoprimeKernels}
Пусть $\varphi\colon V\to V$ -- линейный оператор над полем $F$ и пусть $p,q\in F[t]$ -- два взаимно простых многочлена.
Тогда 
\begin{enumerate}
\item $\ker p(\varphi)\cap \ker q(\varphi) = 0$.

\item Оператор $p(\varphi)|_{\ker q(\varphi)}$ существует и обратим.
\end{enumerate}
\end{claim}
\begin{proof}
(1)  Из того, что многочлены $p$ и $q$ взаимнопросты, по расширенному алгоритму Евклида, найдутся многочлены $u,v\in F[t]$ такие, что $1 = u(t)p(t) + v(t)q(t)$.
Пусть теперь $w$ -- вектор из пересечения, тогда
\[
w = u(\varphi) p(\varphi) w + v(\varphi) q(\varphi) w = 0
\]

(2) Так как операторы $p(\varphi)$ и $q(\varphi)$ коммутируют, то ядро $q(\varphi)$ инвариантно относительно $p(\varphi)$ по утверждению~\ref{claim::KerImInvar}.
А значит существует оператор ограничения.
Так как для операторов обратимость равносильна инъективности (утверждение~\ref{claim::OperatorInvert}), то нам достаточно показать, что $\ker q(\varphi)|_{\ker p(\varphi)} = 0$.
Но $\ker q(\varphi)|_{\ker p(\varphi)} = \ker q(\varphi) \cap \ker p(\varphi) = 0$.
\end{proof}



\begin{claim}
\label{claim::IdealRootDec}
Пусть $\varphi\colon V\to V$ -- линейный оператор над полем $F$, $f\in F[t]$ зануляющий многочлен такой, что $f = p q \in F[t]$, где $(p, q) = 1$.
Тогда
\begin{enumerate}
\item $\ker p(\varphi) = \Im q(\varphi)$.

\item $\ker q(\varphi) = \Im p(\varphi)$.

\item $V = \ker p(\varphi) \oplus \ker q(\varphi)$.

\item Для любого $\varphi$ инвариантного подпространства $U\subseteq V$ выполнены равенства
\[
U = U\cap \ker p(\varphi) \oplus U \cap \ker q(\varphi) = \pi_1(U)\oplus \pi_2(U)
\]
где $\pi_1 \colon V\to V$ -- проектор на $\ker p(\varphi)$ вдоль $\ker q(\varphi)$, то есть для вектора $v = u + w$, где $u\in \ker p(\varphi)$ и $w\in \ker q(\varphi)$, имеем $\pi_1(v) = u$.
Аналогично, $\pi_2\colon V\to V$ -- проектор на $\ker q(\varphi)$ вдоль $\ker p(\varphi)$.

\item Если $f$ -- минимальный многочлен для $\varphi$, то  многочлен $p$ будет минимальным для оператора $\varphi|_{\ker p(\varphi)}$.

\end{enumerate}
\end{claim}
\begin{proof}
В начале сделаем некие общие подготовительные работы.
Из того, что многочлены $p$ и $q$ взаимнопросты, по расширенному алгоритму Евклида, найдутся многочлены $u,v\in F[t]$ такие, что $1 = u(t)p(t) + v(t)q(t)$.
Подставим в это равенство и в $f$ оператор $\varphi$, получим два равенства
\begin{gather*}
\Identity = u(\varphi) p(\varphi) + v(\varphi) q(\varphi)\\
0 = p(\varphi) q(\varphi)
\end{gather*}

(1) и (2).
Так как утверждения~(1) и~(2) симметричны, то достаточно доказать одно из них.

В начале покажем, что $\Im q(\varphi)\subseteq \ker p(\varphi)$.
Так как $p(\varphi)q(\varphi) = 0$, то для любого $w\in V$ верно, что $p(\varphi)q(\varphi)w = 0$, но это означает, что $q(\varphi)w \in\ker p(\varphi)$, то есть $\Im q(\varphi)\subseteq \ker p(\varphi)$.

Наоборот, возьмем $w\in \ker p(\varphi)$ и применим к нему первое операторное равенство, получим
\[
w = u(\varphi) p(\varphi) w + v(\varphi) q(\varphi) w = v(\varphi) q(\varphi) w =   q(\varphi) v(\varphi) w\in \Im q(\varphi)
\]

(3) Из взаимной простоты $p$ и $q$ следует, что $\ker p(\varphi) \cap \ker q(\varphi) = 0$ по утверждению~\ref{claim::CoprimeKernels}.
Значит сумма этих под пространств прямая, то есть $\ker p(\varphi) \oplus \ker q(\varphi) \subseteq V$.
Чтобы показать равенство, возьмем произвольный $w\in V$ и рассмотрим
\[
w = u(\varphi) p(\varphi) w + v(\varphi) q(\varphi) w = p(\varphi) u(\varphi) w + q(\varphi) v(\varphi) w\in \Im p(\varphi) +\Im q(\varphi) = \ker q(\varphi) + \ker p(\varphi)
\]
Здесь последнее равенство выполнено в силу предыдущих двух пунктов.

(4) Пусть $U\subseteq V$ инвариантное подпространство.
Тогда $U\cap \ker p(\varphi) \subseteq U$ и $U\cap \ker q(\varphi) \subseteq U$, а значит и их сумма лежит в $U$.
С другой стороны, так как $\ker p(\varphi)$ и $\ker q(\varphi)$ пересекаются по нулю, то и подпространства $U\cap \ker p(\varphi)$ и $U\cap \ker q(\varphi)$ тоже пересекаются по нулю.
А значит они образуют прямую сумму внутри $U$, то есть $U \supseteq U\cap \ker p(\varphi) \oplus U \cap \ker q(\varphi)$.
Осталось доказать, обратное включение.
Пусть $w\in U$, тогда 
\[
w = v(\varphi) q(\varphi) w + u(\varphi) p(\varphi) w
\]
Так как $U$ было инвариантным и  $w\in U$, то $v(\varphi) q(\varphi) w \in U$.
С другой стороны,
\[
p(\varphi) v(\varphi) q(\varphi) w = v(\varphi) p(\varphi)  q(\varphi) w = 0
\]
А значит, $v(\varphi) q(\varphi) w\in \ker p(\varphi)$.
Таким образом, мы проверили, что первое слагаемое лежит в $U\cap \ker p(\varphi)$.
Аналогично проверяется включение для второго слагаемого.

Теперь мы знаем, что любое инвариантное $U\subseteq V$ имеет вид $U = U_1 \oplus U_2$, где $U_1 = U\cap \ker p(\varphi)$ и $U_2 = U\cap \ker q(\varphi)$.
Давайте применим $\pi_1$ к $U$.
По определению 
\[
\pi_1(U) = \pi_1(U_1 + U_2) = \pi_1(U_1) = U_1.
\]
Аналогично $\pi_2 (U) = U_2$.
А значит $U = U_1\oplus U_2 = \pi_1(U) \oplus \pi_2(U)$, то есть мы доказали второе равенство.


(5) Теперь мы считаем, что $f = f_\text{min}$ для $\varphi$ на $V$.
Заметим, что
\[
p(\varphi|_{\ker p(\varphi)}) = p(\varphi)|_{\ker p(\varphi)} = 0
\]
Значит $p$ зануляет $\varphi|_{\ker p(\varphi)}$.
Так как минимальный многочлен обязательно делит $p$, то нам надо показать, что никакой делитель $p$ отличный от $p$ не зануляет $\varphi|_{\ker p(\varphi)}$.
Предположим противное, пусть $p_0 | p$ и $p_0(\varphi|_{\ker p(\varphi)}) = 0$.
Тогда рассмотрим многочлен $g = p_0 q$ и покажем, что $g(\varphi) = 0$.
Так как $V = \ker p(\varphi) \oplus \ker q(\varphi)$, то нам достаточно показать, что  $g(\varphi)$ действует нулем на любом векторе из $\ker p(\varphi)$ и на любом векторе из $\ker q(\varphi)$.
Но на $\ker q(\varphi)$ нулем действует $q(\varphi)$, а $g(\varphi) = p_0(\varphi)q(\varphi)$.
А на $\ker p(\varphi)$ оператор $p_0(\varphi)$ действует нулем по выбору $p_0$, а значит и $g(\varphi) = q(\varphi) p_0(\varphi)$ действует нулем.
То есть многочлен $g$ зануляет $\varphi$ и имеет степень меньше, чем $f_\text{min}$, противоречие.

\end{proof}

\begin{claim}
\label{claim::GenRootDec}
Пусть $\varphi\colon V\to V$ -- линейный оператор, $f_\text{min}$ -- его минимальный многочлен.
Пусть
\[
f_\text{min} = p_1^{k_1} \ldots p_r^{k_r}
\]
разложение минимального в неприводимые многочлены.
Тогда
\begin{enumerate}
\item  $V^{p_i} = \ker p_i^{k_i}(\varphi)$ причем $k_i$ -- минимальное такое $k$ для которого выполнено равенство $V^{p_i} = \ker p_i^{k}(\varphi)$.

\item $V = V^{p_1}\oplus \ldots \oplus V^{p_r}$.

\item Любое инвариантное подпространство $U\subseteq V$ имеет вид $U = U_1\oplus \ldots \oplus U_r$, где $U_i \subseteq V^{p_i}$ -- произвольные инвариантные подпространства.
\end{enumerate}
\end{claim}
\begin{proof}
1) В начале покажем, что $V^{p_i} = \ker p_i^{k_i}(\varphi)$, а уже потом, что $k_i$ минимально.

Не умаляя общности можно считать, что $i = 1$.
Тогда сгруппируем множители минимального многочлена следующим образом $f_\text{min} = p_1^{k_1} g$.
Так как минимальный многочлен -- зануляющий, то $p_1^{k_1}(\varphi)g(\varphi) = 0$ на всем пространстве $V$, а значит и на подпространстве $V^{p_1}$.
Тогда утверждение~\ref{claim::CoprimeKernels}, примененное для многочленов $p_1^d$ и $g$, означает, что оператор $g(\varphi)$ будет обратим на пространстве $V^{p_1}$.
А значит можно в равенстве $p_1^{k_1}(\varphi)g(\varphi) = 0$  сократить на $g(\varphi)$ и получить, что $p_1^{k_1}(\varphi) = 0$ на $V^{p_1}$.
То есть $V^{p_1}\subseteq \ker p_1^{k_1}(\varphi)$.
Обратное вложение следует из определения $V^{p_i}$.

Теперь покажем, что $k_1$ -- это минимальная степень $d$ такая, что $V^{p_1} = \ker p_1^d(\varphi)$.
Нам нужно показать, что на подпространстве $V^{p_1}$ многочлен $p_1^{k_1}$ является минимальным для оператора $\varphi$.
Из утверждения~\ref{claim::IdealRootDec} пункт~(5) следует, что $p_1^{k_1}$ является минимальным для $\varphi$ на подпространстве $\ker p_1^{k_1}(\varphi)$.
Но последнее по только что доказанному совпадает с $V^{p_1}$.


С другой стороны, по утверждению~\ref{claim::IdealRootDec} пункт~(5) $p_1^{k_1}$ будет минимальным многочленом для $\varphi$ ограниченного на $\ker p_1^{k_1}(\varphi) = V^{p_1}$.
А значит, никакая меньшая степень $p_1^k(\varphi)$ не зануляется на $V^{p_1}$.
А значит $d \geqslant k_1$.

2) Сгруппируем множители $f_\text{min}$ следующим образом
\[
f_\text{min} = \underbrace{p_1^{k_1}}_{p}\underbrace{p_2^{k_2}\ldots p_r^{k_r}}_{q}
\]
Тогда, $p$ и $q$ взаимно просты и по утверждению~\ref{claim::IdealRootDec} пункт~(3) мы можем разложить $V$ в прямую сумму 
\[
V = \ker p(\varphi) \oplus \ker q(\varphi) = \ker p_1^{k_1}(\varphi) \oplus V_1
\]
где $V_1 = \ker q(\varphi)$.
При этом минимальный многочлен оператора $\varphi_1 = \varphi|_{\ker q(\varphi)}$ есть $q$ (утверждение~\ref{claim::CoprimeKernels}).
Тогда продолжая по индукции для оператора $\varphi_1$ в пространстве $V_1$, мы можем считать, что
\[
V = \ker p_1^{k_1}(\varphi)\oplus \ldots \oplus \ker p_r^{k_r}(\varphi)
\]
Теперь осталось показать, что $\ker p_i^{k_i}(\varphi) =  V^{p_i}$, но это следует из предыдущего пункта.

3) Это непосредственно следует из утверждения~\ref{claim::IdealRootDec} пункт~(4) индукцией по количеству прямых слагаемых.
\end{proof}

\subsection{Геометрический смысл кратности корней минимального и характеристического многочлена}

\begin{claim}
\label{claim::RootMultGeom}
Пусть $\varphi\colon V \to V$ -- линейный оператор и $\lambda \in \spec_F \varphi$.
Пусть число $k$ выбрано так, что
\[
\ker (\varphi-\lambda\Identity)^{k-1} \neq \ker (\varphi-\lambda\Identity)^k = \ker (\varphi-\lambda\Identity)^{k+1}
\]
Тогда
\begin{enumerate}
\item Число $k$ -- это кратность $\lambda$ в минимальном многочлене оператора $\varphi$.

\item Число $\dim \ker(\varphi - \lambda \Identity)^k = \dim V^\lambda$ -- это кратность корня $\lambda$ в характеристическом многочлене оператора $\varphi$.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Это частный случай утверждения~\ref{claim::GenRootDec} пункт~(1) для $p_1(x) = x-\lambda$.

(2) Пусть $f_\text{min} = (x-\lambda)^k g(x)$ -- минимальный многочлен для $\varphi$ на $V$.
Тогда пользуясь утверждением~\ref{claim::IdealRootDec} пункт~(3) и предыдущим пунктом этого утверждения, мы видим, что $V = V^\lambda \oplus \ker g(\varphi)$.
Теперь давайте посчитаем характеристический многочлен для $\varphi$.
По утверждению~\ref{claim::RestrictionChar} $\chi_\varphi(t)$ есть произведение $\chi_{\varphi|_{V^\lambda}}$ и $\chi_{\varphi|_{\ker g(\varphi)}}$.
Утверждение~\ref{claim::CharPolyOnRootSpace} гласит, что $\chi_{\varphi|_{V^\lambda}}(t) = (t - \lambda)^{\dim V^\lambda}$.
А утверждение~\ref{claim::CoprimeKernels} пункт~(2), что $\varphi - \lambda\Identity$ обратим на $\ker g(\varphi)$.
Значит, оператор $\varphi|_{\ker g(\varphi)}$ не содержит $\lambda$ в своем спектре, а значит $\lambda$ не корень $\chi_{\varphi|_{\ker g(\varphi)}}$.
Это завершает доказательство.
\end{proof}

\subsection{Минимальные инвариантные}

Пусть $\varphi\colon V\to V$ -- некоторый оператор и $p\in \spec^I_F\varphi$.
В этом случае подпространство $V_p = \ker p(\varphi)$ не нулевое.
Более того, по определению оператор $p(\varphi)$ равен нулю на этом подпространстве, а значит $p$ зануляет $\varphi|_{V_p}$.
В частности минимальный многочлен $\varphi|_{V_p}$ должен делить $p$.
Но так как $p$ неприводим, то единственный вариант -- минимальный многочлен совпадает с $p$.
Аналогично, если $U\subseteq V_p$ произвольное ненулевое инвариантное подпространство, то минимальный многочлен $\varphi_U$ будет $p$ по тем же самым соображениям.
Мы знаем, что в случае обычного спектра собственное подпространство $V_\lambda$ состоит из инвариантных прямых, на которых $\varphi$ действует растяжением в $\lambda$ раз.
В случае $V_p$ все подпространство состоит из одинаковых инвариантных кусочков, которые уже не являются прямыми.
Давайте опишем как эти инвариантные подпространства выглядят.

\begin{claim}
Пусть $\varphi\colon V\to V$ -- некоторый оператор и $p\in \spec^I_F\varphi$ и при этом $m = \deg p$.
И пусть $v\in V_p$ -- произвольный ненулевой вектор.
Тогда $v,\varphi v,\ldots, \varphi^{m-1}v$ линейно независимы и их линейна оболочка будет минимальным инвариантным подпространством содержащем $v$.
\end{claim}
\begin{proof}
Давайте рассмотрим линейную оболочку
\[
U = \langle v, \varphi v, \varphi^2 v, \ldots, \varphi^k v, \ldots\rangle
\]
По построению ясно, что это инвариантное подпространство содержащее $v$.
Кроме того, если какое-то инвариантное подпространство $W$ содержит $v$, то оно обязано содержать $\varphi v$.
А значит обязано содержать $\varphi^2 v$ и так далее.
То есть оно содержит $U$.
Таким образом $U$ является наименьшим инвариантным подпространством содержащим $v$.

Теперь рассмотрим элемент $p = t^m + a_{m-1}t^{m-1} + \ldots + a_1 t + a_0$.
Подставим в него $\varphi$ и получим ноль, то есть
\[
0 = p(\varphi) = \varphi^m + a_{m-1} \varphi^{m-1} + \ldots + a_1 \varphi + a_0 \Identity
\]
Теперь применим это равенство к вектору $v$, получим
\[
\varphi^mv + a_{m-1} \varphi^{m-1}v + \ldots + a_1 \varphi v + a_0 v = 0
\]
А значит $\varphi^m v$ выражается через $\varphi^k v$, где $k < m$.
Умножая это равенство на $\varphi^N$ мы видим, что при $N \geqslant m$, $\varphi^N v$ выражается через $\varphi^k v$, где $k < N$.
Следовательно подпространство $U$ порождается векторами $v, \varphi v, \ldots, \varphi^{m-1} v$.

Теперь покажем, что эти векторы линейно независимы.
Предположим противное, то есть найдется система коэффициентов $\alpha_0,\ldots, \alpha_{m-1}$ такая, что
\[
\alpha_0 v + \alpha_1 \varphi v + \ldots + \alpha_{m-1} \varphi^{m-1} v = 0
\]
Если мы положим $q(t) = \alpha_0 + \alpha_1 t + \ldots + \alpha_{m-1} t^{m-1}$, то это означает, что $q(\varphi)v = 0$.
Так как $q(\varphi)$ и $\varphi^k$ коммутируют для любого $k$, то $q(\varphi) \varphi^k v = \varphi^k q(\varphi) v = 0$ для любого $k$.
А это значит, что $q$ зануляет $\varphi|_U$.
Но по замечанию перед утверждением мы знаем, что минимальный многочлен для $\varphi|_U$ должен быть $p$.
А значит $p$ делит $q$ и так как $\deg q < \det p$, такое возможно только если $q = 0$.
То есть если все $\alpha_i = 0$, что и требовалось.
\end{proof}

Таким образом в случае $\lambda \in \spec_F \varphi$ ему соответствует линейный многочлен $t - \lambda \in \spec^I_F\varphi$.
А значит линейному многочлену соответствуют одномерные инвариантные подпространства в $V_\lambda$.
В случае если элемент идеального спектра $p$ имеет степень больше единицы, то $V_p$ содержит инвариантные размерности $\deg p$.
На самом деле можно показать, что все такие инвариантные подпространства внутри $V_p$ <<одинаковые>> в некотором смысле и все $V_p$ есть их прямая сумма.
