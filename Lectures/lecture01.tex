\ProvidesFile{lecture01.tex}[Лекция 1]

\newpage

\section{Системы линейных уравнений}

% TO DO
% Добавить вступительное слово про линейную алгебру и что в ней интересного

\subsection{Системы линейных уравнений и связанная с ними терминология}

Наша задачи научиться решать Системы Линейных Уравнений (СЛУ), то есть находить все их решения или доказывать, что решений нет.
Общий вид СЛУ и ее однородная версия (ОСЛУ):
\[
\left\{
\begin{aligned}
a_{11}x_1 + &\ldots + a_{1n}x_n = b_1\\
&\ldots \\
a_{m1}x_1 + &\ldots + a_{mn}x_n = b_m
\end{aligned}
\right.\quad\quad
\left\{
\begin{aligned}
a_{11}x_1 + &\ldots + a_{1n}x_n = 0\\
&\ldots \\
a_{m1}x_1 + &\ldots + a_{mn}x_n = 0
\end{aligned}
\right.
\]

\paragraph{Коэффициенты}

Где живут коэффициенты $a_{ij}$ и $b_j$?
Варианты:
\begin{itemize}
\item Вещественные числа $\mathbb R$

\item Комплексные числа $\mathbb C$

\item Рациональные числа $\mathbb Q$
\end{itemize}
Для решения СЛУ {\bf НЕ} имеет значения откуда берутся коэффициенты, так как решения будут лежать там же.
Потому мы будем работать с числами из $\mathbb R$.

\paragraph{Решение}

Решением системы линейных уравнений называется набор чисел $(c_1,\ldots,c_n)$, $c_i\in\mathbb R$ такой, что при подстановке $c_i$ вместо $x_i$, все уравнения системы превращаются в верные равенства.
Введем обозначение $\mathbb R^n = \mathbb R\times \ldots \times \mathbb R = \{(c_1,\ldots,c_n)\mid c_i\in \mathbb R\}$.
То есть элемент $\mathbb R^n$ -- это набор из $n$ вещественных чисел.
Потому любое решение $c=(c_1,\ldots,c_n)$ является элементом $\mathbb R^n$.

\subsection{Матрицы связанные со СЛУ}

Для каждой СЛУ введем следующие обозначения:
\[
A= 
\begin{pmatrix}
a_{11}&\ldots& a_{1n}\\
\vdots&\ddots&\vdots\\
a_{m1}& \ldots &a_{mn}
\end{pmatrix}\quad
b = 
\begin{pmatrix}
b_1\\
\vdots\\
b_m
\end{pmatrix} \quad
x =
\begin{pmatrix}
x_1\\
\vdots\\
x_n
\end{pmatrix}\quad
(A|b) =
\left(\left.
\begin{matrix}
a_{11}&\ldots&a_{1n}\\
\vdots&\ddots&\vdots\\
a_{m1}&\ldots&a_{mn}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
\vdots\\
b_m\\
\end{matrix}\right)
\]
Названия:
\begin{itemize}
\item $A$ -- матрица системы

\item $b$ -- вектор правой части

\item $(A|b)$ -- расширенная матрица системы

\item $x$ -- вектор решений
\end{itemize}
Будем кратко записывать СЛУ и ее однородную версию так: $Ax = b$ и $Ax = 0$.
Также для краткости будем обозначать системы буквами $\Sigma$.

При решении системы линейных уравнений приходится помногу раз переписывать кучу данных. Для того чтобы сократить эти записи, целесообразно сократить количество записываемой на бумаге информации.
Расширенная матрица системы $(A|b)$ является необходимым минимумом такой информации.
Потому сейчас к такой записи можно относиться как к удобному способу компактно записать систему.

\paragraph{Количество решений}

Случай одного уравнения и одной неизвестной $ax = b$, где $a, b\in \mathbb R$:
\begin{itemize}
\item При $a\neq 0$ -- одно решение $x = b/a$.

\item При $a = 0$, $b\neq 0$ -- нет решений.

\item При $a = 0$, $b = 0$ -- любое число является решением, т.е. бесконечное число решений.
\end{itemize}

\paragraph{Что значит решить систему}

Решить систему значит описать множество ее решений, то есть либо доказать, что система не имеет решений вовсе, либо описать все наборы, которые являются решениями.
Если система не имеет решений, она называется несовместной, в противном случае -- совместной.

\paragraph{Эквивалентные системы}

Пусть даны две системы линейных уравнений с одинаковым числом неизвестных (но быть может разным числом уравнений) $\Sigma_1$ и $\Sigma_2$.
Будем говорить, что эти системы эквивалентны и писать $\Sigma_1 \sim \Sigma_2$, если множества решений этих систем совпадают.
Если $E_i\subseteq \mathbb R^n$ -- множество решений $i$-ой системы, то системы эквивалентны, если $E_1 = E_2$.

Вот полезный пример эквивалентных систем:
\[
\left\{
\begin{aligned}
x + y &= 1\\
x - y &= 0
\end{aligned}
\right.\quad\sim\quad
\left\{
\begin{aligned}
2x &= 1\\
2y &= 1
\end{aligned}
\right.
\]

\paragraph{Как решать систему}

Пусть нам надо решить систему $\Sigma$.
Идея состоит в том, чтобы постепенно менять ее на эквивалентную до тех пор, пока она не упростится до такого состояния, что все ее решения легко описать.
\[
\Sigma = \Sigma_1 \mapsto \Sigma_2 \mapsto \ldots \mapsto \Sigma_n \leftarrow\text{ легко решается}
\]
Теперь надо объяснить две вещи: (1) какого сорта преобразования над системами мы будем делать и (2) к какому замечательному виду мы их приводим и как в нем выглядят все решения.
Ответам на эти два вопроса и будет посвящена оставшаяся часть лекции.

\subsection{Элементарные преобразования} 

Мы разделим все преобразования на три типа%
\footnote{Стоит отметить, что нумерация типов преобразования не является общепринятой и отличается от учебника к учебнику.}:
\begin{align*}
\text{I тип: }&
\left(\left.
\begin{matrix}
a_{11}&\ldots&a_{1n}\\
a_{i1}&\ldots&a_{in}\\
a_{j1}&\ldots&a_{jn}\\
a_{m1}&\ldots&a_{mn}
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_i\\
b_j\\
b_m
\end{matrix}
\right)
\mapsto
\left(\left.
\begin{matrix}
a_{11}&\ldots&a_{1n}\\
a_{i1}&\ldots&a_{in}\\
a_{j1} + \lambda a_{i1}&\ldots&a_{jn}+ \lambda a_{in}\\
a_{m1}&\ldots&a_{mn}
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_i\\
b_j+ \lambda b_i\\
b_m\\
\end{matrix}
\right)
\quad i\neq j
\\
\text{II тип: }&
\left(\left.
\begin{matrix}
a_{11}&\ldots&a_{1n}\\
a_{i1}&\ldots&a_{in}\\
a_{j1}&\ldots&a_{jn}\\
a_{m1}&\ldots&a_{mn}
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_i\\
b_j\\
b_m
\end{matrix}
\right)
\mapsto
\left(\left.
\begin{matrix}
a_{11}&\ldots&a_{1n}\\
a_{j1}&\ldots&a_{jn}\\
a_{i1}&\ldots&a_{in}\\
a_{m1}&\ldots&a_{mn}
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_j\\
b_i\\
b_m
\end{matrix}
\right)
\\
\text{III тип: }&
\left(\left.
\begin{matrix}
a_{11}&\ldots&a_{1n}\\
a_{i1}&\ldots&a_{in}\\
a_{m1}&\ldots&a_{mn}
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_i\\
b_m
\end{matrix}
\right)
\mapsto
\left(\left.
\begin{matrix}
a_{11}&\ldots&a_{1n}\\
\lambda a_{i1}&\ldots&\lambda a_{in}\\
a_{m1}&\ldots&a_{mn}
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
\lambda b_i\\
b_m
\end{matrix}
\right)
\quad \lambda \neq 0
\end{align*}
Поясним словами, что делают преобразования:
\begin{enumerate}
\item Прибавляем к $j$-ой строке $i$-ю, умноженную на константу $\lambda\in\mathbb R$.

\item Меняем местами $i$-ю и $j$-ю строки.

\item Умножаем $i$-ю строку на ненулевую константу $\lambda\neq 0$, $\lambda\in \mathbb R$.
\end{enumerate}

\subsection{Алгоритм Гаусса}

%\paragraph{Приведение к ступенчатому виду}
Этот метод заключается в приведении СЛУ к некоторому <<ступенчатому виду>>, где множество решений очевидно.%
\footnote{Данный метод является самым быстрым возможным как для написания программ, так и для ручного вычисления.
При вычислениях руками, однако, полезно местами пользоваться <<локальными оптимизациями>>, то есть, если вы видите, что какая-то хитрая комбинация строк сильно упростит вид системы, то сделайте ее.}
Разберем типичный ход алгоритма Гаусса на примере $3$ уравнений и $4$ неизвестных.%
\footnote{При переходе от одной матрицы к другой я новым коэффициентам даю старые имена, чтобы не захламлять текст новыми обозначениями.}

\paragraph{Прямой ход алгоритма Гаусса}

Идея прямого хода алгоритма в следующем.
Мы смотрим на левый верхний элемент в матрице и пытаемся с помощью него обнулить все элементы под ним.
Как только обнулили, забываем про первую строку и столбец и повторяем процедуру с оставшейся подматрицей.
\begin{align*}
\left(\left.
\begin{matrix}
a_{11}& a_{12}&a_{13}& a_{14}\\
a_{21}& a_{22}&a_{23}& a_{24}\\
a_{31}& a_{32}&a_{33}& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\quad 2\text{-я строка }-\frac{a_{21}}{a_{11}}\cdot1\text{-я строка}\quad\\
\left(\left.
\begin{matrix}
a_{11}& a_{12}&a_{13}& a_{14}\\
0& a_{22}&a_{23}& a_{24}\\
a_{31}& a_{32}&a_{33}& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\quad 3\text{-я строка }-\frac{a_{31}}{a_{11}}\cdot1\text{-я строка}\quad\\
\left(\left.
\begin{matrix}
a_{11}& a_{12}&a_{13}& a_{14}\\
0& a_{22}&a_{23}& a_{24}\\
0& a_{32}&a_{33}& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\quad 3\text{-я строка }-\frac{a_{32}}{a_{22}}\cdot2\text{-я строка}\quad\\
\left(\left.
\begin{matrix}
a_{11}& a_{12}&a_{13}& a_{14}\\
0& a_{22}&a_{23}& a_{24}\\
0& 0&a_{33}& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\end{align*}
В рассуждениях выше, мы пользовались тем, что угловые элементы $a_{11}$ и $a_{22}$ не нули.
Но вообще говоря так могло не получиться.
Например на третьем шаге могла быть одна из следующих ситуаций (здесь мы смотрим на элемент $a_{22}$):
\[
\left(\left.
\begin{matrix}
a_{11}& a_{12}&a_{13}& a_{14}\\
0&0&a_{23}& a_{24}\\
0& a_{32}&a_{33}& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)
\quad\text{или}\quad
\left(\left.
\begin{matrix}
a_{11}& a_{12}&a_{13}& a_{14}\\
0& 0&a_{23}& a_{24}\\
0& 0&a_{33}& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)
\]
В первом случае $a_{22} = 0$, но при этом есть какой-то ненулевой элемент под ним.
В такой ситуации надо переставить вторую строчку с другой строкой, где второй элемент не ноль.
В примере надо переставить вторую и третью строчку местами.
Во втором случае $a_{22} = 0$ и все элементы под ним.
В такой ситуации надо пропустить второй столбец и перейти к третьему и мы смотрим на элемент $a_{23}$.
После чего повторяем алгоритм Гаусса с подматрицей.

В результате прямого хода алгоритма из-за обнуления коэффициентов могут возникнуть следующие случаи%
\footnote{Это не полный список всех случаев.}
\[
\left(\left.
\begin{matrix}
\underline{a_{11}}& a_{12}&a_{13}& a_{14}\\
0& \underline{a_{22}}&a_{23}& a_{24}\\
0& 0&0& \underline{a_{34}}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)
\quad
\left(\left.
\begin{matrix}
\underline{a_{11}}& a_{12}&a_{13}& a_{14}\\
0& 0&\underline{a_{23}}& a_{24}\\
0& 0&0& \underline{a_{34}}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)
\quad
\left(\left.
\begin{matrix}
\underline{a_{11}}& a_{12}&a_{13}& a_{14}\\
0& \underline{a_{22}}&a_{23}& a_{24}\\
0& 0&0& 0\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
\underline{b_3}\\
\end{matrix}
\right)
\quad
\left(\left.
\begin{matrix}
\underline{a_{11}}& a_{12}&a_{13}& a_{14}\\
0& \underline{a_{22}}&a_{23}& a_{24}\\
0& 0&0& 0\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
0\\
\end{matrix}
\right)
\]

\paragraph{Главные и неглавные переменные}

Подчеркнутые элементы считаются не равными нулю.
Это первые ненулевые коэффициенты в строке, они называются лидерами.
В ступенчатом виде все переменные делятся на главные и свободные.
Соответствующие лидерам переменные называются главными.
Остальные переменные называются свободными.

\paragraph{Обратный ход алгоритма Гаусса}

Задача обратного хода алгоритма в том, чтобы сделать все лидирующие коэффициенты единицами, а все коэффициенты над ними обнулить.
Обратный ход осуществляется снизу вверх.
Разберем типичный обратный ход алгоритма Гаусса.
Подчеркнутые элементы считаются не равными нулю.
\begin{align*}
\left(\left.
\begin{matrix}
\underline{a_{11}}& a_{12}&a_{13}& a_{14}\\
0& \underline{a_{22}}&a_{23}& a_{24}\\
0& 0&\underline{a_{33}}& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\quad \text{разделить }i\text{-ю строку на }a_{ii}\\
\left(\left.
\begin{matrix}
1& a_{12}&a_{13}& a_{14}\\
0& 1&a_{23}& a_{24}\\
0& 0&1& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\quad 2\text{-я строка }-a_{23}\cdot3\text{-я строка}\\
\left(\left.
\begin{matrix}
1& a_{12}&a_{13}& a_{14}\\
0& 1&0& a_{24}\\
0& 0&1& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\quad 1\text{-я строка }-a_{13}\cdot3\text{-я строка}\\
\left(\left.
\begin{matrix}
1& a_{12}&0& a_{14}\\
0& 1&0& a_{24}\\
0& 0&1& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\quad 1\text{-я строка }-a_{12}\cdot2\text{-я строка}\\
\left(\left.
\begin{matrix}
1& 0&0& a_{14}\\
0& 1&0& a_{24}\\
0& 0&1& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&
\end{align*}
В специальных случаях приведенных выше, получим
\[
\left(\left.
\begin{matrix}
1& 0&a_{13}& 0\\
0& 1&a_{23}& 0\\
0& 0&0&1\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)
\quad
\left(\left.
\begin{matrix}
1& a_{12}&0& 0\\
0& 0&1& 0\\
0& 0&0&1\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)
\quad
\left(\left.
\begin{matrix}
1& 0&a_{13}& a_{14}\\
0&1&a_{23}& a_{24}\\
0& 0&0& 0\\
\end{matrix}
\:\right|\:
\begin{matrix}
0\\
0\\
1\\
\end{matrix}
\right)
\quad
\left(\left.
\begin{matrix}
1&0&a_{13}& a_{14}\\
0& 1&a_{23}& a_{24}\\
0& 0&0& 0\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
0\\
\end{matrix}
\right)
\]
Полученный в результате обратного хода вид расширенной матрицы называется улучшенным ступенчатым видом, т.е., это ступенчатый вид, где все лидирующие коэффициенты -- единицы, и все коэффициенты над ними равны нулю.

\paragraph{Удобный формализм}

Пока мы подробно не говорили о матрицах, введем некие удобные обозначения, которые упростят запись решений СЛУ.
\[
a=
\begin{pmatrix}
{a_1}\\{\vdots}\\{a_n}
\end{pmatrix}
\in\mathbb R^n
\text{ и }
b=
\begin{pmatrix}
{b_1}\\{\vdots}\\{b_n}
\end{pmatrix}
\in\mathbb R^n.
\text{ Тогда }
a + b =
\begin{pmatrix}
{a_1 + b_1}\\{\vdots}\\{a_n + b_n}
\end{pmatrix}
\in\mathbb R^n
\text{ и }
\lambda a =
\begin{pmatrix}
{\lambda a_1}\\{\vdots}\\{\lambda a_n}
\end{pmatrix}
\in\mathbb R^n\text{ для любого }\lambda\in\mathbb R.
\]

\paragraph{Получение решений}

В системе ниже, выберем переменную $x_4$ как параметр
\[
\left(\left.
\begin{matrix}
1& 0&0& a_{14}\\
0& 1&0& a_{24}\\
0& 0&1& a_{34}\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)
\]
Тогда решения имеют вид%
\footnote{Операция умножения матрицы на число покомпонентная (умножаем каждый элемент на число).
Сумма и разность двух матриц покомпонентная (складываем или вычитаем числа на одних и тех же позициях).}
\[
\begin{pmatrix}
x_1\\
x_2\\
x_3
\end{pmatrix}
=
\begin{pmatrix}
b_1\\
b_2\\
b_3
\end{pmatrix}
-
x_4
\begin{pmatrix}
a_{14}\\
a_{24}\\
a_{34}
\end{pmatrix}
\]
Специальные случаи:
\begin{align*}
\left(\left.
\begin{matrix}
1& 0&a_{13}& 0\\
0& 1&a_{23}& 0\\
0& 0&0&1\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&\quad
\text{Решения:}\quad
\begin{pmatrix}
x_1\\
x_2\\
x_4
\end{pmatrix}
=
\begin{pmatrix}
b_1\\
b_2\\
b_3
\end{pmatrix}
-
x_3
\begin{pmatrix}
a_{13}\\
a_{23}\\
0
\end{pmatrix}\\
\left(\left.
\begin{matrix}
1& a_{12}&0& 0\\
0& 0&1& 0\\
0& 0&0&1\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
b_3\\
\end{matrix}
\right)&\quad
\text{Решения:}\quad
\begin{pmatrix}
x_1\\
x_3\\
x_4
\end{pmatrix}
=
\begin{pmatrix}
b_1\\
b_2\\
b_3
\end{pmatrix}
-
x_2
\begin{pmatrix}
a_{12}\\
0\\
0
\end{pmatrix}\\
\left(\left.
\begin{matrix}
1& 0&a_{13}& a_{14}\\
0&1&a_{23}& a_{24}\\
0& 0&0& 0\\
\end{matrix}
\:\right|\:
\begin{matrix}
0\\
0\\
1\\
\end{matrix}
\right)&\quad
\text{Решения:}\quad
\text{Нет решений, т.к. последнее уравнение }0 = 1
\\
\left(\left.
\begin{matrix}
1&0&a_{13}& a_{14}\\
0& 1&a_{23}& a_{24}\\
0& 0&0& 0\\
\end{matrix}
\:\right|\:
\begin{matrix}
b_1\\
b_2\\
0\\
\end{matrix}
\right)&\quad
\text{Решения:}\quad
\begin{pmatrix}
x_1\\
x_2
\end{pmatrix}
=
\begin{pmatrix}
b_1\\
b_2
\end{pmatrix}
-
x_3
\begin{pmatrix}
a_{13}\\
a_{23}
\end{pmatrix}
-
x_4
\begin{pmatrix}
a_{14}\\
a_{24}
\end{pmatrix}
\end{align*}

\paragraph{Количество решений в ступенчатом виде}

Если во время прямого хода алгоритма Гаусса в расширенной матрице системы вам встретилась строка вида $(0 \ldots 0 \mid b)$, где $b$ -- произвольное ненулевое число, то данная система решений не имеет.
В этом случае нет необходимости переходить к обратному ходу.
Если же таких строк не встретилось, то система обязательно имеет решения.
При этом, если есть свободные переменные, то решений бесконечное число, а если их нет, то решение единственное.

\paragraph{Широкие системы}

Пусть вам дана однородная система из $m$ уравнений с $n$ неизвестными и $m < n$, тогда утверждается, что она обязательно имеет хотя бы одно ненулевое решение, то есть такое решение, где хотя бы одна переменная отличная от нуля. Действительно, так как у однородной системы всегда есть решение, то нам достаточно доказать, что у системы в улучшенном ступенчатом виде есть свободные переменные. Если это так, то придавая свободным переменным ненулевые значения, мы получим ненулевое решение. Чтобы понять, что есть свободные переменные, давайте оценим сверху количество главных. Главных переменных не больше чем строк, а строк строго меньше, чем всех переменных, вот и все.


\paragraph{Технические рекомендации}

Работая с целочисленными матрицами,  старайтесь во время прямого хода алгоритма Гаусса не выходить за рамки целых чисел.
\begin{itemize}
\item Используйте элементарные преобразования I типа только с целым параметром.

\item Полезно не злоупотреблять умножением на ненулевое целое, умножайте только на $\pm1$.
Иначе придется работать с большими числами.
\end{itemize}
На этапе обратного хода алгоритма Гаусса избавиться от деления уже не возможно.


