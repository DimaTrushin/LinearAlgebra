\ProvidesFile{lecture13.tex}[Лекция 13]


\newpage
\section{Линейные отображения}

\subsection{Идея и определение}

Пусть $F$ -- некоторое поле и нам даны два векторных пространства $V$ и $U$.
Самый первый вопрос, который встает глядя на них: а как их сравнить?
Одно и то же ли это пространство?
Для того, чтобы отвечать на подобные вопросы, нам и нужны линейные отображения.
Давайте начнем с более простого вопроса: а как сравнивать множества?
Множества сравниваются с помощью отображений.
Всевозможные теоремы об эквивалентности разных подходов с помощью инъективных, сюръективных и биективных отображений в конце концов говорят, что два множества надо считать одинаковыми, если между ними есть биекция, то есть в них одинаковый запас элементов.
Но теперь векторное пространство -- это не просто множество, на нем еще есть и операции.
Если на биекцию смотреть, как на способ переименовать элементы, то теперь мы хотим, чтобы при этом переименовании одни операции превращались в другие, то есть мы хотим, чтобы наше отображение было согласовано неким способом с операциями.
Ну и как в случае множеств, мы не будем ограничивать себя только биекциями, ибо все остальные отображения тоже оказываются очень полезными для сравнения разных векторных пространств.

\begin{definition}
Пусть $V$ и $U$ -- векторные пространства над некоторым полем $F$.
Отображение $\varphi\colon V\to U$ называется линейным, если оно удовлетворяет двум свойствам:
\begin{enumerate}
\item $\varphi(v_1 + v_2) = \varphi(v_1) + \varphi(v_2)$ для всех $v_1,v_2\in V$.

\item $\varphi(\lambda v) = \lambda \varphi(v)$ для всех $\lambda \in F$ и всех $v\in V$.
\end{enumerate}
\end{definition}

\paragraph{Примеры}

\begin{enumerate}
\item $F^n \to F^m$ задано по правилу $x\mapsto Ax$, где $A\in \operatorname{M}_{m\,n}(F)$.

\item $V\to U$ задано по правилу $v\mapsto 0$ для любого $v\in V$.
Такое отображение называется нулевым и обозначается $0$.

\item $V\to V$ задано по правилу $v\mapsto v$.
Такое отображение называется тождественным и обозначается $\Identity$.

\item Пусть $D[0,1]$ -- множество дифференцируемых функций на отрезке $[0,1]$, $F[0,1]$ -- множество всех функций на отрезке $[0,1]$.
Тогда зададим линейное отображение $D[0,1]\to F[0,1]$ по правилу $f\mapsto f'$, то есть взятие производной является линейным отображением.

\item Пусть $L[0,1]$ -- множество функций $f$ на отрезке $[0,1]$ таких, что существует интеграл $\int\limits_0^1 |f(x)|\,dx$%
\footnote{Для тех кто беспокоится о том, какой же тут берется интеграл, сообщим по честному, что на самом деле тут у нас функции интегрируемые по Лебегу на отрезке $[0,1]$.}
и пусть $C[0,1]$ -- множество непрерывных функций на отрезке $[0,1]$.
Тогда рассмотрим следующее отображение $f\mapsto \int\limits_0^t f(x)\,dx$.

\item Пусть $V$ -- некоторое векторное пространство с базисом $e_1,\ldots, e_n$.
Тогда отображение $F^n \to V$ по правилу $x \mapsto (e_1,\ldots,e_n)x$ является линейным.
\end{enumerate}

\paragraph{Замечание}

Давайте посмотрим на примеры (1), (4) и (5).
Они говорят, что в терминах линейных отображений можно говорить о системах линейных уравнений (1), о дифференциальных уравнениях (4) или об интегральных уравнениях (5).
Пример (6) нам встречался, когда мы объясняли, что любое векторное пространство превращается в пространство столбцов, если в нем выбрать базис.


\begin{definition}
Пусть $V$ и $U$ -- векторные пространства над некоторым полем $F$, тогда отображение $\varphi\colon V\to U$ называется изоморфизмом, если 
\begin{enumerate}
\item $\varphi$ линейно.

\item $\varphi$ биективно.
\end{enumerate}
\end{definition}

Заметим, что если отображение $\varphi\colon V\to U$ изоморфзим, то существует обратное отображение (потому что $\varphi$ биекция) и обратное так же является линейным.%
\footnote{Предлагаю дотошным читателям проверить это заявление, а остальным пустить скупую слезу и, поверив мне на слово, двигаться дальше в мир неизведанного.}
Если между двумя векторными пространствами $V$ и $U$ существует изоморфизм, то говорят, что они изоморфны и пишут $V \simeq U$.

Множество всех линейных отображений из пространства $V$ в пространство $U$ обозначается через $\Hom_F(V,U)$.
Формально
\[
\Hom_F(V,U) = \{f\colon V\to U \mid f \text{ -- линейное}\}
\]
Множество линейных отображений из $V$ в поле $F$ называется двойственным пространством к $V$ и обозначается через $V^*$.
Формально
\[
V^* = \{\xi \colon V\to F\mid \xi \text{ -- линейное}\} = \Hom_F(V,F)
\]
Если нет путаницы, то индекс, обозначающий поле $F$ опускают и пишут просто $\Hom(V,U)$.%
\footnote{Для интересующихся таким странным обозначением поясню, $\Hom$ происходит от слова homomorphism -- гомоморфизм, которое является более общим определением и в случае векторных пространств дает в точности понятие линейного отображения.}

\subsection{Операции на линейных отображениях}
\label{section::HomOperations}

Давайте порадуем себя еще немного абстрактным формализмом и введем операции на линейных отображениях.
Причем мы постараемся так, что множество всех линейных отображений между двумя векторными пространствами $\Hom_F(V,U)$ внезапно превратится в векторное пространство.
А это не так уж и плохо, это значит, что постоянно оставаясь в рамках векторных пространств, мы сможем к новым конструкциям применять все те же методы, что мы изначально разрабатывали для произвольных векторных пространств.

\paragraph{Сумма}

Пусть $\varphi\colon V\to U$ и $\psi \colon V\to U$ два линейных отображения между векторными пространствами $V$ и $U$.
Тогда, чтобы определить отображение $(\varphi+\psi)\colon V\to U$, надо задать его действие на всех векторах из $V$ и проверить, что полученное правило линейно.
Зададим его так: для любого $v\in V$ положим $(\varphi + \psi)(v) = \varphi(v) + \psi(v)$.

\paragraph{Умножение на скаляр}

Пусть $\varphi\colon V\to U$ -- линейное отображение между векторными пространствами $V$ и $U$ и пусть $\lambda \in F$ -- произвольный элемент поля.
Тогда определим $(\lambda \varphi)\colon V\to U$ как отображение задаваемое правилом $(\lambda\varphi)(v) = \lambda \varphi(v)$.

\paragraph{Композиция}

Пусть $\varphi\colon V\to U$ и $\psi \colon U \to W$ -- два линейных отображения, а $V$, $U$ и $W$ -- векторные пространства.
Тогда теоретико множественная композиция отображений $\psi\circ \varphi\colon V\to W$ это отображение задаваемое по правилу $(\psi\circ \varphi)(v) = \psi(\varphi(v))$.
Методом пристального взгляда на определение композиции и линейного отображения проверяется, что композиция тоже является линейным отображением.
Теоретико множественная композиция тогда обозначается просто $\psi\varphi$ и называется композицией линейных отображений.
Здесь полезно иметь перед глазами картинку:
\[
\xymatrix{
  {V}\ar[r]^{\varphi}\ar@/_10pt/[rr]_{\psi\varphi}&{U}\ar[r]^{\psi}&{W}
}
\]

\paragraph{Замечание}

Можно проверить методом пристального взгляда, что множество $\Hom_F(V,U)$ с операциями сложения и умножения на скаляр превращается в векторное пространство над полем $F$, а значит и двойственное пространство $V^*$ тоже является векторным пространством над $F$.%
\footnote{Глупо было бы ожидать другого результата.}

\subsection{Построение линейных отображений}

Мы хорошенько поиграли в абстракции, а теперь внимание главный вопрос дня: а как задавать линейные отображения между двумя векторыми пространствами $V$ и $U$?
И как следствие другой вопрос: а вообще существуют хоть какие-нибудь линейные отображения между $V$ и $U$?
К счастью на второй вопрос мы уже знаем ответ с помощью примера (2) выше.
Нулевое отображение у нас есть всегда, но это совсем не интересно.
На самом деле вопрос задания объектов нового вида -- это один из самых важных вопросов.
Когда мы проходили перестановки, нам нужен был способ с ними работать, работая с действительными числами, мы даже не задумываемся над способом их задания, так как эти способы нам знакомы с детства, задавать функции многих из нас тоже научили в школе.
Теперь пришло время научиться работать с линейными отображениями.

\begin{claim}
\label{claim::LinMapExist}
Пусть $V$ и $U$ -- векторные пространства и пусть $e_1,\ldots,e_n$ -- базис пространства $V$.
Тогда для любого набора $u_1,\ldots,u_n\in U$%
\footnote{Векторам $u_i$ разрешено повторяться.}
существует единственное линейное отображение $\varphi\colon V\to U$ такое, что $\varphi(e_i) = u_i$.
\end{claim}
\begin{proof}

Давайте проверим единственность в начале.
Пусть $\varphi,\psi\colon V\to U$ -- два таких отображения, тогда для любого вектора $v\in V$ имеем $v = x_1 e_1 + \ldots + x_n e_n$.
А значит
\[
\varphi(v) = \varphi(x_1 e_1 + \ldots + x_n e_n) = x_1 \varphi(e_1) + \ldots + x_n \varphi(e_n) = x_1 u_1 + \ldots + x_n u_n
\]
Аналогично $\psi(v)$ равно тому же самому.
Потому $\varphi = \psi$.%
\footnote{Чтобы проверить, что два отображения равны, как раз и надо проверить, что они совпадают на любом элементе, а мы ровно это и сделали.}

Теперь займемся вопросом существования.
Для этого надо всего лишь проверить, что правило $\varphi(v) =  x_1 u_1 + \ldots + x_n u_n$ задает линейное отображение.
Для этого надо проверить, что $\varphi(v_1 + v_2) = \varphi(v_1) + \varphi(v_2)$ и $\varphi(\lambda v) = \lambda \varphi(v)$.
Я молча выпишу ниже две необходимые для проверки строчки и понадеюсь на вашу сознательность и сообразительность в завершении доказательства.
Пусть $e = (e_1,\ldots,e_n)$ и $u = (u_1,\ldots, u_n)$, тогда для $v\in V$ найдется единственный $x\in F^n$, что $v = ex$.
А значит выражение $ux\in U$ зависит только от $v$, а не от выбора координат.
Потому можно положить $\varphi(v) = ux$.
Теперь линейность следует из равенств
\begin{gather*}
\varphi(v_1 + v_2) = \varphi(ex_1 + ex_2) = \varphi(e(x_1 + x_2)) = u(x_1 + x_2) = u x_1 + ux_2 = \varphi(v_1) + \varphi(v_2)\\
\varphi(\lambda v) = \varphi(\lambda ex) = \varphi(e(\lambda x)) = u (\lambda x) = \lambda u x = \lambda \varphi(v)
\end{gather*}
\end{proof}

Таким образом, если у вас зафиксирован базис в пространстве, то чтобы построить линейное отображение достаточно отправить базисные векторы куда угодно и у вас автоматом будет только одно линейное отображение, действующее на базисе таким образом.

\paragraph{Классификация векторных пространств с точностью до изоморфизма}

Теперь мы можем дать критерий, когда два векторных пространства изоморфны.

\begin{claim}
\label{claim::VectorClassific}
Пусть $V$ и $U$ -- векторные пространства над полем $F$.
Они изоморфны тогда и только тогда, когда $\dim_F V = \dim_F U$.
\end{claim}
\begin{proof}
Если векторные пространства $V$  и $U$ изоморфны, это значит, что существует изоморфизм $\varphi\colon V\stackrel{\sim}{\longrightarrow} U$.
Остается заметить, что при изоморфизме линейно независимое и порождающее множество переходит в линейно независимое и порождающее.
А значит, базис переходит в базис.
Следовательно пространства имеют одинаковую размерность.

Теперь пусть у пространств одинаковая размерность.
Тогда пусть $e_1,\ldots,e_n$ -- базис $V$ и $f_1,\ldots,f_n$ -- базис $U$.
Обратим внимание, что их количество одинаковое, так как это и есть их размерности, которые совпадают между собой по условию.
Тогда по предыдущему утверждению существует единственное отображение $\varphi\colon V\to U$ такое, что $e_i\mapsto f_i$.
Аналогично существует обратное отображение $\psi\colon U\to V$ переводящее $f_i\mapsto e_i$.
А следовательно композиции $\psi\varphi$ и $\varphi\psi$ оставляют на месте базисы пространств $V$ и $U$ соответственно.
Последнее означает, что  $\psi\varphi = \Identity_V$ и $\varphi\psi = \Identity_U$.
То есть это обратимые отображения, то есть биекции.
\end{proof}

\subsection{Линейные отображения и базис}

\paragraph{Матрица линейного отображения}

Пусть в векторном пространстве $V$ зафиксирован базис $e_1,\ldots,e_n$, а в пространстве $U$ базис $f_1,\ldots, f_m$.
Тогда любое линейное отображение $\varphi\colon V\to U$ задается набором $\varphi(e_1,\ldots,e_n) = (\varphi(e_1),\ldots, \varphi(e_n))$.%
\footnote{Это равенство можно понимать, как произведение матрицы $1$ на $1$ с элементом из $\Hom_F(V,U)$, с вектором размера $1$ на $n$ с элементами из пространства $V$.}
Любой вектор $\varphi(e_i)$ можно разложить по базису $f_1,\ldots,f_m$, то есть есть равенство $\varphi(e_i) = (f_1,\ldots,f_m)A_i$, где $A_i\in F^m$ -- столбец коэффициентов образа $e_i$ по $f_1,\ldots,f_m$.
Тогда все эти равенства вместе можно записать так:
\[
\varphi(e_1,\ldots,e_n) = (f_1,\ldots,f_m)A, \text{ где } A_\varphi = (A_1|\ldots|A_n)\in \operatorname{M}_{m\,n}(F)
\]
Как только фиксированы базисы $e_i$ и $f_i$, матрица $A_\varphi$ определена однозначно.
Эта матрица и называется матрицей линейного отображения $\varphi$ в базисах $e_i$ и $f_i$.%
\footnote{Как обычно я злоупотребляю своей любовью к опусканию чрезмерных деталей в обозначениях.
Надо помнить, что вообще говоря матрица $A_\varphi$ не имеет значения, если не сказано в каких именно базисах она посчитана.
Потому хорошо бы еще писать, что это $A_{\varphi\,e_i\,f_i}$, но на практике не удобно использовать такое громоздкое обозначение, да и не особенно много проку от него.}
Еще раз повторим в кратких обозначениях, если $e=(e_1,\ldots,e_n)$ и $f = (f_1,\ldots,f_m)$ то, чтобы показать, что какая-то матрица $A$ является матрицей линейного отображения $\varphi\colon V\to U$ в базисах $e$ и $f$, то надо показать равенство $\varphi e = f A$.

\paragraph{Действие в координатах}

Пусть теперь $v\in V$.
Тогда вектор $v$ можно разложить по базису $e$ в виде $v = ex$, для некоторого $x\in F^n$.
Применим $\varphi$ к $v$, получим
\[
\varphi(v) = \varphi(ex) = (\varphi e)x = f A_\varphi x
\]
То есть $\varphi(v)$ имеет координаты $A_\varphi x$.
То есть, если отождествить пространство $V$ с $F^n$ посредством $v = ex \mapsto x$ и пространство $U$ с $F^m$ посредством $u = fy \mapsto y$, то наше линейное отображение $\varphi$ превращается в отображение $F^n \to F^m$ по правилу $x \mapsto A_\varphi y$.
Таким образом изучать линейное отображение между двумя конечномерными векторными пространствами -- это все равно, что изучать отображение между пространствами столбцов, заданное умножением слева на матрицу.


\paragraph{Смена базиса}

Пусть теперь в пространстве $V$ задано два базиса $e = (e_1,\ldots, e_n)$ и $e' = (e_1',\ldots,e_n')$.
Аналогично, в пространстве $U$ -- два базиса $f = (f_1,\ldots,f_m)$ и $f' = (f_1',\ldots,f_m')$.
Кроме того выполнены равенства $e' = eC$ для некоторой $C\in \operatorname{M}_n(F)$  и $f' = f D$ для некоторой $D\in \operatorname{M}_m(F)$, то есть $D$ и $C$ -- матрицы перехода от нештрихованных базисов к штрихованным.
Тогда в базисах $e$ и $f$ линейное отображение $\varphi\colon V\to U$ выглядит $\varphi e = f A_\varphi$, а в базисах $e'$ и $f'$ -- $\varphi e' = f' A_\varphi'$.
Давайте поймем какая связь между матрицами $A_\varphi$ и $A_\varphi'$ в терминах матриц перехода $C$ и $D$.
\[
\varphi e' = f' A_\varphi' \,\Rightarrow\, \varphi e C = f D A_\varphi' \,\Rightarrow \, \varphi e = f D A_\varphi' C^{-1}
\]
В силу единственности матрицы линейного отображения
\[
A_\varphi = D A_\varphi' C^{-1} \,\Rightarrow\, A_\varphi' = D^{-1} A_\varphi C
\]
Последнее равенство показывает как меняется матрица линейного отображения, когда мы меняем базисы пространств.
Запоминать можно так: когда мы хотим заменить старую матрицу $A_\varphi$ на новую $A_\varphi'$ надо справа домножить на матрицу перехода от $e$ к $e'$, а слева на обратную к матрице перехода от $f$ к $f'$.
Еще полезно перед глазами держать следующую картинку:
\[
\xymatrix{
  {\text{старые}}&{F^n}\ar[r]^{\varphi}&{F^m}\ar[d]&{x = Cx'}\ar@{|->}[r]&{y = A_\varphi Cx'}\ar@{|->}[d]\\
  {\text{новые}}&{F^n}\ar[u]\ar[r]^{\varphi}&{F^m}&{x'}\ar@{|->}[u]\ar@{|->}[r]&{y' = D^{-1}A_\varphi Cx'}
}
\]

\paragraph{Связь матрицы отображения с операциями}

\begin{claim}
Пусть $V$ и $U$ -- некоторые векторные пространства над полем $F$ размерностей $n$ и $m$ соответственно и пусть $e=(e_1,\ldots,e_n)$ и $f = (f_1,\ldots,f_m)$ -- базисы пространств $V$ и $U$.
Тогда отображение
\begin{align*}
\Hom_F (V,U) &\to \operatorname{M}_{m\,n}(F)\\
\varphi &\mapsto A_\varphi
\end{align*}
является изоморфизмом векторных пространств, то есть выполнено
\begin{enumerate}
\item $A_{\varphi + \psi} = A_\varphi + A_\psi$.

\item $A_{\lambda \varphi} = \lambda A_\varphi$.
\end{enumerate}
\end{claim}
\begin{proof}
Биективность этого отображения мы уже знаем в других терминах: при зафиксированных базисах $e$ и $f$ в обоих пространствах для любого линейного отображения $\varphi$ существует единственная матрица $A_\varphi$ такая, что $\varphi e = f A_\varphi$.

Теперь надо проверить линейность этого отображения.
По определению
$(\varphi + \psi)e = f A_{\varphi + \psi}$.
С другой стороны
\[
(\varphi+\psi)e = \varphi e + \psi e = f A_\varphi + f A_\psi = f(A_\varphi + A_\psi)
\]
Из единственности следует, что $A_{\varphi + \psi} = A_\varphi + A_\psi$.
Аналогично, $(\lambda \varphi) e = f A_{\lambda \varphi}$ с одной стороны и
\[
(\lambda \varphi) e = \lambda (\varphi e) = \lambda f A_\varphi = f (\lambda A_\varphi)
\]
с другой.
Потому из единственности получаем $A_{\lambda \varphi} = \lambda A_\varphi$.
\end{proof}

Таким образом изучать линейные отображения между двумя векторными пространствами -- это все равно что изучать матрицы, причем с учетом операций на матрицах, а не просто как множество.

\begin{claim}
Пусть $V$, $U$ и $W$ -- векторные пространства размерностей $m$, $n$ и $k$ соответственно с базисами $e$, $f$ и $h$ соответственно.
Пусть $\varphi\colon V\to U$ и $\psi \colon U\to W$, тогда $A_{\psi \varphi} = A_\psi A_\varphi$.
\end{claim}
\begin{proof}
Доказательство -- прямая проверка в лоб по определению.
С одной стороны $(\psi \varphi) e = h A_{\psi \varphi}$.
С другой
\[
(\psi\varphi) e = \psi (\varphi e) = \psi (f A_\varphi) = (\psi f) A_\varphi = h A_\psi A_\varphi
\]
И результат следует из единственности.
\end{proof}

Все эти результаты вместе взятые означают, что выбрав базис, мы можем отождествить все конечномерные пространства с какими-то конкретными пространствами вида $F^n$, а линейные отображения между ними на матрицы соответствующих размеров.
Тогда изучать конечно мерные векторные пространства -- это то же самое, что изучать конкретные векторные пространства столбцов с матричными отображениями между ними.
Потому, если что-то глобально доказано для вектор столбцов, оно автоматом есть и для конечно мерных векторных пространств.
Более того, если какой-то факт о векторах бесконечномерного векторного пространства требует лишь конечного набора векторов из него, то они живут в конечномерном подпространстве, а значит подобные факты для бесконечно мерных пространств автоматически следуют из случая конечномерных, а значит и из случая вектор столбцов.

\subsection{Ядро и образ}

\begin{definition}
Пусть $V$ и $U$ -- векторные пространства над некоторым полем $F$ и $\varphi\colon V\to U$ -- линейное отображение.
Тогда ядром $\varphi$ называется следующее множество
\[
\ker \varphi = \{v\in V \mid \varphi(v) = 0\} = \varphi^{-1}(0)
\]
-- прообраз нуля, а образом $\varphi$ называется
\[
\Im \varphi = \{\varphi(v)\mid v\in V\} = \varphi(V)
\]
-- теоретико множественный образ отображения $\varphi$.
\end{definition}

Отметим, что ядро и образ никогда не пусты, они всегда содержат $0$.
Кроме того, простая проверка показывает, что оба этих множества являются подпространствами, а именно: $\ker\varphi$ -- подпространство в $V$, а $\Im \varphi $ -- подпространство в $U$.

\paragraph{Пример}

Пусть $\varphi \colon F^n\to F^m$ -- линейное отображение задаваемое матрицей $A\in\operatorname{M}_{m\,n}(F)$, и пусть $A = (A_1|\ldots|A_n)$, где $A_i\in F^m$ -- столбцы матрицы $A$.
Тогда
\begin{itemize}
\item $\Im \varphi = \langle A_1,\ldots,A_n\rangle$.

\item $\ker \varphi = \{y\in F^n\mid Ay = 0\}$.
\end{itemize}
Второе получается просто по определению.
Для того чтобы увидеть первое, поймем, что образ $\varphi$ состоит из векторов вида $Ax = x_1 A_1 + \ldots + x_n A_n$.


\begin{claim}
\label{claim::ImKer}
Пусть $V$ и $U$ -- векторные пространства над полем $F$ и $\varphi \colon V\to U$ -- линейное отображение.
Тогда
\begin{enumerate}
\item $\varphi$ сюръективно тогда и только тогда, когда $\Im \varphi = U$.

\item $\varphi$ инъективно тогда и только тогда, когда $\ker \varphi = 0$.

\item $\dim_F \ker \varphi + \dim_F \Im \varphi = \dim_F V$.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Это просто переформулировка сюръективности на другом языке.

(2) Так как $\ker \varphi = \varphi^{-1}(0)$ и прообраз всегда содержит $0$, то из инъективности вытекает, что $\ker \varphi = 0$.
Наоборот, пусть $\varphi (v) = \varphi(v')$, тогда $\varphi(v) - \varphi (v') = 0$.
А значит,  $\varphi(v - v') = 0$.
То есть $v - v'$ лежит в ядре, а значит равен $0$, что и требовалось.

(3) Это самое интересное.
Выберем базис ядра $\ker \varphi$, пусть это будет $e_1,\ldots, e_k$.
Тогда дополним его до базиса всего пространства $V$ с помощью векторов $e_{k+1}, \ldots, e_n$.
Тогда образ $\varphi$ является линейной оболочкой векторов $\varphi(e_1),\ldots, \varphi(e_n)$.
Так как первые $k$ из них лежат в ядре и идут в ноль, то $\Im \varphi = \langle \varphi(e_{k+1}), \ldots, \varphi(e_n)\rangle$.
Потому если мы покажем, что $\varphi(e_{k+1}), \ldots,\varphi(e_n)$ является базисом $\Im\varphi$, то мы получим требуемое.

Для доказательства последнего достаточно показать линейную независимость $\varphi(e_{k+1}),\ldots,\varphi(e_n)$.
Рассмотрим их какую-нибудь линейную комбинацию равную нулю
\[
\lambda_{k+1}\varphi(e_{k+1})+\ldots+\lambda_n\varphi(e_n) = \varphi(\lambda_{k+1}e_{k+1}+\ldots+\lambda_n e_n) = 0
\]
Значит $\lambda_{k+1}e_{k+1}+\ldots+\lambda_n e_n\in \ker \varphi$.
А все что лежит в ядре раскладывается по базису ядра $e_1,\ldots, e_k$, значит найдется выражение вида
\[
\lambda_{k+1}e_{k+1}+\ldots+\lambda_n e_n = \lambda_1 e_1 + \ldots + \lambda_k e_k
\] 
Перенеся все в одну сторону, мы получим линейную комбинацию на $e_1,\ldots,e_n$, который по построению базис, значит, все $\lambda_i$ равны нулю.
Откуда следует требуемое.
\end{proof}

