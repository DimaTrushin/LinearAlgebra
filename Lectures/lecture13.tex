\ProvidesFile{lecture13.tex}[Лекция 13]


\paragraph{Смена базиса}

Так как базис в пространстве выбирается не единственным образом, то в конструкции выше у нас есть некоторая свобода.
Давайте проследим, что и как меняется при замене одного базиса другим.

\begin{claim}
\label{claim::BasisClassification}
Пусть $V$ -- некоторое векторное пространство над полем $F$ и пусть $e_1,\ldots, e_n\in V$ -- какой-нибудь базис этого пространства.
Тогда
\begin{enumerate}
\item Для любой обратимой матрицы $C\in \operatorname{M}_{n}(F)$ набор векторов $(e_1,\ldots,e_n)C$ тоже является базисом.

\item Если $f_1,\ldots,f_n\in V$ -- любой другой базис $V$, то найдется единственная обратимая матрица $C\in\operatorname{M}_n(F)$ такая, что $(f_1,\ldots,f_n) = (e_1,\ldots,e_n)C$.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Заметим, что набор $(e_1,\ldots,e_n)C$ является линейно независимым и состоит из $n = \dim V$ элементов, а значит автоматом максимальный линейно независимый набор.
Для проверки линейной независимости рассмотрим линейную комбинацию $(e_1,\ldots,e_n)Cx = 0$, где $x\in F^n$.
Тогда $Cx = 0$, так как $e_i$ -- базис.
А следовательно $x = 0$, так как $C$ обратима.

(2) Так как $e_i$ -- базис, то любой вектор однозначно раскладывается по этому базису, например, каждый $f_i$ имеет представление $f_i = (e_1,\ldots, e_n) C_i$, где $C_i\in F^n$.
Тогда все эти равенства вместе можно записать так $(f_1,\ldots,f_n) = (e_1,\ldots,e_n) C$, где $C = (C_1|\ldots|C_n)\in \operatorname{M}_n (F)$ -- квадратная матрица, составленная из столбцов $C_i$.
То есть такая матрица найдется, а ее единственность следует из того, что любой вектор однозначно раскладывается по базису.

Теперь осталось доказать обратимость матрицы $C$.
Применив то же самое рассуждение для базисов в обратном порядке, мы найдем матрицу $B\in \operatorname{M}_n(F)$ такую, что $(e_1,\ldots,e_n) = (f_1,\ldots,f_n) B$.
Тогда получаем 
\[
(e_1,\ldots,e_n) = (f_1,\ldots,f_n)B = (e_1,\ldots,e_n)CB
\]
А значит $(e_1,\ldots, e_n)(E - CB) = 0$.
Из линейной независимости базиса следует, что $E = CB$.
Аналогично доказывается $BC = E$,%
\footnote{Либо можно воспользоваться утверждением~\ref{claim::InvertibleDiscription}.}
то есть $B$ является обратной к $C$, что и требовалось.
\end{proof}


Если $e_1,\ldots,e_n$ и $f_1,\ldots,f_n$ -- два базиса пространства $V$, то матрица $C\in \operatorname{M}_n(F)$ такая, что $(f_1,\ldots, f_n) = (e_1,\ldots,e_n)C$ называется матрицей перехода от базиса $e_i$ к базису $f_i$.
Таким образом у нас есть, вообще говоря бесконечный, граф с вершинами пронумерованными базисами пространства $V$, а ребра соответствуют матрицам перехода $C$ от базиса $e_i$ к базису $f_i$, если $(f_1,\ldots,f_n) = (e_1,\ldots,e_n)C$.
Предыдущее утверждение говорит, что этот граф связный и между любыми двумя вершинами есть ровно одно ребро.%
\footnote{Кстати между вершиной и ей самой тоже есть ребро-петля, соответствующая единичной матрице.}

\paragraph{Смена координат}

Пусть теперь у нас $v\in V$ -- некоторый вектор.
Тогда мы его можем разложить по одному базису $v = ex$ с координатами $x\in F^n$ и по другому базису $v = f y$ с координатами $y \in F^n$.
Пусть $C$ -- матрица перехода от базиса $e$ к базису $f$, то есть $f = e C$.
Тогда координаты $x$ в старом базисе $e$ связаны с новыми координатами в базисе $f$ следующим образом: $x = Cy$.
Действительно, с одной стороны $v = ex$, а с другой $v = f y = eC y$.
Но так как разложение по базису однозначно, получаем, что $x = Cy$.
Запоминать это правило надо так: если от базиса $e$ к базису $f$ мы перешли с помощью умножения справа на матрицу $C$, то на координатах у нас отображение в обратную сторону с помощью умножения на матрицу $C$ слева (то есть тоже с другой стороны).
Еще полезно держать перед глазами вот эту таблицу.
\begin{center}
\begin{tabular}{c|c}
{базис}&{новый $\stackrel{\cdot C}{\longleftarrow}$ старый}\\
\hline
{координаты}&{новые $\stackrel{C\cdot}{\longrightarrow}$ старые}\\
\end{tabular}
\end{center}

\subsection{Ранг}

В начале обсудим общее понятие ранга системы векторов в произвольном векторном пространстве.

\begin{claim}
Пусть $V$ -- некоторое векторное пространство над полем $F$.
Пусть $S = (v_1,\ldots,v_k) $ -- система векторов из $V$.%
\footnote{Формально $S\in V^k$, то есть это упорядоченный набор векторов, где векторы могут повторяться.}
Пусть $S'\subseteq S$ -- максимальный линейно независимый поднабор в $S$.%
\footnote{Это означает, что элементы $S'$ не повторяются, полученное множество является линейно независимым и к набору $S'$ нельзя добавить ни один вектор из $S$, чтобы получился линейно независимый набор.}%
${}^{,\,}$%
\footnote{Формально мы разбирались лишь со случаем множества векторов, но я не хочу разводить формальный геморрой на ровном месте и уверен, что каждый из вас сможет без труда распространить все необходимые определения и факты на наборы вместо множеств.}
Тогда $|S'| = \dim_F \langle S\rangle$.
\end{claim}
\begin{proof}
Рассмотрим $\langle S \rangle\subseteq V$.
Если мы покажем, что $\langle S' \rangle = \langle S \rangle$, то по определению $S'$ будет базисом $\langle S\rangle$, как порождающее и линейно независимое.
Для этого нам достаточно показать, что любой вектор из $S\setminus S'$ выражается через векторы из $S'$.
Действительно, возьмем такой вектор $v\in S\setminus S'$, тогда набор составленный из $S'$ и $v$ уже будет линейно зависимым, то есть есть линейная комбинация вида $\sum_i\alpha_i v_i' + \alpha v = 0$, где  $v_i'\in S'$ и $\alpha_i,\alpha\in F$.
Коэффициент $\alpha\neq 0$ иначе это означало бы линейную зависимость $S'$.
А значит можно выразить $v$ через $v_i'$ перенеся $\alpha v $ направо и разделив на $-\alpha$.
\end{proof}

В частности это утверждение делает корректным следующее.

\begin{definition}
Пусть $V$ -- векторное пространство и $S = (v_1,\ldots,v_k)$ -- набор векторов из $V$.
Тогда рангом $S$ называется размер максимального линейно независимого поднабора и обозначается $\rk S$.
\end{definition}

Кроме корректности, утверждение выше говорит, что $\rk (v_1,\ldots,v_k) = \dim_F \langle v_1, \ldots,v_k\rangle$.
К рангу надо относиться так -- это дискретный аналог размерности.
Векторное пространство -- объект большой и сложный, базисов в нем много, потому его недостаток -- с ним сложно работать.
Конечный набор векторов -- объект простой и понятный, с ним намного проще работать, чем целиком со всем пространством.
Однако, главный недостаток -- он недостаточно гибкий по сравнению с векторным пространством, если мы чуть-чуть поменяем вектора (например, прибавим один к другому) мы уже изменим набор, но не изменим векторного пространства.
Как обычно, каким-то из этих понятий удобно пользоваться в одних ситуациях, а в каких-то ситуациях намного лучше подходит другое.


\subsection{Матричный ранг}

Пусть $A\in \operatorname{M}_{m\,n}(F)$ -- некоторая матрица с коэффициентами в поле $F$.
Я хочу определить понятие ранга матрицы $A$.
В начале я дам пять разных определений для ранга и чтобы отличать их во время доказательств буду временно называть их по-разному.
Сразу после мы докажем, что на самом деле все эти определения эквивалентны, а значит они определяют одну и ту же характеристику матрицы, которую мы и будем называть просто рангом.%
\footnote{Я предпочитаю не фиксировать какое-то из определений как основное.
Вместо этого я предпочитаю в зависимости от задачи использовать любое из них в качестве ранга, но для такой гибкости нам придется сразу доказать их совпадение.}

\begin{definition}
Пусть $A_1,\ldots,A_n\in F^m$ -- столбцы матрицы $A$, то есть $A = (A_1|\ldots|A_n)$.
Тогда столбцовым рангом матрицы $A$ называется ранг системы $(A_1,\ldots,A_n)$, то есть $\rk_{\text{столб}} A = \rk (A_1,\ldots,A_n)$.
\end{definition}

\begin{definition}
Пусть $A_1,\ldots,A_m\in F^n$ -- строки матрицы $A$, то есть $A^t = (A_1|\ldots|A_m)$.
Тогда строковым рангом матрицы $A$ называется ранг системы $(A_1,\ldots,A_m)$, то есть $\rk_{\text{стр}} A = \rk (A_1,\ldots,A_m)$.
\end{definition}


\begin{definition}
Факториальным рангом матрицы $A$ называется следующее число%
\footnote{У этого определения есть один дефект.
Оно <<плохо работает>> в случае, когда ранг равен $0$.
Действительно, очень сложно понять, что такое матрицы с $0$ столбцов или строк.
И еще удивительнее, что должно быть их произведением.
Можно копаться в основаниях теории множеств, а можно просто сказать: давайте в случае $A = 0$ просто аксиоматически положим, что факториальный ранг равен $0$.
Это выглядит как костыль, но на самом деле если бы вы погрузились в мучительный формализм строгой теории множеств, то получили бы в точности этот ответ.}
\[
\min \{k \mid A = BC,\text{ где }B\in \operatorname{M}_{m\,k}(F),\,C\in\operatorname{M}_{k\,n}(F)\}
\]
то есть это минимальное число $k$ такое, что матрица $A$ представима в виде произведения матриц $BC$, где общая размерность для $B$ и $C$, по которой они перемножаются, есть $k$.
\end{definition}

\begin{definition}
Тензорным рангом матрицы $A$ называется следующее число%
\footnote{В этом определении как и в предыдущем очень сложно понять, что значит сумма пустого числа слагаемых (опять случай $k = 0$).
Опять же, это случается только в случае $A = 0$ и потому, в этом случае мы по определению скажем, что тензорный ранг равен $0$.
И точно так же как и выше (в случае факториального ранга) оказывается, что этот ответ можно вытащить из строгой теории множеств, но я не хочу играть в компилятор формализма.}
\[
\min\{k \mid A = x_1y_1^t+\ldots + x_k y_k^t,\text{ где }x_i\in F^m,\, y_i\in F^n\}
\]
то есть это минимальное число $k$ такое, что матрица $A$ представима в виде суммы $k$ <<тощих>> матриц вида $xy^t$, где $x\in F^m$ и $y\in F^n$.
\end{definition}


Перед следующим определением нам нужна некоторая подготовка.
Зафиксируем некоторый набор индексов для строк: $1\leqslant i_1<\ldots<i_k\leqslant m$, а так же некоторый набор индексов для столбцов в том же количестве $1\leqslant j_1<\ldots<j_k\leqslant n$.
Тогда обозначим через $A_{i_1,\ldots,i_k}^{j_1,\ldots,j_k}\in \operatorname{M}_k(F)$ подматрицу образованную пересечением данных строк и столбцов.
То есть формально ее элементы это $\bar a_{st} = a_{i_s j_t}$.
Такую матрицу будем называть квадратной подматрицей матрицы $A$ размера $k$.

\begin{definition}
Минорным рангом матрицы $A$ называется размер максимальной невырожденной квадратной подматрицы, то есть минорный ранг $A$ -- это такое $k$, что существует невырожденная подматрица $A_{i_1,\ldots,i_k}^{j_1,\ldots,j_k}\in \operatorname{M}_k(F)$ такая, что любая квадратная подматрица ее содержащая уже вырождена.%
\footnote{Обратите внимание, что нужно еще доказывать корректность этого определения, а именно, что число $k$ не зависит от выбора максимальной невырожденной подматрицы.
Это вообще говоря не очевидно.}
\end{definition}

В начале сделаем очень полезное замечание.

\begin{claim}
\label{claim::rkFactorTensor}
Для любой матрицы $A\in \operatorname{M}_{m\,n}(F)$ ее факториальный ранг равен тензорному.
\end{claim}
\begin{proof}
Пусть $B\in \operatorname{M}_{m\,k}(F)$ и  $\,C\in\operatorname{M}_{k\,n}(F)$ -- такие матрицы, что $A = BC$.
Пусть $B = (B_1|\ldots|B_k)$ и $C^t = (C_1|\ldots|C_k)$.
Тогда по блочным формулам $BC = B_1 C_1^t + \ldots + B_kC_k^t$.
Это доказывает, что тензорный ранг $A$ не превосходит факториального.
Наоборот, если задано разложение $BC = B_1 C_1^t + \ldots + B_kC_k^t$, то определим матрицы $B = (B_1|\ldots|B_k)$ и $C^t = (C_1|\ldots|C_k)$ и получим, что $A = BC$.
Это доказывает оценку рангов в другую сторону.
\end{proof}


Наша цель в этом разделе очень проста -- показать, что все пять определений  ранга совпадают между собой.
Начнем со следующего.

\begin{claim}
\label{claim::rkInvariance}
Пусть $A\in\operatorname{M}_{m\,n}(F)$ -- произвольная матрица, тогда столбцовый, строковый, факториальный и тензорный ранги не меняются при домножении $A$ слева или справа на невырожденную матрицу.
\end{claim}
\begin{proof}
(1) Столбцовый ранг.
Пусть $A = (A_1|\ldots|A_n)$, где $A_i\in F^m$ и пусть $D\in \operatorname{M}_n(F)$ -- обратимая матрица.
Тогда $\langle (A_1,\ldots,A_n)\rangle = \langle (A_1, \ldots, A_n) D\rangle$ (включение $\supseteq$ очевидно, а обратное следует из обратимости $D$), а значит
\[
\rk_{\text{столб}}(A) = \dim\langle (A_1,\ldots,A_n)\rangle = \dim\langle (A_1, \ldots, A_n) D\rangle = \rk_{\text{столб}}(AD)
\]

Пусть теперь $C\in \operatorname{M}_m(F)$ -- обратимая матрица.
Тогда система $Ax = 0$ эквивалентна системе $CAx = 0$.
Если какая-то линейная комбинация $x_1 A_1 + \ldots + x_n A_n = 0$, то это значит, что $Ax = 0$, т.е. $x$ является решением системы $Ax = 0$, а значит и решением системы $CAx = 0$, то есть столбцы матрицы $CA$ удовлетворяют той же самой линейной комбинации, что и столбцы матрицы $A$.
Это значит, что если какое-то множество столбцов в $A$ было линейно независимо, то множество столбцов с теми же самыми номерами в $CA$ тоже линейно независимо.
И если какой-то столбец из $A$ выражался через другие, то и в $CA$ столбец с тем же номером будет выражаться с помощью той же самой линейной комбинации через другие.
Потому максимальная линейно независимая система в $A$ переходит в максимальную линейно независимую систему в $CA$.%
\footnote{Еще один способ думать про это доказательство такое.
Можно считать, что столбцы матрицы $A$ -- это векторы в $F^m$, а умножение на $C$ слева -- это замена координат в пространстве $F^n$, то есть мы ничего не делаем с нашими векторами, но меняем стандартный базис в $F^n$ на какой-то другой.
Потому столбцы $CA$ -- это координаты тех же самых векторов, что и исходные, только записанные в другом базисе.
А раз это те же самые векторы, то у нас ничего не поменялось, кроме их << внешнего вида>>.}
Последнее по определению означает $\rk_{\text{столб}} A = \rk_{\text{столб}}(CA)$.

(2) Строковый ранг.
Так как $\rk_{\text{столб}}A = \rk_{\text{стр}}(A^t)$, то этот случай следует из предыдущего.

(3) Факториальный ранг.
Пусть  $\rk_{\text{ф}}A = k$ и пусть $A = BC$ -- разложение на котором достигается ранг $A$.
Тогда $AD = B(CD)$ -- некоторое разложение для $AD$ с числом $k$, а значит по определению $\rk_{\text{ф}}(AD) \leqslant \rk_{\text{ф}} A$.
Обратное неравенство следует из обратимости $D$, т.е.$AD = (AD)D^{-1}$.
Домножение на матрицу слева делается аналогично.

(4) В силу замечания выше (утверждение~\ref{claim::rkFactorTensor}) тензорный ранг и факториальный -- это одно и то же, потому этот пункт следует из предыдущего.
\end{proof}

\begin{claim}
Пусть $A\in \operatorname{M}_{m\,n}(F)$, тогда столбцовый, строковый, факториальный и тензорный ранги для нее совпадают.
\end{claim}
\begin{proof}
Домножив матрицу $A$ слева и справа на обратимую, мы можем считать, что она имеет следующий вид $\left(\begin{smallmatrix}{E}&{0}\\{0}&{0}\end{smallmatrix}\right)$.
Из утверждения~\ref{claim::rkInvariance} следует, что достаточно доказать утверждение для последней матрицы.

Давайте посчитаем $\rk_{\text{столб}}\left(\begin{smallmatrix}{E}&{0}\\{0}&{0}\end{smallmatrix}\right)  = r$, где $r$ -- размер единичной матрицы $E$.
Аналогично $\rk_{\text{стр}}\left(\begin{smallmatrix}{E}&{0}\\{0}&{0}\end{smallmatrix}\right) = r$.
Более того, для минорного ранга $\rk_{\text{м}}\left(\begin{smallmatrix}{E}&{0}\\{0}&{0}\end{smallmatrix}\right) = r$, так как матрица $E$ является невырожденной матрицей размера $r$, а все большие подматрицы вырождены, потому что имеют нулевую строку или столбец.
То есть эти три ранга равны между собой.


Теперь осталось доказать, что факториальный ранг совпадает со столбцовым (строковым) рангом.
Если $A = BC = (B_1|\ldots|B_k)C$ -- равенство, на котором достигается факториальный ранг.
Тогда столбцы матрицы $A$ выражаются через столбцы матрицы $B$, то есть $\langle A_1,\ldots,A_m\rangle \subseteq \langle B_1,\ldots,B_k\rangle$, а значит 
\[
\rk_{\text{столб}}A = \dim \langle A_1,\ldots,A_m\rangle \leqslant \dim \langle B_1,\ldots,B_k\rangle\leqslant k=\rk_{\text{ф}}A
\]

С другой стороны
\[
\begin{pmatrix}
{E}&{0}\\
{0}&{0}
\end{pmatrix}
=
\begin{pmatrix}
{E}\\
{0}
\end{pmatrix}
\begin{pmatrix}
{E}&{0}\\
\end{pmatrix}
\]
где общая размерность матриц справа равна строковому рангу, а значит факториальный ранг не превосходит этой размерности.
Что дает обратное неравенство.
\end{proof}


\begin{claim}
Пусть $A\in \operatorname{M}_{m\,n}(F)$ -- произвольная матрица, тогда ее минорный ранг корректно определен и совпадает со всеми остальными рангами.
\end{claim}
\begin{proof}

Давайте напомним, что минорным рангом мы назвали размер максимальной невырожденной квадратной подматрицы в матрице $A$, то есть мы ищем подматрицу $A_{i_1,\ldots,i_k}^{j_1,\ldots,j_k}$ натянутую на строки $i_1,\ldots,i_k$ и столбцы $j_1,\ldots,j_k$ такую, что она сама является невырожденной, а все квадратные подматрицы ее содержащие (если такие имеются) уже вырождены.
Во-первых, не понятно, почему это число не зависит от выбора квадратной подматрицы, а во-вторых, почему оно совпадает со всеми остальными рангами.
Мы поступим следующим образом.
Выберем произвольную такую максимальную невырожденную квадратную подматрицу и докажем, что ее размер совпадает со столбцовым рангом.
Тогда отсюда будет следовать, что ее размер не зависит от выбора подматрицы и что минорный ранг совпадает со всеми остальными.

Заметим, что если я переставлю строки и столбцы в матрице $A$, то ее квадратные подматрицы как-то переставятся местами.
При этом если какая-то подматрица была максимальная невырожденная, то она останется максимальной невырожденной.
Следовательно можно считать, что максимальная невырожденная квадратная подматрица натянута на первые $k$ строк и столбцов и матрица $A$ выглядит так
\[
A
=
\begin{pmatrix}
{B}&{C}\\
{D}&{F}
\end{pmatrix}
\quad\text{где}
\;B\in \operatorname{M}_{k}(F)\;\text{невырождена}
\]
Наша задача показать, что $k = \rk_\text{столб}A$.
Теперь будем делать элементарные преобразования строк и столбцов первого типа, когда разрешается прибавлять строку с номером от $1$ до $k$ к любой другой строке (аналогично со столбцами).
Заметим, что при этом не меняется определитель подматрицы $B$ и любой другой подматрицы содержащей матрицу $B$.
Поэтому, при таких преобразованиях матрица $B$ будет продолжать оставаться максимальной невырожденной матрицей.

С помощью указанных выше преобразований мы можем привести матрицу $B$ к диагональному виду с ненулевыми числами на диагонали
\[
A \mapsto
\begin{pmatrix}
{b_1}&{\ldots}&{0}&{*}&{\ldots}&{*}\\
{\vdots}&{\ddots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{b_k}&{*}&{\ldots}&{*}\\
{*}&{\ldots}&{*}&{*}&{\ldots}&{*}\\
{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{*}&{\ldots}&{*}&{*}&{\ldots}&{*}\\
\end{pmatrix}
\]
Теперь с помощью указанных элементарных преобразований строк можно занулить весь блок под левой верхней диагональной подматрицей, а с помощью указанных элементарных преобразований столбцов -- весь блок справа от нее.
\[
\begin{pmatrix}
{b_1}&{\ldots}&{0}&{*}&{\ldots}&{*}\\
{\vdots}&{\ddots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{b_k}&{*}&{\ldots}&{*}\\
{*}&{\ldots}&{*}&{*}&{\ldots}&{*}\\
{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{*}&{\ldots}&{*}&{*}&{\ldots}&{*}\\
\end{pmatrix}
\mapsto
\begin{pmatrix}
{b_1}&{\ldots}&{0}&{*}&{\ldots}&{*}\\
{\vdots}&{\ddots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{b_k}&{*}&{\ldots}&{*}\\
{0}&{\ldots}&{0}&{*}&{\ldots}&{*}\\
{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{0}&{*}&{\ldots}&{*}\\
\end{pmatrix}
\mapsto
\begin{pmatrix}
{b_1}&{\ldots}&{0}&{0}&{\ldots}&{0}\\
{\vdots}&{\ddots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{b_k}&{0}&{\ldots}&{0}\\
{0}&{\ldots}&{0}&{*}&{\ldots}&{*}\\
{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{0}&{*}&{\ldots}&{*}\\
\end{pmatrix}
\]
При этом подматрица $B$ в верхнем левом углу остается максимальной невырожденной подматрицей.
В частности, если мы возьмем и добавим к ней $i$-ю строку и $j$-й столбец, то получится вырожденная матрица.
С другой стороны эта матрица будет иметь вид
\[
\begin{pmatrix}
{b_1}&{\ldots}&{0}&{0}\\
{\vdots}&{\ddots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{b_k}&{0}\\
{0}&{\ldots}&{0}&{d_{ij}}\\
\end{pmatrix}
\]
Здесь через $d_{ij}$ обозначен элемент на $i$-ой строке и $j$-ом столбце последней матрицы.
Так как все $b_i$ не равны нулю, то такая матрица может быть вырождена только если $d_{ij}=0$.
Применяя это рассуждение к произвольному столбцу и строке с номерами больше $k$, мы видим, что последняя матрица на самом деле имеет вид
\[
A'=
\begin{pmatrix}
{b_1}&{\ldots}&{0}&{0}&{\ldots}&{0}\\
{\vdots}&{\ddots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{b_k}&{0}&{\ldots}&{0}\\
{0}&{\ldots}&{0}&{0}&{\ldots}&{0}\\
{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}&{\vdots}\\
{0}&{\ldots}&{0}&{0}&{\ldots}&{0}\\
\end{pmatrix}
\]
Теперь мы видим, что $k = \rk_\text{столб}A'$.
Но так как мы перешли от матрицы $A$ к матрице $A'$ с помощью элементарных преобразований, то $\rk_\text{столб}A =\rk_\text{столб}A'$ по утверждению~\ref{claim::rkInvariance}.
\end{proof}


\begin{definition}
Пусть $A\in \operatorname{M}_{m\,n}(F)$ -- произвольная матрица.
Тогда рангом $A$ называется один из пяти рангов определенных выше и обозначается $\rk A$.
\end{definition}

\paragraph{Теорема Кронекера-Капэлли}

Пользуясь определением ранга можно сделать следующее замечание.

\begin{claim}
Пусть $F$ -- некоторое поле, $A\in \operatorname{M}_{m\,n}(F)$ и $b\in F^m$.
Тогда система $Ax = b$ имеет решение тогда и только тогда, когда $\rk(A) = \rk(A|b)$.
\end{claim}
