\ProvidesFile{lecture31.tex}[Лекция 31]


\subsection{Комплексификация}

Задача этого параграфа следующая, мы хотим построить процедуру, которая преобразует вещественные векторные пространства в комплексные и одновременно с этим операторы и билинейные формы превращает в операторы и полуторалинейные формы.
Эта процедура и будет называться комплексификаций.
На самом деле мы уже знаем на примитивном уровне, как проводить такую процедуру, как показывает пример ниже.
Однако, его недостаток в том, что эта конструкция зависит от базиса, а значит, мы не можем ничего гарантировать в другом базисе.
Куда удобнее было бы задать эту процедуру абстрактно, а потом проверить, что в базисе она задается по правилам из примера.
Этому и будет посвящен этот раздел.%
\footnote{На самом деле есть еще процедура овещестления, но она тривиальна, а потому является верхом формализма.
По простому, каждое векторное пространство над $\mathbb C$ можно рассматривать как векторное пространство над $\mathbb R$, просто забывая про то, что мы умели умножать на мнимую единицу.
Может быть имеет смысл помучить вас этим материалом, но я уже оторвался на тензорах и сейчас на это нет времени и возможности.}

\paragraph{VIP пример}

Пусть $V = \mathbb R^n$ -- наше векторное пространство, оператор $\varphi \colon \mathbb R^n\to \mathbb R^n$ задан по правилу $x \mapsto Ax$, где $A\in \Matrix{n}$, и есть билинейная форма $\beta \colon \mathbb R^n\times \mathbb R^n\to \mathbb R$ задана $\beta(x,y) = x^t By$, где $B\in \Matrix{n}$.
Тогда мы можем заменить $V$ на пространство $V_{\mathbb C} = \mathbb C^n$, оператор $\varphi$ на $\varphi_{\mathbb C}\colon \mathbb C^n \to \mathbb C^n$ по правилу $z\mapsto Az$, и билинейную форму $\beta$ на полуторалинейную форму $\beta_{\mathbb C}\colon \mathbb C^n \times \mathbb C^n \to \mathbb C$ по правилу $\beta_{\mathbb C}(z, w)= \bar z^t B w$.
Вот и все.
Ничего страшного.
Кроме этого, мы естественным образом получаем вложение $\mathbb R^n$ в $\mathbb C^n$.
Теперь наша задача -- научиться все это хозяйство проделывать без явного выбора базиса и координат.

\begin{definition}
Пусть $V$ -- вещественное векторное пространство, определим комплексное векторное пространство $V_{\mathbb C}$ следующим образом:
\begin{itemize}
\item Как множество $V_{\mathbb C} = \{v + i u \mid v,u\in V\}$.
То есть $V_\mathbb C$ -- это множество картинок вида $v+iu$, где $i$ -- значок для мнимой единицы, а $v$ и $u$ -- векторы из $V$.
Формально $V_\mathbb C = V\times V$, то есть каждая картинка $v+iu$ -- это просто пара векторов $(v,u)\in V^2$.

\item Операция сложения задана правилом
\[
(v_1+iu_1) + (v_2 + iu_2) = (v_1+v_2) + i(u_1+u_2),\quad v_1,v_2,u_1,u_2\in V
\]

\item Умножения на скаляр задано по правилу
\[
(\lambda + i\mu) (v+iu) = (\lambda v - \mu u) + i(\lambda u + \mu v),\quad \lambda,\mu \in \mathbb R, \;\; v,u\in V
\]
\end{itemize}
Пространство $V_\mathbb C$ называется комплексификацией пространства $V$.
\end{definition}

Можно проверить, что таким образом заданные операции на $V_\mathbb C$ превращают его в векторное пространство над $\mathbb C$.%
\footnote{Я знаю, что вы мне тут поверите на слово.
Но я настоятельно рекомендую проделать эту проверку.}

\paragraph{Замечания}

\begin{itemize}
\item Обратите внимание на то, что конструкция комплексификации повторяет конструкцию комплексных чисел.

\item Если взять $V = \mathbb R$, то $V_\mathbb C$ -- это в точности конструкция для комплексных чисел, то есть $V_\mathbb C = \mathbb C$.
В более общем случае, если $V = \mathbb R^n$, то $V_\mathbb C = \mathbb C^n$.

\item Если $v+iu\in V_\mathbb C$, где $v,u\in V$, то $v + iu = 0$ в $V_\mathbb C$ тогда и только тогда, когда $v = u = 0 $ в $V$.

\end{itemize}

\begin{definition}
Пусть $V$ -- вещественное векторное пространство и $V_\mathbb C$ -- его комплексификация.
Если $w = v +i u\in V_\mathbb C$, то вектор $v\in V$ называется вещественной частью $w$ и обозначается $\Re w$, а вектор $u\in V$ называется мнимой частью $w$ и обозначается $\Im w$.
Отображение $V_\mathbb C\to V_\mathbb C$ по правилу $v+iu\mapsto v-iu$ называется сопряжением и является $\mathbb R$ линейным отображением.
\end{definition}

Обратите внимание, что мы можем считать, что $V\subseteq V_\mathbb C$, отождествляя каждый вектор $v\in V$ с вектором $v+i0\in V_\mathbb C$.
Это ровно тот способ, каким мы вкладываем вещественные числа в комплексные, но для векторных пространств.

\begin{claim}
\label{claim::ComplfixBasis}
Пусть $V$ -- вещественное векторное пространство и $e_1,\ldots,e_n\in V$ -- базис.
Тогда векторы $e_1,\ldots,e_n$ являются базисом $V_\mathbb C$, то есть $\dim_\mathbb R V = \dim_\mathbb C V_\mathbb C$.
\end{claim}
\begin{proof}
Нам надо проверить, что векторы $e_1,\ldots,e_n$ линейно независимы и все порождают.

Линейная независимость.
Предположим найдутся $z_1,\ldots,z_n\in \mathbb C$ такие, что $z_1 e_1+ \ldots+ z_n e_n = 0$ в $V_\mathbb C$.
Пусть $z_k = a_k + i b_k$, где $a_k,b_k \in \mathbb R$.
Тогда соотношение линейной зависимости можно переписать так:
\begin{gather*}
(a_1+ib_1)e_1 + \ldots + (a_n + i b_n)e_n = 0\\
(a_1 e_1 + \ldots + a_n e_n) + i(b_1 e_1 + \ldots + b_n e_n) = 0\;\text{в}\; V_\mathbb C
\end{gather*}
Последнее означает, что и мнимая и вещественная части равны нулю, то есть
\[
a_1 e_1 + \ldots + a_n e_n = 0\quad \text{и}\quad b_1 e_1 + \ldots + b_n e_n = 0\;\text{в}\; V
\]
Так как $e_i$ -- базис, это значит, что все $a_i$ и $b_i$ равны нулю, а значит и все $z_i$ равны нулю, что и требовалось.

Порождаемость.
Пусть $v + i u\in V_\mathbb C$ -- произвольный вектор.
Тогда $v = a_1e_1+\ldots + a_n e_n$ и $u = b_1 e_1 + \ldots + b_n e_n$, так как $e_i$ -- базис.
Тогда положим $z_k = a_k + i b_k$, получим, что $v + iu = z_1 e_1 + \ldots + z_n e_n$.
\end{proof}

\subsection{Комплексификация линейных отображений и билинейных форм}
\label{subsection::complexification}

\begin{definition}
Пусть $\phi\colon V\to U$ -- линейное отображение между вещественными векторными пространствами.
Определим отображение $\phi_\mathbb C\colon V_\mathbb C\to U_\mathbb C$ по правилу $v+iu \mapsto \phi(v) + i\phi(u)$.
Полученное отображение является $\mathbb C$ линейным отображением и называется комплексификацией линейного отображения $\phi$.
\end{definition}

\paragraph{Замечание}

Пусть $\phi\colon V\to U$ -- линейное  отображение между вещественными векторными пространствами.
Пусть $e_1,\ldots,e_n$ -- базис в $V$ и $f_1,\ldots,f_m$ -- базис в $U$ и пусть $A\in \MatrixDim{m}{n}$ -- матрица отображения $\phi$ в указанной паре базисов.
По определению это означает, что $\phi(e_1,\ldots,e_n) = (f_1,\ldots,f_m)A$.
Теперь рассмотрим отображение $\phi_\mathbb C \colon V_\mathbb C\to U_\mathbb C$.
Так как множества векторов $e_1,\ldots,e_n$ и $f_1,\ldots,f_m$ являются базисами пространств $V_\mathbb C$ и $U_\mathbb C$ соответственно (утверждение~\ref{claim::ComplfixBasis}), то равенство $\phi(e_1,\ldots,e_n) = (f_1,\ldots,f_m)A$ означает, что $A$ является матрицей отображения $\phi_\mathbb C$ в этих базисах.
По сути это значит, что если в координатах $\phi$ задавалось в виде $\mathbb R^n \to \mathbb R^n$ по правилу $x \mapsto Ax$, то $\phi_\mathbb C$ задается в координатах в виде $\mathbb C^n \to \mathbb C^n$ по правилу $z\mapsto Az$, ровно то, что обещалось в примере.
Кроме того, философия этого явления следующая.
Если свойства отображения зависят только от матрицы, то эти свойства сохраняются при переходе к комплексификации.


\begin{definition}
\label{definition::ComplfixBil}
Пусть $\beta\colon V\times V\to \mathbb R$ -- билинейная форма на вещественном векторном пространстве $V$.
Определим билинейную форму $\beta \colon V_\mathbb C\times V_\mathbb C\to \mathbb C$ по следующему правилу
\[
\beta_\mathbb C(v_1+iu_1, v_2 + iu_2) = \beta(v_1, v_2) + i\beta(v_1,u_2) - i\beta(u_1, v_2) + \beta(u_1, u_2)
\]
Тогда полученное отображение $\beta_\mathbb C$ будет полуторалинейным и называется комплексификацией формы $\beta$.%
\footnote{Опять же, настоятельно рекомендую проверить полуторалинейность полученной формы, не пожалеете.}
\end{definition}

\paragraph{Замечание}

Пусть $\beta\colon V\times V\to \mathbb R$ -- билинейная форма на вещественном векторном пространстве и пусть $e_1,\ldots,e_n$ -- базис $V$.
Пусть $B\in \Matrix{n}$ -- матрица билинейной формы в этом базисе, то есть $b_{ij} = \beta(e_i,e_j)$.
Рассмотрим комплексификацию формы $\beta_\mathbb C \colon V_\mathbb C\times V_\mathbb C\to \mathbb C$.
Так как $e_1,\ldots,e_n$ -- базис $V_\mathbb C$ (утверждение~\ref{claim::ComplfixBasis}), то матрица $B$ будет матрицей полуторалинейной формы $\beta_\mathbb C$ в этом базисе.
По сути это значит, что если в координатах $\beta$ задавалась в виде $\beta(x, y) = x^t B y$, то $\beta_\mathbb C$ в координатах превращается в $\beta_\mathbb C(z, w) = \bar z^t B w$.
Философия этого явления такая же, как и у линейных отображений.
Если какое-то свойство билинейной формы зависит только от матрицы, то оно остается верным и при переходе к комплексификации.

\newpage
\section{Операторы в Евклидовом и Эрмитовом пространствах}

\subsection{Движения}

\begin{claim}
Пусть $V$ -- евклидово или эрмитово пространство и $\phi\colon V\to V$ -- оператор.
Тогда следующие условия эквивалентны:
\begin{enumerate}
\item $(\phi v, \phi u) = (v, u)$ для всех $v, u\in V$.

\item $|\phi v| = |v|$ и $\angle(\phi v, \phi u) = \angle(v, u)$ для всех $v, u\in V$.

\item $|\phi v| = |v|$ для всех $v\in V$.
\end{enumerate}
\end{claim}
\begin{proof}
(1)$\Rightarrow$(2).
Так как углы и расстояния выражаются через скалярное произведение, то сохранение скалярного произведения влечет сохранение углов и расстояний.
Действительно, $|u| = \sqrt{(u,u)}$, потому $|\phi u| = \sqrt{(\phi u, \phi u)} = \sqrt{(u,u)}= |u|$.
Угол по определению целиком определяется своим косинусом, потому достаточно проверить, что $\frac{(u,v)}{|u| |v|}$ сохраняется.
Ну а это выражение сохраняется, так как все его компоненты сохраняются.


(2)$\Rightarrow$(3).
Тривиально.

(3)$\Rightarrow$(1).
Заметим, что $Q(v) = |v|^2$ -- квадратичная форма для скалярного произведения $(v,u)$, а $Q_\phi(v) = |\phi v|^2$ -- квадратичная форма для билинейной (полуторалинейной) формы $(\phi v, \phi u)$.
Так как квадратичные формы совпадают, то по поляризационной формуле (утверждение~\ref{claim::SBilQuad} для вещественного случая и~\ref{claim::CPolarization} для комплексного) совпадают и сами билинейные формы.
\end{proof}

\paragraph{Замечания}

\begin{itemize}
\item Обратите внимание, что из условия $|\phi v| = |v|$ следует, что $\phi$ инъективен, а значит и обратим.

\item Я бы хотел пояснить это доказательство для случая евклидовых пространств, в этом случае его можно себе наглядно представить.
Эквивалентность (1) и (2) значит, что сохранять скалярное произведение это то же самое, что сохранять углы и расстояния, потому что углы и расстояния выражаются через скалярное произведение и наоборот, скалярное произведение определяется углами и расстояниями.
А вот эквивалентность (2) и (3) означает, что из сохранения расстояний следует сохранение углов.
Это можно понимать так.
Если сохраняются длины, то сохраняются длины сторон у всех треугольников.
Но так как треугольник полностью определен своими сторонами, то это означает, что в любом треугольнике сохраняются углы.
Это полезная геометрическая интуиция.
\end{itemize}

\begin{definition}
Пусть $\phi\colon V\to V$ -- оператор в евклидомом или эрмитовом пространстве, удовлетворяющий одному из эквивалентных определений предыдущего утверждения.
Тогда $\phi$ называется движением.

В случае евклидова пространства движения называются ортогональными операторами.
В случае эрмитова пространства движения называются унитарными операторами.
\end{definition}

\begin{claim}
\label{claim::MovementMatrix}
Пусть $V$ -- евклидово или эрмитово пространство, $\phi\colon V\to V$ -- линейный оператор, $e_1,\ldots,e_n$ -- ортонормированный базис $V$ и $A$ -- матрица оператора $\phi$ в этом базисе.
Тогда
\begin{enumerate}
\item В евклидовом случае, $\phi$ является движением (ортогональным оператором) тогда и только тогда, когда $A^t A = E$ (матрица ортогональна).

\item В эрмитовом случае, $\phi$ является движением (унитарным оператором) тогда и только тогда, когда $A^*A = E$ (матрица унитарна).
\end{enumerate}
\end{claim}
\begin{proof}
(1) По определению в базисе $e_1,\ldots,e_n$ скалярное произведение имеет вид $(x,y) = x^t y$, а действие оператора $\phi x = A x$.
Тогда $(Ax, Ay) = (x, y)$ означает, что $x^t A^t A y = x^t y$ для любых $x,y\in \mathbb R^n$.
Значит $A^t A = E$.

(2) Доказывается аналогично предыдущему пункту.
Надо лишь учесть, что $(x, y) = \bar x^t y$ и $\phi x = Ax$.
Потому $(Ax, Ay) = (x,y)$ превращается в $\bar x^t A^* A y = \bar x^t y$.
\end{proof}

\begin{claim}
\label{claim::MovementComplfix}
Пусть $V$ -- евклидово пространство и $V_\mathbb C$ -- его комплексификация (эрмитово пространство).
Тогда оператор $\phi \colon V\to V$ является движением (ортогональный оператор) тогда и только тогда, когда оператор $\phi_\mathbb C\colon V_\mathbb C\to V_\mathbb C$ является движением (унитарный оператор).
\end{claim}
\begin{proof}
Самый простой способ доказать -- воспользоваться предыдущим утверждением~\ref{claim::MovementMatrix}.
Выберем $e_1,\ldots,e_n$ -- ортонормированный базис $V$.
Тогда он же будет ортонормированным базисом $V_\mathbb C$ (комбинируем утверждение~\ref{claim::ComplfixBasis} и определение~\ref{definition::ComplfixBil}).
Пусть $A\in\Matrix{n}$ -- матрица $\phi$, она же будет матрицей $\phi_\mathbb C$.
В частности $A^* = A^t$.
Значит условие быть ортогональным оператором и быть унитарным совпадают.%
\footnote{На самом деле можно в лоб проверить по определению, что $(\phi v, \phi u) = (v, u)$ для любых $v,u\in V$ тогда и только тогда, когда $(\phi_\mathbb C(w_1), \phi_\mathbb C(w_2))_\mathbb C = (w_1,w_2)_\mathbb C$ для любых $w_1,w_2\in V_\mathbb C$.
Очень рекомендую проделать это легкое и полезное упражнение.}
\end{proof}

\begin{claim}
\label{claim::MovmentBasicProp}
Пусть $V$ -- евклидово или эрмитово пространство и $\phi\colon V\to V$ -- движение.
Тогда
\begin{enumerate}
\item Для любого $\lambda\in \spec \phi$ имеем $|\lambda| = 1$.%
\footnote{Здесь в евклидовом случае имеется в виду $\spec_\mathbb R \phi$, а в эрмитовом $\spec_\mathbb C\phi$.}

\item Если $\lambda\neq \mu$ -- два собственных значения $\phi$, то $V_\lambda \bot V_\mu$.

\item Если $U\subseteq V$ -- $\phi$-инвариантное подпространство, то $U^\bot$ $\phi$-инвариантное подпространство.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Пусть $v\in V$ -- ненулевой собственный вектор соответствующий собственному значению $\lambda$.
Тогда $(\phi v, \phi v) = (v, v)$, так как $\phi$ -- движение.
С другой стороны $(\phi v, \phi v) = (\lambda v, \lambda v) = |\lambda|^2(v, v)$.
Потому $|\lambda|^2 = 1$.

(2) Пусть $v\in V_\lambda$ и $u\in V_\mu$.
Тогда $(v,u) = (\phi v, \phi u) = (\lambda v,\mu u) = \lambda \bar \mu (v, u) = \lambda/\mu(v,u)$ (последнее равенство следует из предыдущего пункта).
Если $\lambda \neq \mu$, то $(v,u) = 0$, что и требовалось.

(3) Так как $\phi$ -- обратим, то $\phi(U) = U$.
Нам надо показать, что если $w\bot U$, то $\phi(w)\bot U$.
Имеем $(\phi w, \phi u) = (w, u) =0$ для любого $u\in U$ и $w\in U^\bot$.
В силу $\phi(U) = U$ получаем, что $\phi(u)$ пробегает все векторы из $U$, если $u$ пробегает все векторы из $U$.
То есть $(\phi(w), u) = 0$ для любого $u\in U$, что и требовалось.
\end{proof}

\subsection{Классификация движений}

Краткий план классификации следующий: мы сначала классифицируем движения в эрмитовом случае, а потом сведем евклидов случай к эрмитовому с помощью комплексификации.
Окажется, что в эрмитовом случае все движения диагонализуются в ортонормированном базисе и на диагонали у них будут комплексные числа по модулю $1$.
В евклидовом случае движения будут блочно диагональными, где на диагонали будут стоять $\pm1$ и блоки поворотов.

\begin{claim}
\label{claim::HermMoveClassific}
Пусть $V$ -- эрмитово пространство и $\phi\colon V\to V$ -- некоторый оператор.
Тогда эквивалентно
\begin{enumerate}
\item $\phi$ является движением (унитарный оператор).

\item Выполнены следующие свойства:
\begin{enumerate}
\item $\phi$ диагонализуем в ортонормированном базисе.

\item Для любого $\lambda\in\spec_\mathbb C\phi$, имеем $|\lambda| = 1$.%
\footnote{Если через $S^1$ обозначить единичную окружность в $\mathbb C$, то есть комплексные числа равные по модулю $1$, то это условие можно записать как $\spec_\mathbb C\phi \subseteq S^1$.}
\end{enumerate}
\end{enumerate}
\end{claim}
\begin{proof}
(2)$\Rightarrow$(1).
Пусть $e_1,\ldots,e_n$ -- тот самый ортонормированный базис и $A$ -- матрица оператора $\phi$.
В силу условия~(b) имеем $A^*A = E$.
Тогда по утверждению~\ref{claim::MovementMatrix} (описание движений в терминах матриц) $\phi$ является движением.

(1)$\Rightarrow$(2).
Так как мы действуем над полем комплексных чисел, то у нас обязательно найдется ненулевой собственный вектор $v\in V$ для некоторого $\lambda\in\spec_\mathbb C\phi$.
Тогда $V = \langle v\rangle \oplus \langle v\rangle^\bot$.
По утверждению~\ref{claim::MovmentBasicProp} пункт~3, это разложение в прямую сумму $\phi$-инвариантных подпространств.
Положим $e_1 = v/|v|$.
Так как $\langle v\rangle^\bot$ является $\phi$-инвариантным, то можно применить индукцию для $\phi|_{\langle v \rangle^\bot}$  по размерности пространства и найдем ортонормированный базис $e_2,\ldots,e_n$ в $\langle v\rangle^\bot$, в котором ограничение $\phi$ диагонализуется.
Тогда $e_1,\ldots,e_n$ -- ортонормированный базис, в котором диагонализуется $\phi$.
На диагонали $\phi$ будут стоять элементы $\spec_\mathbb C\phi$.
По утверждению~\ref{claim::MovmentBasicProp} пункт~1 они все по модулю равны $1$, что и требовалось.
\end{proof}

\paragraph{Замечание}

Обратите внимание на интересный момент.
Если вы рассмотрите пространство $\mathbb R^2$ со стандартным скалярным произведением, то оператор заданный матрицей
\[
A =
\begin{pmatrix}
{\cos \alpha}&{-\sin\alpha}\\
{\sin \alpha}&{\cos \alpha}
\end{pmatrix}
\]
Является поворотом на угол $\alpha$ и в частности это движение.
Если $\alpha$ не кратен $\pi$, то этот оператор не имеет инвариантных подпространств, а значит он не диагонализуем.

С другой стороны, если рассмотреть пространство $\mathbb C^2$ со стандартным скалярным произведением  и оператор заданный той же самой матрицей $A$, то полученный оператор будет движением.
Но при этом он диагонализуется в виде
\[
\begin{pmatrix}
{\cos \alpha + i\sin \alpha}&{0}\\
{0}&{\cos \alpha - i\sin \alpha}
\end{pmatrix}
=
\begin{pmatrix}
{e^{i\alpha}}&{0}\\
{0}&{e^{-i\alpha}}
\end{pmatrix}
\]
Таким образом поворот в плоскости сменился на две сопряженные поляризации внутри каждой из комплексных прямых.
Это любопытное явление, которое очень сильно контрастирует с вещественной интуицией.
Имейте это в виду, когда работаете в комплексном случае.


\begin{claim}
Пусть $V$ -- комплексное векторное пространство и $\phi\colon V\to V$ -- некоторый оператор.
Тогда эквивалентно:
\begin{enumerate}
\item Существует скалярное произведение на $V$, относительно которого $\phi$ является движением.

\item Выполнены следующие свойства:
\begin{enumerate}
\item $\phi$ диагонализуем.

\item Для любого $\lambda\in\spec_\mathbb C\phi$, имеем $|\lambda| = 1$.
\end{enumerate}
\end{enumerate}
\end{claim}
\begin{proof}
(1)$\Rightarrow$(2).
Если существует скалярное произведение, то оно задает структуру эрмитова пространства, а значит мы можем применить предыдущее утверждение.

(2)$\Rightarrow$(1).
Пусть $e_1,\ldots,e_n$ -- базис, в котором $\phi$ диагонализуем.
Зададим скалярное произведение так, чтобы $e_1,\ldots,e_n$ был ортонормированным (это делается аналогично утверждению~\ref{claim::ScalarDef}).
Тогда выполнен пункт~(2) предыдущего утверждения, а значит и выполнен пункт~(1).
То есть $\phi$ является движением относительно построенного скалярного произведения.
\end{proof}

В случае евклидова пространства нам нужно одно техническое наблюдение.

\begin{claim}
\label{claim::OrthoRealfix}
Пусть $V$ -- евклидово пространство, $V_\mathbb C$ -- его комплексификация и $w\in V_\mathbb C$.
Тогда эквивалентно
\begin{enumerate}
\item $w\bot \bar w$

\item выполнены два условия:
\begin{enumerate}
\item $|\Re w | = |\Im w|$

\item $\Re w \bot \Im w$
\end{enumerate}
\end{enumerate}
\end{claim}
\begin{proof}
Пусть $w = v+ iu$.
Тогда, расписав по определению, получим $(w, \bar w) = (v, v) - (u,u) +2i(v,u)$.
Значит, 
\[
w\bot \bar w \iff
\left\{
\begin{aligned}
&(v,v) - (u,u) = 0\\
&(v,u) = 0
\end{aligned}
\right.
\iff
\left\{
\begin{aligned}
|v| &= |u|\\
v &\bot u
\end{aligned}
\right.
\]
\end{proof}

\begin{claim}
\label{claim::OrthotInvarSub}
Пусть $V$ евклидово пространство и $\phi \colon V\to V$ -- некоторое движение.
Тогда
\begin{itemize}
\item Либо существует собственный вектор $v\in V$ для собственных значений $\pm 1$.

\item Либо существует инвариантное двумерное подпространство $U\subseteq V$ и его ортонормированный базис $e_1, e_2$ такие, что матрица $\phi|_U$ в этом базисе имеет вид
\[
\begin{pmatrix}
{\cos \alpha}&{-\sin \alpha}\\
{\sin \alpha}&{\cos \alpha}
\end{pmatrix}
,\;\text{для некоторого $\alpha \in [0,2\pi)$}
\]
\end{itemize}
\end{claim}
\begin{proof}
По утверждению~\ref{claim::MovmentBasicProp} все вещественные собственные значения $\phi$ -- это $\pm 1$.
Значит, если спектр не пуст, то выполнено первое условие.
Пусть $\spec_\mathbb R= \varnothing$.
В этом случае перейдем к комплексификации отображения $\phi_\mathbb C\colon V_\mathbb C\to V_\mathbb C$.
По утверждению~\ref{claim::MovementComplfix} $\phi_\mathbb C$ является движением в эрмитовом пространстве.
Так как $\mathbb C$ алгебраически замкнуто, то спектр обязательно не пуст.
А по утверждению~\ref{claim::MovmentBasicProp} в нем обязательно числа по модулю равные $1$.
Значит найдется $\lambda = \cos \alpha - i \sin \alpha$ и $w= v + i u\in V_\mathbb C$ такие, что $\phi_\mathbb C(w) = \lambda w$.
Давайте распишем эти условия более явно.
С одной стороны по определению:
\[
\phi_\mathbb C(w) = \phi(v) + i\phi(u)
\]
С другой стороны, так как $w$ собственные, имеем
\[
\phi_\mathbb C(w) = \lambda w = (\cos \alpha - i \sin \alpha) (v+ i u) = \cos \alpha \;v + \sin \alpha\; u + (-\sin \alpha\; v +\cos\alpha\; u)
\]
Но в комплексификации вектора равны тогда и только тогда, когда их вещественные и мнимые части равны.
Значит,
\begin{align*}
\phi(v) &= \cos \alpha\; v + \sin \alpha\; u\\
\phi(u) &= -\sin \alpha\; v +\cos\alpha\; u
\end{align*}
Таким образом подпространство в $V$ натянутое на векторы $v$ и $u$ является $\phi$ инвариантым.
Если я теперь покажу, что векторы $v$ и $u$ ортогональны и имеют одинаковую длину, то пространство $\langle v,u\rangle$ будет двумерным и, поделив их на их общую длину, я получу ортонормированный базис и матрица оператора в этом базисе будет ровно такой, как и заявлено.

Давайте применим комплексное сопряжение к равенству $\phi_\mathbb C(w) = \lambda w$.
Тогда левая часть
\[
\overline{\phi_\mathbb C(w)} = \overline{\phi(v) + i \phi(w)} = \phi(v) - i \phi(w) = \phi_\mathbb C(v - iu) = \phi_\mathbb C(\overline{v + i w}) = \phi_\mathbb C(\bar w)
\]
А правая часть равно
\[
\overline{\lambda w} = \bar \lambda \bar w
\]
То есть $\bar w$ -- это собственный вектор с собственным значением $\bar \lambda$.
Но так как $\lambda$ было не вещественным числом, $\lambda \neq \bar\lambda$.
А значит, по утверждению~\ref{claim::MovmentBasicProp} векторы $w$ и $\bar w$ ортогональны.
Но тогда по утверждению~\ref{claim::OrthoRealfix} $|v| = |u|$ и $(v, u) = 0$.
При этом длина этих векторов не ноль, иначе $w$ был бы нулем, что противоречило бы его выбору.

\end{proof}

\begin{claim}
Пусть $V$ евклидово пространство и $\phi\colon V\to V$ -- некоторый оператор.
Тогда эквивалентно
\begin{enumerate}
\item $\phi$ является движением (ортогональный оператор).

\item В некотором ортонормированном базисе матрица оператора $\phi$ имеет вид:
\[
A_\phi=
\begin{pmatrix}
{A_1}&{}&{}\\
{}&{\ddots}&{}\\
{}&{}&{A_r}\\
\end{pmatrix},
\quad\text{где}\quad
A_i\;\;\text{либо}\;\;1,\;\;\text{либо}\;\;-1,\;\;\text{либо}\;\;
\begin{pmatrix}
{\cos \alpha}&{-\sin\alpha}\\
{\sin\alpha}&{\cos\alpha}
\end{pmatrix}
\]
\end{enumerate}
\end{claim}
\begin{proof}
(2)$\Rightarrow$(1).
Пусть $e_1,\ldots,e_n$ -- тот самый ортонормированный базис и $A$ -- матрица оператора $\phi$.
Прямая проверка показывает, что $A^tA = E$.
Тогда по утверждению~\ref{claim::MovementMatrix} (описание движений в терминах матриц) $\phi$ является движением.

(1)$\Rightarrow$(2).
По утверждению~\ref{claim::OrthotInvarSub} возможен один из двух случаев:
\begin{enumerate}
\item Существует собственный вектор $v$ с собственным значением $1$ или $-1$.

\item Существует инвариантное двумерное подпространство $U$ с ортонормированным базисом $e_1, e_2$ такие, что матрица $\phi|U$ в этом базисе имеет указанный вид.
\end{enumerate}

Если у нас случай (1), то мы рассмотрим разложение пространства $V = \langle v\rangle \oplus \langle v\rangle^\bot$.
Тогда ортогональное дополнение будет $\phi$-инвариантным.
Значит мы можем ограничить на него $\phi$, по индукции там найти ортонормированный базис $e_2,\ldots,e_n$ с требуемыми свойствами.
Тогда положим $e_1 = v / |v|$ и базис $e_1,\ldots,e_n$ будет искомым.

Если у нас случай (2), то мы рассмотрим разложение $V = U \oplus U^\bot$.
Тогда ортогональное дополнение будет $\phi$-инвариантным.
Значит мы можем ограничить на него $\phi$ и как и раньше найти ортонормированный базис $e_3,\ldots,e_n$ с требуемыми свойствами.
Тогда возьмем $e_1,e_2$ из $U$ и базис $e_1,\ldots,e_n$ будет искомым.
\end{proof}

\begin{claim}
Пусть $V$ -- вещественное векторное пространство и $\phi\colon V\to V$ -- некоторый оператор.
Тогда эквивалентно:
\begin{enumerate}
\item Существует скалярное произведение на $V$, относительно которого $\phi$ является движением.

\item В некотором базисе матрица оператора $\phi$ имеет вид:
\[
A_\phi=
\begin{pmatrix}
{A_1}&{}&{}\\
{}&{\ddots}&{}\\
{}&{}&{A_r}\\
\end{pmatrix},
\quad\text{где}\quad
A_i\;\;\text{либо}\;\;1,\;\;\text{либо}\;\;-1,\;\;\text{либо}\;\;
\begin{pmatrix}
{\cos \alpha}&{-\sin\alpha}\\
{\sin\alpha}&{\cos\alpha}
\end{pmatrix}
\]
\end{enumerate}
\end{claim}
\begin{proof}
(1)$\Rightarrow$(2).
Если существует скалярное произведение, то оно задает структуру евклидова пространства, а значит мы можем применить предыдущее утверждение.

(2)$\Rightarrow$(1).
Пусть $e_1,\ldots,e_n$ -- базис, в котором $\phi$ имеет указанный блочный вид.
Зададим скалярное произведение так, чтобы $e_1,\ldots,e_n$ был ортонормированным (так сделать можно по утверждению~\ref{claim::ScalarDef}).
Тогда выполнен пункт~(2) предыдущего утверждения, а значит и выполнен пункт~(1).
То есть $\phi$ является движением относительно построенного скалярного произведения.
\end{proof}

% TO DO 
% Движения в двух мерном и трехмерном пространствах!
