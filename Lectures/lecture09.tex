\ProvidesFile{lecture09.tex}[Лекция 9]


\subsection{Характеристический многочлен}

Пусть $A\in\Matrix{n}$ -- произвольная квадратная матрица и $\lambda \in\mathbb R$.
Рассмотрим функцию $\chi_A(\lambda) = \det(\lambda E - A)$.

\begin{claim}
\label{claim::CharSpec}
Пусть $A\in\Matrix{n}$.
Тогда верно
\begin{enumerate}
\item Функция $\chi_A(\lambda)$ является многочленом степени $n$ со старшим коэффициентом $1$.

\item Для произвольного числа $\lambda$ верно, что $\lambda \in\spec_\mathbb R A$ тогда и только тогда, когда $\chi_A(\lambda) = 0$.%
\footnote{Аналогичное утверждение верно и для $\spec_\mathbb C A$.}
\end{enumerate}
\end{claim}
\begin{proof}
(1) Давайте посмотрим на явную формулу определителя
\[
\det B = \sum_{\sigma\in\Sym{n}}\sgn(\sigma) b_{1\sigma(1)}\ldots b_{n\sigma(n)}
\]
Заметим, что данное выражение является многочленом от коэффициентов матрицы $A$, причем все его слагаемые имеют степень $n$.
Теперь, когда мы считаем характеристический многочлен, мы находим $\det(\lambda E - A)$.
То есть вместо $b_{ii}$ мы должны подставить  $\lambda - a_{ii}$, а вместо $b_{ij}$ взять $-a_{ij}$ (при $i\neq j$).
То есть мы в многочлен от многих переменных подставляем либо числа, либо линейный многочлен от $\lambda$.
Понятно, что результатом будет многочлен от $\lambda$ причем степени уж точно не больше $n$.
Теперь давайте поймем какая будет у него степень и старший коэффициент.

% Можно: Понятно, что результат будет многочленом от $\lambda$ причем степени уж точно не больше $n$.
\[
\lambda E - A = 
\begin{pmatrix}
{\lambda - a_{11}}&{\ldots}&{-a_{1n}}\\
{\vdots}&{\ddots}&{\vdots}\\
{-a_{n1}}&{\ldots}&{\lambda - a_{nn}}\\
\end{pmatrix}
\]
Ясно, что максимальная степень по $\lambda$ может вылезти только из слагаемого являющегося произведением диагональных элементов -- $(\lambda - a_{11}) \ldots (\lambda - a_{nn})$.
А его старший член $\lambda^n$.
Вот и все.

(2) Вспомним, что $\lambda\in\spec_\mathbb R A$ тогда и только тогда, когда $A - \lambda E$ -- необратимая матрица или что то же самое,  $\lambda E - A$ -- необратимая матрица.
Матрица необратима тогда и только тогда, когда ее определитель ноль.
Потому $\lambda \in\spec_\mathbb R A$ тогда и только тогда, когда $\det (\lambda E - A) = 0$, то есть $\chi_A(\lambda) = 0$.
Что и требовалось.
\end{proof}

\begin{definition}
Для произвольной матрицы $A\in\Matrix{n}$ многочлен $\chi_A(\lambda)$ называется {\it характеристическим многочленом} матрицы $A$.
\end{definition}

\paragraph{Явные формулы для коэффициентов характеристического многочлена}

Вначале давайте введем некоторые обозначения.
Пусть $A\in\Matrix{n}$ -- некоторая матрица.
Рассмотрим произвольное $k$ элементное подмножество в множестве чисел от $1$ до $n$ заданное в виде $i_1,\ldots, i_k$%
\footnote{Здесь предполагается, что $i_1 < \ldots < i_k$.}
Вычеркнем из матрицы $A$ столбцы и строки с этими номерами и обозначим полученную матрицу через $R_{i_1,\ldots,i_k}$.
Графически эта процедура выглядит так:
\[
\begin{array}{cc}
{}&{
\begin{array}{ccccc}
{}&{i_1\phantom{aa}}&{\ldots}&{\phantom{aa}i_k}&{}\\
\end{array}
}\\
{
\begin{array}{c}
{}\\{i_1}\\{\vdots}\\{i_k}\\{}
\end{array}
}&{
\left(
\begin{array}{c|c|c|c|c}
\cline{2-2}
\cline{4-4}
{R_{1\,1}}&{
\begin{array}{c}
{a_{1i_1}}\\{\vdots}
\end{array}
}&{\ldots}&{
\begin{array}{c}
{a_{1i_k}}\\{\vdots}
\end{array}
}&{R_{1\,k+1}}\\
\hline
\multicolumn{1}{|c|}{
\begin{array}{cc}
{a_{i_11}}&{\ldots}\\
\end{array}
}&{}&{}&{}&\multicolumn{1}{c|}{
\begin{array}{cc}
{\ldots}&{a_{i_1n}}\\
\end{array}
}\\
\hline
{\vdots}&{}&{\ddots}&{}&{\vdots}\\
\hline
\multicolumn{1}{|c|}{
\begin{array}{cc}
{a_{i_k1}}&{\ldots}\\
\end{array}
}&{}&{}&{}&\multicolumn{1}{c|}{
\begin{array}{cc}
{\ldots}&{a_{i_kn}}\\
\end{array}
}\\
\hline
{R_{k+1\,1}}&{
\begin{array}{c}
{\vdots}\\{a_{ni_1}}
\end{array}
}&{\ldots}&{
\begin{array}{c}
{\vdots}\\{a_{ni_k}}
\end{array}
}&{R_{k+1\,k+1}}\\
\cline{2-2}
\cline{4-4}
\end{array}
\right)
}\\
\end{array}
\mapsto
R_{i_1,\ldots,i_k} = 
\begin{pmatrix}
{R_{1\,1}}&{\ldots}&{R_{1\,k+1}}\\
{\vdots}&{\ddots}&{\vdots}\\
{R_{k+1\,1}}&{\ldots}&{R_{k+1\,k+1}}\\
\end{pmatrix}
\in\Matrix{n-k}
\]
Пользуясь этими обозначениями покажем следующее.

\begin{claim}
\label{claim::CharCoefs}
Пусть $A\in\Matrix{n}$ и его характеристический многочлен имеет вид 
\[
\chi_A(\lambda) = \lambda^n + a_{n-1}\lambda^{n-1} + \ldots + a_1 \lambda + a_0
\]
Тогда
\begin{enumerate}
\item В обозначениях выше, для коэффициентов $a_k$ верна следующая формула%
\footnote{Заметим, что эта формула также имеет смысл при $k=0$ и при $k = n$.
Если $k = 0$, то множество индексов пусто $\varnothing$ и $R_\varnothing = A$, потому формула превращается в равенство $a_0 = (-1)^n\det A$.
При условии $k = n$, мы вычеркиваем все строки из матрицы и в этом случае $R_{1,\ldots,n}\in\Matrix{0}$.
Такого объекта не существует, но мы можем для удобства считать, что в этом случае формула означает $\det R_{1,\ldots,n} = 1$.}
\[
a_{k} = (-1)^{n-k}\left(\sum_{i_1<\ldots<i_k}\det R_{i_1,\ldots,i_k}\right)
\]

\item $a_0 = (-1)^n\det A$.

\item $a_{n-1} =  - \tr A$.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Введем обозначения для столбцов матрицы $A = (A_1|\ldots|A_n)$ и пусть $e_i\in\mathbb R^n$ -- столбец, у которого $i$-я координата равна $1$, а все остальные $0$.
Нам надо посчитать $\det(\lambda E - A) = (-1)^n \det(A-\lambda E)$.
Тогда, 
\[
\det(A-\lambda E) = \det(A_1 - \lambda e_1|\ldots|A_n - \lambda e_n)
\]
Теперь надо раскрыть последний определитель по полилинейности.%
\footnote{Думать про это выражение надо так: надо мысленно заменить вертикальные черточки умножением и считать, что мы раскрываем скобки в произведении.}
Всего у нас будет $2^n$ слагаемых, каждое из которых -- это определитель матрицы состоящей из столбцов $A_i$ или $-\lambda e_j$, стоящих вперемешку.

Давайте для определенности считать, что у нас $n=5$, тогда мы считаем
\[
\det(A_1-\lambda e_1|A_2-\lambda e_2|A_3 - \lambda e_3|A_4 -\lambda e_4|A_5 - \lambda A_5)
\]
Среди слагаемых давайте посмотрим на слагаемое, содержащее $2$ столбца матрицы $A$ и $3$ столбца вида $-\lambda e_i$, например, такое
\[
\det(A_1|-\lambda e_2|A_3|-\lambda e_4|-\lambda e_5) = 
\det
\begin{pmatrix}
{a_{11}}&{0}&{a_{13}}&{0}&{0}\\
{a_{21}}&{-\lambda}&{a_{23}}&{0}&{0}\\
{a_{31}}&{0}&{a_{33}}&{0}&{0}\\
{a_{41}}&{0}&{a_{43}}&{-\lambda}&{0}\\
{a_{51}}&{0}&{a_{53}}&{0}&{-\lambda}\\
\end{pmatrix}
\]
Давайте последовательно разлагать этот определитель по $2$-ому, $4$-ому и $5$-ому столбцам.
Обратим внимание, что $-\lambda$ всегда будут стоять на диагонали, потому знаки всех алгебраических дополнений будут положительными:
\[
\det
\begin{pmatrix}
{a_{11}}&{0}&{a_{13}}&{0}&{0}\\
{a_{21}}&{-\lambda}&{a_{23}}&{0}&{0}\\
{a_{31}}&{0}&{a_{33}}&{0}&{0}\\
{a_{41}}&{0}&{a_{43}}&{-\lambda}&{0}\\
{a_{51}}&{0}&{a_{53}}&{0}&{-\lambda}\\
\end{pmatrix}
=
(-\lambda)
\det
\begin{pmatrix}
{a_{11}}&{a_{13}}&{0}&{0}\\
{a_{31}}&{a_{33}}&{0}&{0}\\
{a_{41}}&{a_{43}}&{-\lambda}&{0}\\
{a_{51}}&{a_{53}}&{0}&{-\lambda}\\
\end{pmatrix}
=
(-\lambda)^2
\det
\begin{pmatrix}
{a_{11}}&{a_{13}}&{0}\\
{a_{31}}&{a_{33}}&{0}\\
{a_{51}}&{a_{53}}&{-\lambda}\\
\end{pmatrix}
=
(-\lambda)^3
\det
\begin{pmatrix}
{a_{11}}&{a_{13}}\\
{a_{31}}&{a_{33}}\\
\end{pmatrix}
\]
В общем случае слагаемое с $k$ столбцами вида $-\lambda e_i$ является определителем матрицы вида
\[
\begin{array}{cc}
{}&{
\begin{array}{ccccc}
{}&{i_1\phantom{aa}}&{\ldots}&{\phantom{aa}i_k}&{}\\
\end{array}
}\\
{
\begin{array}{c}
{}\\{i_1}\\{\vdots}\\{i_k}\\{}
\end{array}
}&{
\left(
\begin{array}{c|c|c|c|c}
\cline{2-2}
\cline{4-4}
{R_{1\,1}}&{
\begin{array}{c}
{0}\\{\vdots}
\end{array}
}&{\ldots}&{
\begin{array}{c}
{0}\\{\vdots}
\end{array}
}&{R_{1\,k+1}}\\
\hline
\multicolumn{1}{|c|}{
\begin{array}{cc}
{a_{i_11}}&{\ldots}\\
\end{array}
}&{-\lambda}&{}&{}&\multicolumn{1}{c|}{
\begin{array}{cc}
{\ldots}&{a_{i_1n}}\\
\end{array}
}\\
\hline
{\vdots}&{}&{\ddots}&{}&{\vdots}\\
\hline
\multicolumn{1}{|c|}{
\begin{array}{cc}
{a_{i_k1}}&{\ldots}\\
\end{array}
}&{}&{}&{-\lambda}&\multicolumn{1}{c|}{
\begin{array}{cc}
{\ldots}&{a_{i_kn}}\\
\end{array}
}\\
\hline
{R_{k+1\,1}}&{
\begin{array}{c}
{\vdots}\\{0}
\end{array}
}&{\ldots}&{
\begin{array}{c}
{\vdots}\\{0}
\end{array}
}&{R_{k+1\,k+1}}\\
\cline{2-2}
\cline{4-4}
\end{array}
\right)
}\\
\end{array}
=I_{i_1,\ldots,i_k}
\]
Раскладывая этот определитель по столбцам $i_1, \ldots, i_k$ мы получаем
\[
\det I_{i_1,\ldots,i_k} = (-\lambda)^k
\det R_{i_1,\ldots,i_k}
\]
Слагаемые при $\lambda^k$ вылезут, когда ровно $k$ столбцов имеют вид $-\lambda e_i$.
Остается не забыть, что мы считали $(-1)^n\chi_A(\lambda)$.

(2) Свободный член многочлена $\chi_A(\lambda)$ всегда равен $\chi_A(0) = \det(0 E - A) = \det(-A) = (-1)^n \det(A)$, что и требовалось.

(3) Для подсчета $a_{n-1}$ воспользуемся формулой, получим%
\footnote{Здесь $\hat i $ означает, что индекс $i$ пропущен.}
\[
a_{n-1} = (-1)^{n - (n-1)}\sum_{i=1}^n\det R_{1,\ldots,\hat i,\ldots,n}
\]
Но заметим, что $R_{1,\ldots, \hat i,\ldots, n} = a_{ii}$, а значит предыдущее равенство превращается в
\[
a_{n-1} = (-1)^{n - (n-1)}\sum_{i=1}^n a_{ii} = - \tr A
\]
\end{proof}

\paragraph{Примеры}

\begin{enumerate}
\item Если $A\in\Matrix{1}$, то есть $A = a\in\mathbb R$ -- число, то $\chi_A(\lambda) = \lambda - a$.

\item Если $A\in\Matrix{2}$, то $\chi_A(\lambda) = \lambda^2 - \tr A \lambda + \det A$.

\item Если $A\in\Matrix{3}$, то $\chi_A(\lambda) = \lambda^3 - \tr A \lambda^2 + a_1 \lambda - \det A$, где
\[
a_1 = 
\det
\begin{pmatrix}
{a_{22}}&{a_{23}}\\
{a_{32}}&{a_{33}}\\
\end{pmatrix}
+
\det
\begin{pmatrix}
{a_{11}}&{a_{13}}\\
{a_{31}}&{a_{33}}\\
\end{pmatrix}
+
\det
\begin{pmatrix}
{a_{11}}&{a_{12}}\\
{a_{21}}&{a_{22}}\\
\end{pmatrix}
\]
\end{enumerate}

Стоит отметить, что считать характеристические многочлены от матриц большего размера через эти формулы практически не целесообразно.
Максимальный разумный размер -- матрица $4$ на $4$.
Самый быстрый способ остается алгоритм Гаусса для подсчета определителя $\det(\lambda E - A)$ с символьными коэффициентами.

\subsection{Теорема Гамильтона-Кэли}

\paragraph{Многочлены с матричными коэффициентами}

Обозначим через $\Matrix{n}[t]$ множество многочленов от переменной $t$ имеющих матричные коэффициенты из $\Matrix{n}$, т.е.
\[
\Matrix{n}[t] = \{A_0+A_1t+\ldots + A_k t^k\mid A_i\in \Matrix{n}\}
\]
здесь $t$ -- формальная переменная, которая представляет собой неизвестное число.
Про эти многочлены надо думать как про картинки.
Такие картинки можно складывать и умножать по формулам известным для многочленов с обычными числовыми коэффициентами:
\begin{itemize}
\item Сумма.
\[
\left(\sum_{i}A_i t^i\right) +\left (\sum_{j}B_j t^j\right) = \sum_{i}(A_i+ B_i) t^i
\]

\item Произведение.
\[
\left(\sum_i A_i t^i\right)\left( \sum_j B_j t^j\right) = \sum_k \left(\sum_{s+t = k}A_s B_t\right)t^k
\]
\end{itemize}
Надо лишь отметить, что в произведении нельзя переставлять местами $A_s$ и $B_t$, так как матрицы вообще говоря не перестановочны.

\paragraph{Замечание}

Для тех, кто не хочет воспринимать многочлены как картинки, я хочу сформулировать важное замечание.
Пусть $f, g\in \Matrix{n}[t]$ -- два многочлена с матричными коэффициентами.
Предположим, что для любого $a\in\mathbb R$ имеет место равенство $f(a) = g(a)$, тогда многочлены $f$ и $g$ равны, то есть совпадают все их коэффициенты.

Действительно, если $f = \sum_k A_k t^k$ и $g = \sum_k B_k t^k$, то равенство $f(a) = g(a)$ означает, что матрицы $\sum_k A_k a^k$ и $\sum_k B_k a^k$ равны.
Но это значит, что все их коэффициенты равны, то есть для любых $i,j$ между $1$ и $n$ выполняется
\[
\sum_k (A_k)_{i\,j} a^k = \sum_k (B_k)_{i\,j} a^k
\]
Но это уже равенство обычных числовых многочленов для любого числа $a\in \mathbb R$.
Отсюда следует, что коэффициенты этих многочленов равны, то есть $(A_k)_{i\,j} = (B_k)_{i\,j}$ для всех $i$ и $j$.
Но в этом случае матрицы $A_k$ и $B_k$ просто равны между собой, что и требовалось.

Таким образом, если вам не нравится работать с произвольным параметром-<<картинкой>> $t$ или $\lambda$ в выражениях ниже, вы можете объяснить многие свои сомнения через рассуждение выше.
То есть вы можете предполагать, что мы доказываем равенство для произвольного $t\in \mathbb R$, а потом получаем равенство матричных коэффициентов в многочленах.

\paragraph{Подстановка матрицы в многочлен} 

Теперь для произвольного многочлена $f\in\Matrix{n}[t]$ и матрицы $D\in\Matrix{n}$ определим подстановку матрицы $D$ в многочлен $f$ справа:
\[
f(D) = A_0 + A_1 D + \ldots + A_k D^k
\]
т.е. мы вместо $t$ подставляем всюду матрицу $D$.
Аналогично, можно определить левую подстановку:
\[
(D)f = A_0 + D A_1 + \ldots + D^k A_k
\]
Надо отметить, что вообще говоря $f(D)\neq (D)f$.
Мы всегда будем пользоваться только правой подстановкой.

\paragraph{Свойства подстановки}

Пусть $f,g\in\Matrix{n}[t]$ -- два многочлена и $D\in\Matrix{n}$ -- некоторая матрица.
Сделаем следующие замечания:
\begin{enumerate}
\item Всегда верно равенство
\[
f(D) + g(D) = (f + g)(D)
\]

\item Для произведения вообще говоря выполнено
\[
f(D)g(D)\neq (fg)(D)
\]
Действительно, возьмем $f(t) = t$, $g(t) = Bt$, тогда $(fg)(t) = Bt^2$.
В этом случае $f(D)g(D) = DBD$, а $(fg)(D) = BDD$.
Вообще говоря, имеем $DBD \neq BDD$ если матрицы $B$ и $D$ не коммутируют.

\item Если $D$ коммутирует со всеми коэффициентами матрицы $g$, то верно равенство
\[
f(D)g(D) = (fg)(D)
\]
Это видно непосредственно из определения умножения и подстановки.
\end{enumerate}

\paragraph{Теорема}

Теперь мы готовы к формулировке и доказательству полезного результата.

\begin{claim}
[Теорема Гамильтона-Кэли]
Пусть $A\in\Matrix{n}$.
Тогда $\chi_A(A) = 0$.
\end{claim}

Прежде чем доказывать теорему, давайте объясним что в точности утверждает теорема и почему дурацкие доказательства не работают.
Давайте поймем, что имеется в виду в утверждении.
Сначала мы должны посчитать характеристический многочлен, то есть явно посчитать его коэффициенты и представить в следующем виде%
\footnote{Тут коэффициенты $a_k$ вычисляются по формулам из утверждения~\ref{claim::CharCoefs}.}
\[
\chi_A(\lambda ) = \det(\lambda E - A) = \sum_{k=0}^n a_k \lambda ^k
\]
И уже после такого вычисления, надо подставить вместо $\lambda$ матрицу $A$ и получить
\[
\chi_A(A) = \sum_{k=0}^n a_k A^k = 0
\]
Как раз не очевидно, что последнее равенство выполняется.

Надо обратить внимание, что если мы подставим матрицу $A$ вместо $\lambda$ в выражение $\det(\lambda E - A)$ мы действительно получим $0$.
Однако, равенство $\det(\lambda E - A) = \sum_{k = 0}^n \lambda^k$ верно только если $\lambda$ является числом и потому вообще говоря не понятно почему это равенство должно сохраниться при $\lambda = A$.%
\footnote{На самом деле оно вообще говоря не будет верным для произвольных матриц потому что выражение слева всегда дает число, а выражение справа -- матрицу.}
Давайте продемонстрируем это на матрице $2$ на $2$.
Пусть
\[
A = 
\begin{pmatrix}
{a_{11}}&{a_{12}}\\
{a_{21}}&{a_{22}}\\
\end{pmatrix}
\]
Тогда
\[
\det(A-\lambda E) =
\det
\left(
\begin{pmatrix}
{a_{11}}&{a_{12}}\\
{a_{21}}&{a_{22}}\\
\end{pmatrix}
-\lambda E
\right)=
\det 
\begin{pmatrix}
{a_{11}-\lambda}&{a_{12}}\\
{a_{21}}&{a_{22}-\lambda}\\
\end{pmatrix}
\]
Так вот, последнее равенство верно если $\lambda$ является числом.
Если же $\lambda$ является матрицей, то оно непонятно, что значит.
Можно понимать правую часть как блочную матрицу $2$ на $2$ из блоков $2$ на $2$ (т.е. всего $4$ на $4$), но тогда это просто не верное равенство.
Это рассуждение можно докрутить до верного, но тогда в правой части надо использовать вместо определителя его более хитрую блочную версию.
Подобное рассуждение растет из коммутативной алгебры, где доказательство естественным образом сводится к формулам Крамера, но для его освоения надо знать, что такое кольца и модули.
Мы же пойдем чуть более простым путем.%
\footnote{Ну как сказать простым...}

\begin{proof}
Рассмотрим матрицу $\lambda E - A$, где $\lambda$ -- неизвестное число.
Введем следующее обозначение $R(\lambda) = \widehat{\lambda E - A}$.

Заметим, что каждый коэффициент $R(\lambda)$ является многочленом от $\lambda$, т.е. $R(\lambda) = (r_{ij}(\lambda))$ и $r_{ij}(\lambda)$ -- многочлен.
То есть $r_{ij}(\lambda) = \sum_k r_{ijk}\lambda^k$.
Тогда $R(\lambda) = \sum_k R_k \lambda^k$, где $R_k=(r_{ijk})$.
То есть $R(\lambda)\in\Matrix{n}[\lambda]$.
Для ясности, давайте проиллюстрируем сказанное на следующем примере.
\[
\begin{pmatrix}
{5 - \lambda + 2 \lambda^2}&{3}\\
{4 - \lambda}&{2 + \lambda}\\
\end{pmatrix}
=
\begin{pmatrix}
{5}&{3}\\
{4}&{2}
\end{pmatrix}
+
\begin{pmatrix}
{-1}&{0}\\
{-1}&{1}
\end{pmatrix}
\lambda
+
\begin{pmatrix}
{2}&{0}\\
{0}&{0}
\end{pmatrix}
\lambda^2
\]

Теперь применим формулы для перемножения матрицы с ее присоединенной из утверждения~\ref{claim::InvMatExplicite} для матрицы $\lambda E - A$, получим 
\[
(\lambda E - A)R(\lambda) = R(\lambda)(\lambda E - A) = \det(\lambda E - A)E=\chi_A(\lambda)E
\]
Нас интересует только равенство
\[
R(\lambda)(\lambda E - A) = \chi_A(\lambda)E
\]
Тогда рассмотрим многочлены $f(\lambda) = R(\lambda)$, $g(\lambda) = \lambda E  - A$.
В этом случае $(fg)(\lambda) = \chi_A(\lambda)E$.%
\footnote{Если вы в этом месте в ужасе от того, что я творю, я предлагаю заметить, что мы по сути доказали равенство значений многочленов с матричными коэффициентами при любом $\lambda\in\mathbb R$.
А теперь можно воспользоваться замечанием, что отсюда следует совпадение многочленов как картинок, то есть все их матричные коэффициенты тоже совпадают.}
Возьмем в качестве матрицы $D$ матрицу $A$.
Заметим, что она коммутирует с коэффициентами $g$, потому что это $E$ и $-A$.
Значит верно равенство $f(D)g(D) = (fg)(D)$.
Последнее означает
\[
0 = R(A)(A E - A) = \chi_A(A) E = \chi_A(A)
\]
Что и требовалось доказать.
\end{proof}
