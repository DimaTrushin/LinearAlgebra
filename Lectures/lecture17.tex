\ProvidesFile{lecture17.tex}[Лекция 17]


\subsection{Свойства ограничения оператора}

Теперь нам надо освоить несколько мелких технических утверждений связанных с поведением различных характеристик ограничения оператора на инвариантное подпространство.

\begin{claim}
Пусть $\varphi\colon V\to V$ -- линейный оператор и $U\subseteq V$ -- инвариантное подпространство.
Тогда
\begin{enumerate}
\item Если $\varphi$ обратим, то $\varphi|_U$ обратим.

\item $\spec_F \varphi|_U\subseteq \spec_F \varphi$.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Если $\varphi$ обратим, то $\ker \varphi = 0$, тогда $\ker \varphi|_U = \ker \varphi \cap U = 0$.
А значит $\varphi|_U$ обратим по утверждению~\ref{claim::OperatorInvert}.

(2) Нам надо показать, что если $\lambda\notin\spec_F \varphi$, то $\lambda\notin\spec_F \varphi|_U$.
То есть если $\varphi-\lambda\Identity$ обратим, то и $\varphi|_U-\lambda \Identity$ обратим.
Но это следует из первого пункта и наблюдения 
\[
(\varphi - \lambda \Identity)|_U = \varphi|_U -(\lambda\Identity)|_U = \varphi|_U - \lambda \Identity
\]
\end{proof}



\begin{claim}
\label{claim::RestrictionChar}
Пусть $V = U\oplus W$, $\varphi\colon V\to V$ -- линейный оператор и подпространства $U$ и $W$ являются $\varphi$-инвариантными.
Тогда
\begin{enumerate}
\item $\tr \varphi = \tr \varphi|_U + \tr \varphi|_W$.

\item $\det \varphi = \det \varphi|_U \det \varphi|_W$.

\item $\chi_\varphi(t) = \chi_{\varphi|_U}(t) \chi_{\varphi|_W}(t)$.

\item $\spec_F \varphi = \spec_F \varphi|_U \cup \spec_F \varphi|_W$.
\end{enumerate}
\end{claim}
\begin{proof}
Пусть $e$ -- базис $U$ и $f$ -- базис $W$.
Тогда по одному из эквивалентных определений прямой суммы (утверждение~\ref{claim::DirectSum}) $e \cup f$ будет базисом $V$.
Давайте запишем в этом базисе наш оператор $\varphi$:
\[
\varphi(e,f) = (e,f)
\begin{pmatrix}
{A}&{B}\\
{C}&{D}
\end{pmatrix}
\]
Так как подпространство $U =\langle e \rangle$ $\varphi$-инвариантно, то есть $\varphi(U)\subseteq U$, то $\varphi(e)$ выражается только через $e$.
Последнее означает, что $C = 0$.
Аналогично, так как $W$ $\varphi$-инвариантно, то $B = 0$.
А значит
\[
\varphi(e,f) = (e,f)
\begin{pmatrix}
{A}&{0}\\
{0}&{D}
\end{pmatrix}
\]
При этом по определению $A$ -- это матрица $\varphi|_U$ в базисе $e$, а $D$ -- это матрица $\varphi|_W$ в базисе $f$.
Тогда все четыре утверждения следуют из явного подсчета следа, определителя, характеристического многочлена и спектра для блочно диагональных матриц.
\end{proof}

\subsection{Приведение к верхнетреугольному виду}

\begin{claim}
Пусть $\varphi \colon V\to V$ -- линейный оператор в векторном пространстве размерности $n$ над полем $F$ и пусть $\lambda\in F$ -- корень минимального многочлена для $\varphi$.
Тогда существует базис, в котором матрица $\varphi$ имеет следующий блочный вид
\[
A_\varphi = 
\begin{pmatrix}
{\lambda}&{*}\\
{0}&{B}
\end{pmatrix},\text{ где }
B\in \operatorname{M}_{n-1}(F)
\]
\end{claim}
\begin{proof}
Тут можно было бы воспользоваться утверждением~\ref{claim::EigenSpec}.
Тогда для корня $\lambda$ подпространство $V_\lambda$ не нулевое.
А значит в нем есть искомый ненулевой вектор.
Однако, полезно понимать, как найти собственный вектор с помощью минимального многочлена явно.
Давайте проделаем это.

Пусть $f_{\text{min}}=(t-\lambda)g(t)$.
Тогда $g(\varphi) \neq 0$, то есть $g(\varphi)$ -- ненулевой оператор.
Последнее означает, что для какого-то вектора $v\in V$, $g(\varphi)v\neq 0$.
Обозначим $u = g(\varphi)v$.
Тогда это ненулевой вектор.
С другой стороны
\[
(\varphi - \lambda \Identity)u = (\varphi - \lambda \Identity)g(\varphi)v = f_\text{min}(\varphi)v = 0
\]
То есть $u$ -- ненулевой собственный вектор с собственным значением $\lambda$.
Раз это ненулевой вектор, то множество $\{u\}$ линейно независимое.
А значит его можно дополнить до базиса.
Пусть это будет $u,u_2,\ldots,u_n$.
Тогда в этом базисе матрица оператора $\varphi$ будет иметь заявленный вид.
Действительно, по определению
\[
\varphi(u, u_2,\ldots, u_n) = (u, u_2,\ldots,u_n)
\begin{pmatrix}
{a}&{*}\\
{w}&{B}
\end{pmatrix}
\]
Тогда $\varphi u = a u + (u_2, \ldots, u_n)w$.
Но мы уже знаем, что $\varphi u = \lambda u$.
То есть $a = \lambda$ и $w = 0$.
\end{proof}


\begin{claim}
\label{claim::OperatorUpperTriangle}
Пусть $\varphi\colon V\to V$ -- линейный оператор в векторном пространстве над полем $F$ и пусть минимальный многочлен $f_{\text{min}}$ для $\varphi$ раскладывается на линейные множители $(t-\lambda_1)^{k_1}\ldots (t-\lambda_r)^{k_r}$.
Тогда существует базис в $V$ такой, что матрица $\varphi$ верхнетреугольная с числами $\lambda_1,\ldots,\lambda_r$ на диагонали (возможно с повторениями).
\end{claim}
\begin{proof}
Я не смогу вам дать доказательство полностью на языке операторов, так как мы не владеем некоторыми необходимыми техническими средствами в виде фактор пространств и фактор операторов.
Потому надо будет переформулировать все в терминах матриц.

В начале выберем случайный базис в $V$.
Тогда наш оператор превратится в $A\colon F^n \to F^n$.
Нам надо найти такую обратимую матрицу $D\in \operatorname{M}_n(F)$, что $D^{-1}AD$ будет верхне треугольной с числами $\lambda_1,\ldots, \lambda_r$ на диагонали (может быть с повторениями).


Начнем.
Так как минимальный многочлен раскладывается на линейные, то он имеет корень, например, выберем $\lambda_1$.
Тогда предыдущее утверждение означает, что можно найти обратимую матрицу $C\in \operatorname{M}_n(F)$ такую, что
\[
C^{-1}AC =
\begin{pmatrix}
{\lambda_1}&{*}\\
{0}&{B}
\end{pmatrix}
\]
Заметим, что для произвольного многочлена $f$ верно
\[
f\begin{pmatrix}
{\lambda_1}&{*}\\
{0}&{B}
\end{pmatrix}
=
\begin{pmatrix}
{f(\lambda_1)}&{*}\\
{0}&{f(B)}
\end{pmatrix}
\]
А значит $f_\text{min}$ зануляет блок $B$.
То есть минимальный многочлен для $B$ тоже раскладывается на линейные множители и его корни находятся среди корней $f_\text{min}$, так как минимальный для $B$ делит $f_\text{min}$.
А значит, для $B$ по индукции найдется такая обратимая матрица $T\in \operatorname{M}_{n-1}(F)$, что $T^{-1}BT$ является верхне треугольной с числами $\lambda_1,\ldots,\lambda_r$ на диагонали (быть может с повторениями и пропусками).
Тогда
\[
\begin{pmatrix}
{1}&{}\\
{}&{T}
\end{pmatrix}^{-1}
C^{-1}AC
\begin{pmatrix}
{1}&{}\\
{}&{T}
\end{pmatrix}
=
\begin{pmatrix}
{1}&{}\\
{}&{T}
\end{pmatrix}^{-1}
\begin{pmatrix}
{\lambda_1}&{*}\\
{0}&{B}
\end{pmatrix}
\begin{pmatrix}
{1}&{}\\
{}&{T}
\end{pmatrix}=
\begin{pmatrix}
{\lambda_1}&{*}\\
{0}&{T^{-1}BT}
\end{pmatrix}
\]
Последняя матрица верхне треугольная с числами $\lambda_1,\ldots,\lambda_r$ на диагонали (быть может с повторениями).
То есть мы доказали, что хотели с матрицей
\[
D = C 
\begin{pmatrix}
{1}&{}\\
{}&{T}
\end{pmatrix}
\]
\end{proof}

\begin{claim}
\label{claim::CharPolyOnRootSpace}
Пусть $\varphi\colon V\to V$ -- некоторый линейный оператор на векторном пространстве $V$ над полем $F$.
Тогда $\chi_{\varphi|_{V^\lambda}} (t) = (t - \lambda)^{\dim V^\lambda}$.
\end{claim}
\begin{proof}
Оператор $\varphi|_{V^\lambda}$ зануляется многочленом вида $(t-\lambda)^d$.
Значит его минимальный многочлен имеет вид $(t-\lambda)^k$.
По утверждению~\ref{claim::OperatorUpperTriangle} матрица оператора $\varphi|_{V^\lambda}$ приводится к верхнетреугольному виду с $\lambda$ на диагонали.
А значит $\chi_{\varphi|_{V^\lambda}}(t) = (t - \lambda)^{\dim V^{\lambda}}$.
\end{proof}

\subsection{Идеальный спектр}

\begin{definition}
Пусть $\varphi \colon V\to V$ -- линейный оператор над произвольным полем $F$, тогда идеальный спектр $\varphi$ это следующее множество:
\[
\spec_F^I\varphi :=\{p\in F[t]\mid p\text{ -- неприводим со старшим коэффициентом } 1 \text{ и } p(\varphi)\text{ необратим}\}
\]
\end{definition}

\paragraph{Пример}

Если рассмотреть линейный оператор $A\colon \mathbb R^2\to \mathbb R^2$ заданный матрицей $A = \left(\begin{smallmatrix}{0}&{-1}\\{1}&{0}\end{smallmatrix}\right)$, то его минимальный многочлен будет $f = x^2 +1$.
Таким образом вещественный спектр пуст $\spec_\mathbb R A = \varnothing$, так как $f$ неприводим и не линеен, а значит не имеет корней.
Однако идеальный спектр будет непустым $\spec_\mathbb R^I A = \{x^2 + 1\}$.


\begin{claim}
Пусть $\varphi\colon V\to V$ -- некоторый оператор над произвольным полем $F$ и $f_\text{min}$ -- его минимальный зануляющий многочлен над $F$.
Тогда
\begin{enumerate}
\item Для любого зануляющего многочлена $f$ и любого $p\in \spec_F^I \varphi$ следует, что $p$ делит $f$.

\item $p\in \spec_F^I \varphi$ тогда и только тогда, когда $p$ делит $f_{\text{min}}$.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Для этого достаточно показать, что если $p$ не делит $f$, то $p(\varphi)$ обратим.
Действительно, так как $p$ неприводим, это означает, что $f$ и $p$ взаимно просты.
Тогда по расширенному алгоритму Евклида мы знаем, что $1 = u(t) p(t) + v(t) f(t)$ для некоторых многочленов $u(t), v(t)\in F[t]$.
Тогда подставив в последнее равенство $\varphi$ мы видим 
\[
\Identity = u(\varphi) p(\varphi) + v(\varphi) f(\varphi) = u(\varphi) p(\varphi)
\]
То есть $u(\varphi)$ -- обратный к $p(\varphi)$, что и требовалось.

(2) Пусть теперь $f_\text{min}$ -- минимальный многочлен и пусть $p$ -- неприводимый делитель $f_\text{min}$, то есть $f_\text{min} = p h$.
Надо показать, что $p(\varphi)$ необратим.

Мы знаем, что $0 = f_\text{min}(\varphi) = p(\varphi) h(\varphi)$.
Предположим, что $p(\varphi)$ обратим.
Тогда в равенстве $p(\varphi)h(\varphi) = 0$ можно сократить на $p(\varphi)$.
Значит $h(\varphi) = 0$, что противоречит минимальности $\varphi$.
\end{proof}


\paragraph{Замечания}

\begin{itemize}
\item Пусть $f_{\text{min}}$ раскладывается на линейные множители
\[
f_{\text{min}}(t) = (t - \lambda_1)^{k_1}\ldots(t-\lambda_r)^{k_r}
\]
Тогда идеальный спектр $\varphi$ -- это в точности многочлены $\{t-\lambda_1,\ldots,t-\lambda_r\}$.
То есть каждый элемент идеального спектра однозначно соответствует элементу обычного спектра $\spec_F\varphi = \{\lambda_1,\ldots,\lambda_r\}$.
Потому идеальный спектр можно рассматривать как обобщение понятия спектра на случай, когда в минимальном многочлене есть нелинейные множители.

\item Последнее утверждение можно рассматривать как обобщение утверждений~\ref{claim::PolyAnnihilator} и~\ref{claim::MinPoly} о том, что спектр лежит среди корней зануляющего многочлена и в точности совпадает с корнями минимального.

\item Так как минимальный многочлен делит характеристический, то любой элемент идеального спектра является делителем характеристического многочлена.

На самом деле можно показать, что элементы идеального спектра -- это в точности делители характеристического многочлена.
Но я не буду вас мучить доказательством этого утверждения нашими методами.

Давайте я намекну про правильный способ.
Пусть $\varphi\colon V\to V$ -- некоторый оператор над полем $F$ и пусть $f_\text{min} = p_1^{k_1}\ldots p_r^{k_r}$.
Предположим, что многочлен $\chi_\varphi$ имеет неприводимый делитель $p$ отличный от всех $p_i$.
Пусть $\bar F$ -- алгебраическое замыкание $F$.
Тогда можно заменить оператор $\varphi$ на его версию над $\bar F$, а именно $\varphi_{\bar F}\colon V_{\bar F}\to V_{\bar F}$, у которого будет тот же минимальный и характеристический многочлен.
Например, это можно сделать, выбрав базис в $V$, оно превращается в $F^n$, потом взять $V_{\bar F} = \bar F^n$ и в нем задать $\varphi_{\bar F}$ той же матрицей, что и $\varphi$.
Характеристический многочлен не изменится, потому что матрица та же самая, но надо пояснить, почему минимальный многочлен не изменится.
В этом случае есть общая конструкция для $V_{\bar F}$, которая определяется так, что неизменность минимального многочлена будет очевидна (можно и руками показать, выбрав базис $\bar F$ как векторного пространства над $F$).
После чего мы видим, что $f_\text{min}$ и $\chi_\varphi$ имеют одни и те же корни в $\bar F$, то есть $p$ имеет общий корень с каким-то $p_i$.
Но это не возможно.
Действительно, в силу их взаимной простоты, мы имеем $1 = u(t) p(t) + v(t) p_i(t)$.
И если у них есть общий корень, то после подстановки его в равенсто, справа будет ноль, а слева -- единица.
На этом победа.%
\footnote{В курсе алгебры вам расскажут как для любого поля $F$ и любого многочлена $g\in F[t]$ построить большее поле $L\supseteq F$ такое, что в нем $g$ раскладывается на линейные множители.
Как мы видим из доказательства, этого нам достаточно.
Остается аккуратно объяснить, почему не изменится минимальный многочлен и вы будете готовы доказать этот факт.}
\end{itemize}

\begin{claim}
[БД]
Пусть $\varphi\colon V\to V$ -- некоторый оператор над произвольным полем $F$.
Тогда $p\in \spec_F^I \varphi$ тогда и только тогда, когда $p$ делит $\chi_\varphi$.
\end{claim}


\subsection{Обобщение собственных и корневых подпространств}

\begin{definition}
Пусть $\varphi\colon V\to V$ -- линейный оператор над произвольным полем и $p\in \spec_F^I \varphi$.
Тогда определим корневое подпространство как:
\[
V^p = \{v\in V\mid \exists k\colon p^k(\varphi) v = 0\} = \bigcup_{k\geqslant 0}\ker p^k(\varphi)
\]
и собственное подпространство
\[
V_p =\{v\in V \mid p(\varphi)v = 0\} = \ker p(\varphi)
\]
\end{definition}

\paragraph{Замечания}

\begin{itemize}
\item В силу леммы о стабилизации $V^p = \ker p^k(\varphi)$ для некоторого достаточно большого $k\leqslant \dim_F V$.

\item Это определение является обобщением корневого и собственного подпространства на случай идеального спектра.
Действительно, если $\lambda\in\spec_F \varphi$, то в идеальном спектре ему соответствует $p(t) = t - \lambda$.
Тогда определения превращаются в те же самые, что были даны в предыдущих разделах.
\end{itemize}