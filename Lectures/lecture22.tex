\ProvidesFile{lecture22.tex}[Лекция 22]


\subsection{Классификация для оператора}

Теперь мы можем решить вопрос, когда же две разные матрицы задают один и тот же оператор в разных базисах.
Однако, нам потребуется техническое условие.
Отвечать на этот вопрос мы пока умеем лишь когда характеристические многочлены матриц раскладываются на линейные множители.
Потому мы ответим на этот вопрос лишь над алгебраическим полем.

\begin{claim}
[Классификация дли линейных операторов]
Пусть $F$ -- алгебраически замкнутое поле.
Пусть $A, B \in \operatorname{M}_n(F)$ -- произвольные матрицы.
Тогда следующее эквивалентно:
\begin{enumerate}
\item Найдется векторное пространство $V$, линейный оператор $\varphi\colon V\to V$ и два базиса $e_1,\ldots,e_n$ и $f_1,\ldots,f_n$ в $V$ такие, что матрица $\varphi$ в базисе $e_1,\ldots,e_n$ есть $A$, а в базисе $f_1,\ldots,f_n$ есть $B$.

\item Матрицы $A$ и $B$ сопряжены, то есть найдется невырожденная матрица $C\in \operatorname{M}_n(F)$ такая, что $B = C^{-1} A C$.

\item Матрицы $A$ и $B$ имеют одинаковую жорданову нормальную форму.

\item Для матриц $A$ и $B$ выполнено:
\begin{enumerate}
\item Их характеристические многочлены равны между собой: $\chi_A(t) = \chi_B(t)$.

\item Для любого корня $\lambda$ характеристического многочлена и любого числа $k$ не превосходящего кратности $\lambda$ выполнено $\rk (A - \lambda E)^k = \rk (B - \lambda E)^k$.%
\footnote{На самом деле из доказательства можно углядеть, что достаточно потребовать это равенство для всех $k$ не превосходящих половину кратности корня.}
\end{enumerate}
\end{enumerate}
\end{claim}
\begin{proof}
Обратим внимание, что (1)$\Leftrightarrow$(2) делается так же, как и в случае линейных отображений (утверждение~\ref{claim::HomClassification}).
Напомню кратко:
(1)$\Rightarrow$(2) следует из общей формулы замены матрицы при переходе от одного базиса к другому.
(2)$\Rightarrow$(1).
Пусть $B = C^{-1}AC$.
Тогда положим $V = F^n$ и зададим $\varphi(x) = Ax$.
В качестве $e=(e_1,\ldots,e_n)$ возьмем стандартный базис, в качестве $f = (e_1,\ldots,e_n)C$.
Тогда по правилам замены в базисе $f$ оператор $\varphi$ задан матрицей $C^{-1}AC$, что по условию есть $B$, что и требовалось.

(1)$\Rightarrow$(4) Так как $A$ и $B$ матрицы одно и того же оператора в разных базисах, то их характеристические многочлены равны (утверждение о корректности характеристического многочлена).
Для любого корня $\lambda$ характеристического многочлена и произвольного натурального $k$ имеем $\rk (A - \lambda E)^k = \dim \Im(\varphi - \lambda \Identity)^k = \rk (B - \lambda E)^k$.

(4)$\Rightarrow$(3) Из совпадению $\chi_A = \chi_B$ следует, что ЖНФ для $A$ и $B$ имеют одни и те же $\lambda_i$ на диагонали.
Теперь надо показать, что количество клеток фиксированного размера для $\lambda_i$ и у $A$ и у $B$ будет одинаковым.
По формуле, клеток с числом $\lambda$ размера $r$ в $A$ будет
\[
2\dim \ker (A - \lambda E)^r - \dim \ker (A - \lambda E)^{r+1} - \dim \ker (A - \lambda E)^{r-1}
\]
Но 
\[
\dim \ker (A - \lambda E)^r = n - \rk (A - \lambda E)^r = n - \rk(B - \lambda E)^r = \dim \ker (B - \lambda E)^r
\]	
То есть для $A$ и $B$ эти количества совпадают.

(3)$\Rightarrow$(2) Пусть у матриц $A$ и $B$ одинаковая жорданова нормальная форма $J$.
Тогда $A = C^{-1} J C$ и $B = D^{-1} J D$.
Следовательно $B = D^{-1}C A C^{-1}D$.
\end{proof}

\newpage
\section{Функционалы}

Этот раздел посвящен специальному случаю векторного пространства состоящего из линейных функций на фиксированном пространстве.

\subsection{Двойственное (сопряженное) пространство}

\begin{definition}
Пусть $V$ -- векторное пространство над полем $F$, тогда двойственным (или сопряженным) пространством к нему называется 
\[
V^* = \Hom_F(V,F) = \{\xi\colon V\to F\mid \xi \text{ -- линейное над }F\}
\]
Элементы $V^*$ называются линейными функционалами или линейными функциями.
\end{definition}

\paragraph{Замечания}

\begin{itemize}
\item Таким образом двойственное пространство к $V$ состоит из линейных функций на $V$.

\item Вспомним, что в разделе~\ref{section::HomOperations} было показано, что $V^*$ обладает структурой векторного пространства.
Напомним явно эту структуру.

Если $\xi,\eta\in V^*$ -- два функционала, то нам надо определить их сумму $\xi + \eta\in V^*$.
То есть нам надо определить отображение $(\xi + \eta)\colon V\to F$, которое должно быть $F$-линейным.
Определим его так: $(\xi + \eta)(v) = \xi(v) + \eta(v)$.
Если $\xi \in V^*$ и $\lambda\in F$, то нам надо определить $\lambda \xi \in V^*$.
То есть нам надо определить отображение $(\lambda \xi)\colon V\to F$, которое должно быть $F$-линейным.
Сделаем это так: $(\lambda\xi)(v) = \lambda\xi(v)$.
Элементарные проверки показывают, что эти операции снабжают $V^*$ структурой векторного пространства над $F$ (то есть удовлетворяют всем нужным аксиомам).

\item {\bf Удобный формализм} Если $\xi \in V^*$, а $v\in V$, то применение функционала к вектору $\xi(v)$ можно записать более кратко без скобок $\xi v$ рассматривая операцию применения функционала, как операцию умножения $V^*\times V\to F$ по правилу $(\xi, v)\mapsto \xi v = \xi(v)$.
Это очень удобно и унифицирует многие обозначения.
Например можно использовать с блочными формулами, в виде
\[
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_m}
\end{pmatrix}
\begin{pmatrix}
{v_1}&{\ldots}&{v_n}\\
\end{pmatrix}
=
\begin{pmatrix}
{\xi_1 v_1}&{\ldots}&{\xi_1 v_n}\\
{\vdots}&{\ddots}&{\vdots}\\
{\xi_m v_1}&{\ldots}&{\xi_m v_n}\\
\end{pmatrix}
\]
Здесь я умножаю столбец из функционалов на строку из векторов и получаю матрицу из чисел.
\end{itemize}

\paragraph{Примеры}

\begin{enumerate}
\item Пусть $V = F^n$ -- пространство столбцов.
Если $y\in F^n$ -- некоторый столбец, то положим $\alpha_y \colon V\to F$ по правилу $\alpha_y(x) = y^t x$.
Ниже мы покажем, что в конечномерном пространстве так выглядят все функционалы.

\item Пусть $F(X, \mathbb R) = \{f\colon X\to \mathbb R\}$ -- множество всех функций на множестве $X$ со значениями в поле $\mathbb R$.
Тогда это множество является векторным пространством над полем $\mathbb R$.
Тогда каждая точка $x\in X$ задает функционал <<вычисления в точке>> $\alpha_x \colon F(X,\mathbb R)\to \mathbb R$ по правилу $f\mapsto f(x)$.

\item Пусть $C[a,b]$ -- множество непрерывных функций на отрезке $[a,b]$.
Тогда отображение $\int \colon C[a,b]\to \mathbb R$ по правилу $f \mapsto \int_a^b f(t)\,dt$ является линейным функционалом.

\item Пусть $V = \operatorname{M}_n(F)$ -- квадратные матрицы, тогда отображение $\tr\colon \operatorname{M}_n(F)\to F$ по правилу $A\mapsto \tr A$ является линейным функционалом.
\end{enumerate}

\subsection{Двойственный базис и координаты}

\begin{claim}
\label{claim:DualBasis}
Пусть $V$ -- векторное пространство над полем $F$ и $e_1,\ldots,e_n\in V$ -- некоторый базис.
Тогда
\begin{enumerate}
\item Существует единственный набор функционалов $\xi_1,\ldots,\xi_n\in V^*$ такой, что 
\[
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_n}\\
\end{pmatrix}
\begin{pmatrix}
{e_1}&{\ldots}&{e_n}
\end{pmatrix}
=
E
\]

\item В конечномерном пространстве любой набор функционалов со свойством~(1) является базисом $V^*$.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Нам надо найти такие функционалы $\xi_i$, что $\xi_i(e_j) = 1$, если $i = j$ и $ = 0$, если $i\neq j$.
Но по утверждению~\ref{claim::LinMapExist} существует единственная линейная функция $\xi_i$ отправляющая $e_i$ в единицу, а остальные базисные векторы в $0$.

(2) Пусть $\xi \in V^*$ -- произвольный функционал, тогда покажем, что $\xi = \xi(e_1)\xi_1 + \ldots + \xi(e_n)\xi_n$.
Для этого надо показать, что левая и правая часть равенства одинаково действуют на любом векторе из $V$.
Для этого достаточно проверить, что они одинаково действуют на каком-нибудь базисе $V$.
То есть нам достаточно проверить, что левая и правая часть одинаково действуют на каждом $e_i$.
Под действием $\xi$ вектор $e_i$ идет в $\xi(e_i)$.
С другой стороны
\[
(\xi(e_1)\xi_1 + \ldots + \xi(e_n)\xi_n)(e_i) = \xi(e_1)\xi_1(e_i) + \ldots + \xi(e_n)\xi_n(e_i) = \xi(e_i)\xi_i(e_i) = \xi(e_i)
\]
что и требовалось.
\end{proof}

\begin{definition}
\label{def::DualBasis}
Пусть $V$ -- векторное пространство и $e_1,\ldots,e_n\in V$ -- его некоторый базис.
Тогда единственный базис $\xi_1,\ldots,\xi_n\in V^*$, удовлетворяющий условию
\[
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_n}\\
\end{pmatrix}
\begin{pmatrix}
{e_1}&{\ldots}&{e_n}
\end{pmatrix}
=
E
\]
называется двойственным (или сопряженным) к базису $e_1,\ldots,e_n$.
\end{definition}

\paragraph{Замечания}

\begin{itemize}
\item В предыдущем утверждении мы показали, что если пространство $V$ конечно мерно, то и пространство $V^*$ конечно мерно и имеет ту же самую размерность.
Кратко:  $\dim V <\infty$ $\Rightarrow$ $\dim V^* = \dim V$.

\item Можно показать, что если пространство $V$ бесконечно мерно, то пространство $V^*$ всегда имеет строго большую размерность.
Кратко: $\dim V = \infty$ $\Rightarrow$ $\dim V < \dim V^*$.

\item Таким образом можно дать очень дурацкое, но тем не менее корректное определение: векторное пространство $V$ будем называть конечномерным, если $V$ изоморфно $V^*$.
Удачи с доказательствами в этом прекрасном мире чудесных определений!

\item Давайте обсудим рабоче-крестьянский смысл последнего утверждения.
Пусть вам выдали векторное пространство $V$.
Как только вы в нем выбрали базис $e_1,\ldots,e_n$, то оно сразу превратилось в пространство столбцов $F^n$.
Теперь у вас рядом стоит векторное пространство $V^*$, давайте в нем выберем двойственный базис $\xi_1,\ldots,\xi_n$.
Тогда пространство $V^*$ тоже превращается в $F^n$, но давайте его отождествим с пространством строк, а не столбцов.
Тогда, если $\xi \in V^*$ в координатах задается строкой $y\in F^n$, а вектор $v\in V$ в координатах задается столбцом $x\in F^n$, то $\xi(v)$ в координатах считается по правилу $yx$ -- произведение строки на столбец.%
\footnote{Проверьте это.
Именно это свойство является ключевым для двойственного базиса.
Мы согласованно превращаем в строки и столбцы функционалы и векторы, так что вычисление функционала превращается в матричное умножение.}
\end{itemize}

\begin{claim}
\label{claim::DualBasisChange}
Пусть $V$ -- векторное пространство над полем $F$, $e_1,\ldots,e_n$ -- базис $V$, $\xi_1,\ldots,\xi_n$ -- базис $V^*$ двойственный к $e_1,\ldots,e_n$.
Пусть $e_1',\ldots,e_n'$ -- другой базис $V$ и $\xi_1',\ldots,\xi_n'$ -- двойственный ему базис $V^*$.
Тогда если $(e_1',\ldots,e_n') = (e_1,\ldots,e_n)C$, где $C\in \operatorname{M}_n(F)$ -- невырожденная матрица перехода, то $(\xi_1',\ldots,\xi_n') = (\xi_1,\ldots,\xi_n)C^{-t}$.
\end{claim}
\begin{proof}
Так как $\xi_1,\ldots,\xi_n$ и $\xi_1',\ldots,\xi_n'$ -- базисы пространства $V^*$, то обязательно найдется невырожденная матрица перехода между ними, давайте обозначим ее за $D$, то есть
\[
(\xi_1',\ldots,\xi_n') = (\xi_1,\ldots,\xi_n)D
\]
Транспонируем это равенство и получим
\[
\begin{pmatrix}
{\xi_1'}\\{\vdots}\\{\xi_n'}
\end{pmatrix}
=
D^t
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_n}
\end{pmatrix}
\]
Так как $\xi_1',\ldots,\xi_n'$ двойственный к $e_1',\ldots,e_n'$, то по определению это значит
\[
\begin{pmatrix}
{\xi_1'}\\{\vdots}\\{\xi_n'}
\end{pmatrix}
\begin{pmatrix}
{e_1'}&{\ldots}&{e_n'}
\end{pmatrix}
=
E
\]
С другой стороны
\[
\begin{pmatrix}
{\xi_1'}\\{\vdots}\\{\xi_n'}
\end{pmatrix}
\begin{pmatrix}
{e_1'}&{\ldots}&{e_n'}
\end{pmatrix}
=
D^t
\begin{pmatrix}
{\xi_1}\\{\vdots}\\{\xi_n}
\end{pmatrix}
\begin{pmatrix}
{e_1}&{\ldots}&{e_n}
\end{pmatrix}
C
=
D^t C
\]
Откуда $D = C^{-t}$.
\end{proof}

\paragraph{Координаты}

Пусть $V$ -- некоторое векторное пространство над полем $F$ и $V^*$ -- пространство линейных функций на $V$.
Тогда в пространстве $V$ мы можем выбрать базис $e_1,\ldots,e_n$ и двойственный к нему базис $\xi_1,\ldots, \xi_n$ в $V^*$.
Во время доказательства утверждения~\ref{claim:DualBasis} мы на самом деле показали как можно быстро найти координаты любой функции $\xi \in V^*$ в базисе $\xi_1,\ldots, \xi_n$.
Действительно, мы показали, что
\[
\xi = \xi(e_1) \xi_1 + \ldots + \xi(e_n) \xi_n
\]
то есть для вычисления координат в базисе $\xi_1,\ldots, \xi_n$ надо функцию $\xi$ вычислить на двойственном базисе $e_1,\ldots, e_n$.
Возникает вопрос, а можно ли точно так же быстро вычислять координаты $v\in V$ в базисе $e_1,\ldots, e_n$ используя $\xi_1,\ldots, \xi_n$.
Оказывается, что можно и ответ следующий: для любого вектора $v\in V$ выполнено
\[
v = \xi_1(v) e_1 + \ldots + \xi_n(v) e_n
\]
то есть функция $\xi_i$ -- это в точности функция вычисления $i$-ой координаты.
Чтобы доказать это разложение нам понадобится следующее вспомогательное утверждение.

\begin{claim}
\label{claim::VecPointwiseEq}
Пусть $V$ -- векторное пространство над полем $F$, тогда
\begin{enumerate}
\item Для любого ненулевого вектора $v\in V$ найдется функция $\xi \in V^*$ такая, что $\xi (v) = 1$.

\item Если $v\in V$, то $v = 0$ тогда и только тогда, когда для любой функции $\xi \in V^*$, $\xi(v) = 0$.

\item Если $v, u\in V$, то $v = u$ тогда и только тогда, когда для любой функции $\xi \in V^*$, $\xi(v) = \xi(u)$.
\end{enumerate}
\end{claim}
\begin{proof}
(1)$\Rightarrow$(2).
Предположим противное, что найдется ненулевой вектор $v\in V$ такой, что $\xi(v) = 0$ для любой $\xi\in V^*$, но тогда это противоречит (1).

(2)$\Rightarrow$(3).
Действительно, условие $v = u$ эквивалентно условию $v - u = 0$.
Тогда по (2) это эквивалентно условию $\xi(v - u) = 0$ для любой функции $\xi \in V^*$.
В силу линейности всех $\xi$, последнее равносильно
$\xi(v) = \xi(u)$, что и требовалось.

Теперь докажем (1).
Рассмотрим произвольный ненулевой вектор $v\in V$.
Раз он ненулевой, то он линейно независим и значит дополняется до базиса $v, e_2,\ldots, e_n$.%
\footnote{На самом деле даже в бесконечно мерном пространстве мы можем дополнить любую линейно независимую систему векторов до базиса.
А потому приведенное тут доказательство работает и в общем случае.
Однако, бесконечномерный случай все же требует использование аксиомы выбора или любой другой эквивалентной ей аксиомы.}
Но тогда мы можем отправить $v \mapsto 1$ и все остальные $e_i \mapsto 0$ и найдется единственное линейное отображение $\xi \colon V\to F$ с таким свойством.%
\footnote{В конечномерном случае это утверждение~\ref{claim::LinMapExist} .
Для бесконечномерного случая можете проверить, что оно остается верным.}
Вот мы и предъявили требуемое отображение $\xi$.
\end{proof}

Теперь покажем выполнение разложения
\[
v = \xi_1(v) e_1 + \ldots + \xi_n(v) e_n
\]
для любого вектора из $V$.
По предыдущему утверждению достаточно выбрать произвольную линейную функцию $\xi\in V^*$ и проверить, что
\[
\xi(v) = \xi(\xi_1(v) e_1 + \ldots + \xi_n(v) e_n)
\]
Но так как $\xi_1,\ldots,\xi_n$ -- базис $V^*$ ясно, что достаточно вместо $\xi$ брать только базисные $\xi_i$.
Давайте проверим для $\xi_i$:
\[
\xi_i(\xi_1(v) e_1 + \ldots + \xi_n(v) e_n) =\xi_1(v) \xi_i( e_1) + \ldots + \xi_n(v) \xi_i(e_n) = \xi_i(v) \xi_i(e_i) = \xi_i(v)
\]
что и требовалось.

Обратите внимание, что если вектор $v\in V$ в базисе $e_1,\ldots, e_n$ имеет координаты $x = (x_1,\ldots, x_n)$, то $x_i = \xi_i(v)$.
Но мы знаем как меняются координаты при смене базиса.
Давайте посмотрим, что из этого получается для функций $\xi_i$.
Пусть есть еще один базис $e_1',\ldots, e_n'$ в $V$, в $V^*$ для него выбран двойственный базис $\xi_1',\ldots, \xi_n'$, и координаты вектора $v$ в новом базисе будут $(x_1',\ldots, x_n')$.
Предположим что базисы пространства $V$ связаны следующим образом: $(e_1',\ldots, e_n') = (e_1,\ldots, e_n) C$.
В этом случае мы знаем, что на координатах связь будет следующая
\[
\begin{pmatrix}
{x_1}\\{\vdots}\\{x_n}
\end{pmatrix}
=
C
\begin{pmatrix}
{x_1'}\\{\vdots}\\{x_n'}
\end{pmatrix}
\]
Но теперь вспомним, что $x_i = \xi_i(v)$ и $x_i' = \xi_i'(v)$, получим
\[
\begin{pmatrix}
{\xi_1(v)}\\{\vdots}\\{\xi_n(v)}
\end{pmatrix}
=
C
\begin{pmatrix}
{\xi_1'(v)}\\{\vdots}\\{\xi_n'(v)}
\end{pmatrix}
\]
Давайте транспонируем это равенство
\[
\begin{pmatrix}
{\xi_1(v)}&{\ldots}&{\xi_n(v)}
\end{pmatrix}
=
\begin{pmatrix}
{\xi_1'(v)}&{\ldots}&{\xi_n'(v)}
\end{pmatrix}
C^t
\]
А теперь умножим справа на $C^{-t}$ и получим уже известное правило для смены двойственного базиса из утверждения~\ref{claim::DualBasisChange}
\[
\begin{pmatrix}
{\xi_1'(v)}&{\ldots}&{\xi_n'(v)}
\end{pmatrix}
=
\begin{pmatrix}
{\xi_1(v)}&{\ldots}&{\xi_n(v)}
\end{pmatrix}
C^{-t}
\]
