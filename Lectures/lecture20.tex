\ProvidesFile{lecture20.tex}[Лекция 20]


\subsection{Теорема о жордановой нормальной форме}

\begin{claim}
[Теорема о жордановой нормальной форме]
\label{claim::JNF}
Пусть $\varphi\colon V\to V$ -- линейный оператор такой, что его характеристический (или минимальный) многочлен раскладывается на линейные множители
\[
\chi_\varphi(t) = (t - \lambda_1)^{n_1} \ldots (t - \lambda_r)^{n_r}
\]
Тогда
\begin{enumerate}
\item Для оператора $\varphi$ существует жорданов базис, то есть в некотором базисе матрица $\varphi$ имеет вид
\[
A_\varphi = 
\begin{pmatrix}
{J_{k_1}(\lambda_{i_1})}&{}&{}&{}\\
{}&{J_{k_2}(\lambda_{i_2})}&{}&{}\\
{}&{}&{}&{}\\
{}&{}&{}&{J_{k_s}(\lambda_{i_s})}\\
\end{pmatrix}
\]

\item В любом жордановом базисе количество клеток размера $m$ с фиксированным числом $\lambda$ на диагонали одинаковое и равно
\[
2\dim \ker (\varphi - \lambda\Identity)^m - \dim \ker (\varphi - \lambda\Identity)^{m+1} - \dim \ker (\varphi - \lambda\Identity)^{m-1}
\]
А значит жордановы формы в разных базисах могут отличаться лишь перестановкой клеток.
\end{enumerate}
\end{claim}
\begin{proof}
(1) Так как $\chi_\varphi(t)$ (или минимальный многочлен) раскладывается на линейные множители, утверждение~\ref{claim::RootSpaceDec} говорит, что $V = V^{\lambda_1}\oplus \ldots\oplus V^{\lambda_r}$.
Тогда, если мы выберем базисы в подпространствах $V^{\lambda_i}$ объединим (они обязательно дадут базис $V$) и запишем в этом базисе матрицу $\varphi$, она будет иметь блочно диагональный вид
\[
A_\varphi = 
\begin{pmatrix}
{A_1}&{}&{}&{}\\
{}&{A_2}&{}&{}\\
{}&{}&{\ddots}&{}\\
{}&{}&{}&{A_r}\\
\end{pmatrix}
\]
где $A_i$ -- матрица $\varphi|_{V^{\lambda_i}}$.
То есть, чтобы доказать теорему, нам надо в каждом $V^{\lambda_i}$ выбрать жорданов базис для оператора $\varphi|_{V^{\lambda_i}}$.
Теперь заметим, что базис является жордановым для некоторого оператора $\phi$ тогда и только тогда, когда он является жордановым для оператора $\phi - \lambda \Identity$ (при любом выборе $\lambda$).
Потому нам надо в каждом $V^{\lambda_i}$ выбрать жорданов базис для оператора $\phi_i := \varphi|_{V^{\lambda_i}} - \lambda_i \Identity$.
Но оператор $\phi_i$ является нильпотентным и для него это следует из утверждения~\ref{claim::NilJNF}.

(2) Пусть теперь у нас выбран какой-нибудь жорданов базис, в котором матрица $\varphi$ имеет вид
\[
A_\varphi = 
\begin{pmatrix}
{A_1}&{}&{}&{}\\
{}&{A_2}&{}&{}\\
{}&{}&{\ddots}&{}\\
{}&{}&{}&{A_r}\\
\end{pmatrix},
\quad\text{где}\quad
A_i = 
\begin{pmatrix}
{J_{k_{1\,i}}(\lambda_i)}&{}&{}&{}\\
{}&{J_{k_{2\,i}}(\lambda_i)}&{}&{}\\
{}&{}&{}&{}\\
{}&{}&{}&{J_{k_{m_i\,i}}(\lambda_i)}\\
\end{pmatrix}
\]
Во-первых, числа $\lambda_i$ на диагоналях клеток будут обязательно числами из спектра, просто потому что $A_\varphi$ верхнетреугольная с этими числами на диагонали.

Во-вторых, нам надо показать, что все $A_i$ (где $A_i$ -- это блоки в которых мы сгруппировали клетки с одним и тем же числом $\lambda_i$ на диагонали) имеют одинаковый размер.
Но по определению размер этих блоков -- это кратность $\lambda_i$ в $\chi_\varphi(t)$ или что то же самое -- размерность $V^{\lambda_i}$.
А сам блок $A_i$ оказывается матрицей оператора $\varphi|_{V^{\lambda_i}}$.

В-третьих, надо показать, что внутри каждого $A_i$ количество блоков фиксированного размера одинаковое  и задано формулой 
\[
2\dim \ker (\varphi - \lambda_i\Identity)^m - \dim \ker (\varphi - \lambda_i\Identity)^{m+1} - \dim \ker (\varphi - \lambda_i\Identity)^{m-1}
\]
Но так как $A_i$ -- это матрица оператора $\varphi|_{V^{\lambda_i}}$, а оператор $\varphi|_{V^{\lambda_i}} - \lambda_i \Identity$ нильпотентен и имеет те же размеры блоков, то из пункта~(2) утверждения~\ref{claim::NilJNF} следует, что нужное количество клеток задано формулой
\[
2\dim \ker (\varphi|_{V^{\lambda_i}} - \lambda_i\Identity)^m - \dim \ker (\varphi|_{V^{\lambda_i}} - \lambda_i\Identity)^{m+1} - \dim \ker (\varphi|_{V^{\lambda_i}} - \lambda_i\Identity)^{m-1}
\]
Теперь осталось показать, что 
\[
\ker (\varphi - \lambda_i\Identity)^m = \ker (\varphi|_{V^{\lambda_i}} - \lambda_i\Identity)^m
\]
Если вспомнить определение оператора ограничения мы видим, что
\[
\ker (\varphi|_{V^{\lambda_i}} - \lambda_i\Identity)^m = V^{\lambda_i}\cap \ker (\varphi - \lambda_i\Identity)^m
\]
С другой стороны, $\ker (\varphi - \lambda_i\Identity)^m$ является подпространством $V^{\lambda_i}$ по определению, что и доказывает нужное равенство.
\end{proof}


Обратите внимание, что жорданова форма для оператора единственная с точностью до перестановки блоков.
Однако, жордановых базисов может быть много!
Например, если $\varphi = \lambda \Identity$, то любой базис является жордановым, так как в любом базисе матрица оператора будет диагональной с числом $\lambda$ на диагонали.


\paragraph{Замечания}

Давайте обсудим некоторые характеристики жордановых клеток в терминах исходного оператора.
\begin{itemize}
\item Число $\dim V^{\lambda_i}$ является суммарным размером всех клеток с заданным $\lambda_i$, то есть клеток вида $J_s(\lambda_i)$.
Действительно, по построению, блок из таких клеток возникает как матрица $\varphi|_{V^{\lambda_i}}$.
А размер матрицы оператора равен размерности пространства, на котором определен оператор.%
\footnote{Можно объяснить по-другому из явного вычисления с матрицей жордановой нормальной формы аналогично следующему пункту.}

\item Число $\dim V_{\lambda_i}$ является количеством жордановых клеток с фиксированным $\lambda_i$, то есть клеток вида $J_s(\lambda_i)$.
Действительно, по определению $V_{\lambda_i} = \ker (\varphi - \lambda_i \Identity)$.
Теперь надо посчитать правую часть равенства в жордановой форме и увидеть, что его размерность равна суммарному размеру клеток с числом $\lambda_i$.
Пусть $A$ имеет жорданову форму как в предыдущем утверждении, тогда
\[
A -\lambda_i E= 
\begin{pmatrix}
{A_1-\lambda_i E}&{}&{}\\
{}&{\ddots}&{}\\
{}&{}&{A_r - \lambda_i E}
\end{pmatrix},\text{ где }
A_k -\lambda_i E=
\begin{pmatrix}
{J_*(\lambda_k - \lambda_i)}&{}&{}\\
{}&{\ddots}&{}\\
{}&{}&{J_*(\lambda_k - \lambda_i)}
\end{pmatrix}
\]
То есть для $k\neq i$ все блоки будут верхнетреугольными с ненулевым числом на диагонали, а значит обратимыми, а для $k = i$ блок будет вида
\[
A_i -\lambda_i E=
\begin{pmatrix}
{J_*(0)}&{}&{}\\
{}&{\ddots}&{}\\
{}&{}&{J_*(0)}
\end{pmatrix}
\]
Пусть $A$ размера $n$, а $n_k$ -- размер блока $A_k$.
Тогда размерность $\ker (A - \lambda_i E)$ равна $n - \rk (A - \lambda_i E)$.
Но $\rk (A - \lambda_i E) = \sum_k \rk (A_k - \lambda_i E)$ и $n = \sum_k n_k$.
Так как все матрицы $A_k - \lambda_i E$ для $k\neq i$ обратимы, то есть имеют полный ранг, то $n - \rk (A-\lambda_i E)$ равно $n_i - \rk (A_i - \lambda_iE)$.
Каждый блок $J_s(0)$ имеет ранг $s-1$.
То есть каждая клетка вносит в ранг вклад на единицу меньше размера.
Следовательно $\rk(A_i -\lambda_i E)$ равно $n$ минус количество клеток, победа!

\item Кратность $\lambda_i$ в $f_\text{min}$ равна размерности самого большого блока вида $J_s(\lambda_i)$.
Давайте посчитаем кратность корня $\lambda_i$ в $f_\text{min}$ для $A$ в жордановой форме.
Для этого надо найти $m$ для которого наступит $\ker (A - \lambda_i E)^m = \ker(A-\lambda_i E)^{m+1}$ (утверждение~\ref{claim::RootMultGeom}).
Как и выше, блоки $A_k - \lambda_i E$ не дают вклад в ядро.
А блок $A_i - \lambda_i E$ зануляется в степени равной максимальному размеру клетки.
То есть это ровна степень стабилизации, что и требовалось.

\item Мы уже доказали, что количество клеток размера $r$ с числом $\lambda$ вычисляется по формуле
\[
2\dim \ker (\varphi - \lambda\Identity)^r - \dim \ker (\varphi - \lambda\Identity)^{r+1} - \dim \ker (\varphi - \lambda\Identity)^{r-1}
\]
Однако, можно дать совершенно другое доказательство этого факта, которое может оказаться для вас более приятным или более понятным.
Вместо всех этих дурацких рассуждений с операторами, которые были приведены во второй части предыдущего утверждения, можно поступить вот как.
Пусть мы уже привели матрицу в ЖНФ в каком-то базисе (но пока еще не знаем ее единственности).
\[
A_\varphi = 
\begin{pmatrix}
{A_1}&{}&{}&{}\\
{}&{A_2}&{}&{}\\
{}&{}&{\ddots}&{}\\
{}&{}&{}&{A_r}\\
\end{pmatrix},
\quad\text{где}\quad
A_i = 
\begin{pmatrix}
{J_{k_{1\,i}}(\lambda_i)}&{}&{}&{}\\
{}&{J_{k_{2\,i}}(\lambda_i)}&{}&{}\\
{}&{}&{}&{}\\
{}&{}&{}&{J_{k_{m_i\,i}}(\lambda_i)}\\
\end{pmatrix}
\]
А давайте для данной ЖНФ просто посчитаем число 
\[
2\dim \ker (\varphi - \lambda\Identity)^r - \dim \ker (\varphi - \lambda\Identity)^{r+1} - \dim \ker (\varphi - \lambda\Identity)^{r-1}
\]
То есть мы будем считать
\[
2\dim \ker (A_\varphi - \lambda E)^r - \dim \ker (A_\varphi - \lambda E)^{r+1} - \dim \ker (A_\varphi - \lambda E)^{r-1}
\]
Проделаем это аналогично тому, как в одном из замечаний выше и увидим, что это число дает количество клеток размера $r$ для данной ЖНФ.%
\footnote{Попробуйте довести это рассуждение до конца, это очень полезно и просто.}
Но с другой стороны, это число не зависит от ЖНФ, значит для любой ЖНФ число клеток считается по этой формуле.
\end{itemize}


\subsection{Классификация для оператора}

Теперь мы можем решить вопрос, когда же две разные матрицы задают один и тот же оператор в разных базисах.
Однако, нам потребуется техническое условие.
Отвечать на этот вопрос мы пока умеем лишь когда характеристические многочлены матриц раскладываются на линейные множители.
Потому мы ответим на этот вопрос лишь над алгебраическим полем.

\begin{claim}
[Классификация дли линейных операторов]
Пусть $F$ -- алгебраически замкнутое поле.
Пусть $A, B \in \operatorname{M}_n(F)$ -- произвольные матрицы.
Тогда следующее эквивалентно:
\begin{enumerate}
\item Найдется векторное пространство $V$, линейный оператор $\varphi\colon V\to V$ и два базиса $e_1,\ldots,e_n$ и $f_1,\ldots,f_n$ в $V$ такие, что матрица $\varphi$ в базисе $e_1,\ldots,e_n$ есть $A$, а в базисе $f_1,\ldots,f_n$ есть $B$.

\item Матрицы $A$ и $B$ сопряжены, то есть найдется невырожденная матрица $C\in \operatorname{M}_n(F)$ такая, что $B = C^{-1} A C$.

\item Матрицы $A$ и $B$ имеют одинаковую жорданову нормальную форму.

\item Для матриц $A$ и $B$ выполнено:
\begin{enumerate}
\item Их характеристические многочлены равны между собой: $\chi_A(t) = \chi_B(t)$.

\item Для любого корня $\lambda$ характеристического многочлена и любого числа $k$ не превосходящего кратности $\lambda$ выполнено $\rk (A - \lambda E)^k = \rk (B - \lambda E)^k$.
\end{enumerate}
\end{enumerate}
\end{claim}
\begin{proof}
Обратим внимание, что (1)$\Leftrightarrow$(2) делается так же, как и в случае линейных отображений (утверждение~\ref{claim::HomClassification}).
Напомню кратко:
(1)$\Rightarrow$(2) следует из общей формулы замены матрицы при переходе от одного базиса к другому.
(2)$\Rightarrow$(1).
Пусть $B = C^{-1}AC$.
Тогда положим $V = F^n$ и зададим $\varphi(x) = Ax$.
В качестве $e=(e_1,\ldots,e_n)$ возьмем стандартный базис, в качестве $f = (e_1,\ldots,e_n)C$.
Тогда по правилам замены в базисе $f$ оператор $\varphi$ задан матрицей $C^{-1}AC$, что по условию есть $B$, что и требовалось.

(1)$\Rightarrow$(4) Так как $A$ и $B$ матрицы одно и того же оператора в разных базисах, то их характеристические многочлены равны (утверждение о корректности характеристического многочлена).
Для любого корня $\lambda$ характеристического многочлена и произвольного натурального $k$ имеем $\rk (A - \lambda E)^k = \dim \Im(\varphi - \lambda \Identity)^k = \rk (B - \lambda E)^k$.

(4)$\Rightarrow$(3) Из совпадению $\chi_A = \chi_B$ следует, что ЖНФ для $A$ и $B$ имеют одни и те же $\lambda_i$ на диагонали.
Теперь надо показать, что количество клеток фиксированного размера для $\lambda_i$ и у $A$ и у $B$ будет одинаковым.
По формуле, клеток с числом $\lambda$ размера $r$ в $A$ будет
\[
2\dim \ker (A - \lambda E)^r - \dim \ker (A - \lambda E)^{r+1} - \dim \ker (A - \lambda E)^{r-1}
\]
Но 
\[
\dim \ker (A - \lambda E)^r = n - \rk (A - \lambda E)^r = n - \rk(B - \lambda E)^r = \dim \ker (B - \lambda E)^r
\]	
То есть для $A$ и $B$ эти количества совпадают.

(3)$\Rightarrow$(2) Пусть у матриц $A$ и $B$ одинаковая жорданова нормальная форма $J$.
Тогда $A = C^{-1} J C$ и $B = D^{-1} J D$.
Следовательно $B = D^{-1}C A C^{-1}D$.
\end{proof}
